<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Neo4J 导入脚本</title>
      <link href="/2022/07/18/LoadCSV/"/>
      <url>/2022/07/18/LoadCSV/</url>
      
        <content type="html"><![CDATA[<h3 id="规范标准及CCS分类"><a href="#规范标准及CCS分类" class="headerlink" title="规范标准及CCS分类"></a>规范标准及CCS分类</h3><h4 id="导入StradardDoc节点"><a href="#导入StradardDoc节点" class="headerlink" title="导入StradardDoc节点"></a>导入StradardDoc节点</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///NewStandardDocument.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入StradardDoc节点-（水利部分）"><a href="#导入StradardDoc节点-（水利部分）" class="headerlink" title="导入StradardDoc节点 （水利部分）"></a>导入StradardDoc节点 （水利部分）</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///StandardDocument_shuili.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入CCS下的节点及层级关系"><a href="#导入CCS下的节点及层级关系" class="headerlink" title="导入CCS下的节点及层级关系"></a>导入CCS下的节点及层级关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS <span class="token keyword">FROM</span> <span class="token string">"file:///CCS_All.csv"</span> <span class="token keyword">AS</span> <span class="token keyword">row</span>  <span class="token keyword">merge</span> <span class="token punctuation">(</span>f:CCS&#123;CCS_Code:<span class="token keyword">row</span><span class="token punctuation">.</span>from_CCS_Code<span class="token punctuation">,</span>CCS_Name:<span class="token keyword">row</span><span class="token punctuation">.</span>from_CCS_Name<span class="token punctuation">,</span>CCSType:<span class="token keyword">row</span><span class="token punctuation">.</span>from_CCSType&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span><span class="token keyword">to</span>:CCS&#123;CCS_Code:<span class="token keyword">row</span><span class="token punctuation">.</span>to_CCS_Code<span class="token punctuation">,</span>CCS_Name:<span class="token keyword">row</span><span class="token punctuation">.</span>to_CCS_Name<span class="token punctuation">,</span>CCSType:<span class="token keyword">row</span><span class="token punctuation">.</span>to_CCSType&#125;<span class="token punctuation">)</span><span class="token keyword">with</span> f<span class="token punctuation">,</span><span class="token keyword">to</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ff:CCS&#123;CCS_Code:f<span class="token punctuation">.</span>CCS_Code<span class="token punctuation">,</span>CCS_Name:f<span class="token punctuation">.</span>CCS_Name<span class="token punctuation">,</span>CCSType:f<span class="token punctuation">.</span>CCSType&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>tt:CCS&#123;CCS_Code:<span class="token keyword">to</span><span class="token punctuation">.</span>CCS_Code<span class="token punctuation">,</span>CCS_Name:<span class="token keyword">to</span><span class="token punctuation">.</span>CCS_Name<span class="token punctuation">,</span>CCSType:<span class="token keyword">to</span><span class="token punctuation">.</span>CCSType&#125;<span class="token punctuation">)</span>  <span class="token keyword">merge</span> <span class="token punctuation">(</span>ff<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:Contained<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据hasGBW-CCS-属性值-多个用-分隔-，创建StandardizingDocument-和-CCS-节点关系"><a href="#根据hasGBW-CCS-属性值-多个用-分隔-，创建StandardizingDocument-和-CCS-节点关系" class="headerlink" title="根据hasGBW_CCS 属性值(多个用|分隔)，创建StandardizingDocument 和 CCS 节点关系"></a>根据hasGBW_CCS 属性值(多个用|分隔)，创建StandardizingDocument 和 CCS 节点关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">with</span> s<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>hasGBW_CCS<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> ccsListunwind ccsList <span class="token keyword">as</span> ccsT<span class="token keyword">with</span> s<span class="token punctuation">,</span> ccsT<span class="token keyword">match</span> <span class="token punctuation">(</span>ccs:CCS<span class="token punctuation">)</span> <span class="token keyword">where</span> ccs<span class="token punctuation">.</span>CCS_Code<span class="token operator">=</span>ccsT<span class="token keyword">merge</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>中文分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ccs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="创建索引-采用官方自带中文分词器"><a href="#创建索引-采用官方自带中文分词器" class="headerlink" title="创建索引,采用官方自带中文分词器"></a>创建索引,采用官方自带中文分词器</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CALL</span> db<span class="token punctuation">.</span><span class="token keyword">index</span><span class="token punctuation">.</span>fulltext<span class="token punctuation">.</span>createNodeIndex<span class="token punctuation">(</span><span class="token string">"sd_hasNoAndnameCN"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"StandardizingDocument"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"hasNO"</span><span class="token punctuation">,</span> <span class="token string">"nameCN"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>&#123;analyzer: <span class="token string">"cjk"</span>&#125;<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="材料库"><a href="#材料库" class="headerlink" title="材料库"></a>材料库</h3><h4 id="导入材料库数据"><a href="#导入材料库数据" class="headerlink" title="导入材料库数据"></a>导入材料库数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Materials.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Material &#123;uuid: <span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>dataType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>dataType<span class="token punctuation">,</span>m<span class="token punctuation">.</span>typeUuid<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>cName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>clauseExplain<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>standardNos<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>picIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>videoIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入图片视频节点数据"><a href="#导入图片视频节点数据" class="headerlink" title="导入图片视频节点数据"></a>导入图片视频节点数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///MediaFiles.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:MediaFile&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>filePath<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span>f<span class="token punctuation">.</span>mediaType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>mediaType<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据材料库picIds和videoIds-多个用-分隔-，与媒体文件库建立关系"><a href="#根据材料库picIds和videoIds-多个用-分隔-，与媒体文件库建立关系" class="headerlink" title="根据材料库picIds和videoIds(多个用|分隔)，与媒体文件库建立关系"></a>根据材料库picIds和videoIds(多个用|分隔)，与媒体文件库建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Material<span class="token punctuation">)</span><span class="token keyword">with</span> m<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>picIds<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span><span class="token operator">+</span>split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>videoIds<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> mediaListunwind mediaList <span class="token keyword">as</span> mediaid<span class="token keyword">with</span> m<span class="token punctuation">,</span> mediaid<span class="token keyword">match</span> <span class="token punctuation">(</span>mf:MediaFile<span class="token punctuation">)</span> <span class="token keyword">where</span> mf<span class="token punctuation">.</span>uuid<span class="token operator">=</span>mediaid<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>包含文件<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>mf<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据材料库standardNos-与标准规范库创建关系"><a href="#根据材料库standardNos-与标准规范库创建关系" class="headerlink" title="根据材料库standardNos,与标准规范库创建关系"></a>根据材料库standardNos,与标准规范库创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Material&#123;dataType:<span class="token string">'1'</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">where</span> m<span class="token punctuation">.</span>standardNos <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token keyword">with</span> m<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>standardNos<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> standardNoListunwind standardNoList <span class="token keyword">as</span> standardNo<span class="token keyword">with</span> m<span class="token punctuation">,</span> standardNo<span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span> <span class="token keyword">where</span> s<span class="token punctuation">.</span>path <span class="token keyword">contains</span> standardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>涉及规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="媒体文件与材料节点关系表导入关系"><a href="#媒体文件与材料节点关系表导入关系" class="headerlink" title="媒体文件与材料节点关系表导入关系"></a>媒体文件与材料节点关系表导入关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///meidaFile&amp;material.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Material&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>Materialuuid&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>mf:MediaFile&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>MediaFileuuid&#125;<span class="token punctuation">)</span><span class="token keyword">with</span> m<span class="token punctuation">,</span>mf<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>包含文件<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>mf<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="材料上下级关系建立，根据uuid"><a href="#材料上下级关系建立，根据uuid" class="headerlink" title="材料上下级关系建立，根据uuid"></a>材料上下级关系建立，根据uuid</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Material<span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>r:Material<span class="token punctuation">)</span><span class="token keyword">where</span> r<span class="token punctuation">.</span>typeUuid <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>rp:Material<span class="token punctuation">)</span>     <span class="token keyword">where</span> rp<span class="token punctuation">.</span>uuid<span class="token operator">=</span>i<span class="token punctuation">.</span>typeUuid    <span class="token keyword">with</span> i<span class="token punctuation">,</span>rp    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>rp<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="通用标准"><a href="#通用标准" class="headerlink" title="通用标准"></a>通用标准</h3><h4 id="通用标准信息-婚姻状态"><a href="#通用标准信息-婚姻状态" class="headerlink" title="通用标准信息-婚姻状态"></a>通用标准信息-婚姻状态</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///MaritalStatus.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:MaritalStatus &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>maritalStatus<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>MaritalStatus<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-民族"><a href="#通用标准信息-民族" class="headerlink" title="通用标准信息-民族"></a>通用标准信息-民族</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Nation.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Nation &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>romeName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>RomeName<span class="token punctuation">,</span>m<span class="token punctuation">.</span>letterCode<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>LetterCode<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-政治面貌"><a href="#通用标准信息-政治面貌" class="headerlink" title="通用标准信息-政治面貌"></a>通用标准信息-政治面貌</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///PoliticalStatus.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:PoliticalStatus &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>politicalStatus<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>PoliticalStatus<span class="token punctuation">,</span>m<span class="token punctuation">.</span>romeName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>RomeName<span class="token punctuation">,</span>m<span class="token punctuation">.</span>shortName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ShortName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ShortName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-宗教"><a href="#通用标准信息-宗教" class="headerlink" title="通用标准信息-宗教"></a>通用标准信息-宗教</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Religion.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Religion &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-性别"><a href="#通用标准信息-性别" class="headerlink" title="通用标准信息-性别"></a>通用标准信息-性别</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Sex.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Sex &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>sexName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SexName<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-行政区划（先创建索引，之后再导）"><a href="#通用标准信息-行政区划（先创建索引，之后再导）" class="headerlink" title="通用标准信息-行政区划（先创建索引，之后再导）"></a>通用标准信息-行政区划（先创建索引，之后再导）</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Region<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///xzqh_Region.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Region &#123;id: <span class="token keyword">row</span><span class="token punctuation">.</span>region_id&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>parentId<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>parent_id <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>parent_id <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>code<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>code<span class="token punctuation">,</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>countryId<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>country_id<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">level</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>startDate<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>start_date<span class="token punctuation">,</span>m<span class="token punctuation">.</span>endDate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>end_date <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>end_date <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">5000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-国家"><a href="#通用标准信息-国家" class="headerlink" title="通用标准信息-国家"></a>通用标准信息-国家</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///xzqh_Country.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Country &#123;id: <span class="token keyword">row</span><span class="token punctuation">.</span>country_id&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>code_n<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_n <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_n <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>code_s<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_s <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_s <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>code_t<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_t <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_t <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>english_name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>continent<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>continent&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-行政区划根据父级id-创建关系"><a href="#通用标准信息-行政区划根据父级id-创建关系" class="headerlink" title="通用标准信息-行政区划根据父级id 创建关系"></a>通用标准信息-行政区划根据父级id 创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>r:Region<span class="token punctuation">)</span><span class="token keyword">where</span> r<span class="token punctuation">.</span>parentId <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>rp:Region<span class="token punctuation">)</span>     <span class="token keyword">where</span> rp<span class="token punctuation">.</span>id<span class="token operator">=</span>i<span class="token punctuation">.</span>parentId     <span class="token keyword">with</span> i<span class="token punctuation">,</span>rp    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rp<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>或者</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///xzqh_Region_Relationship.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>r:Region&#123;id:<span class="token keyword">row</span><span class="token punctuation">.</span>region_id&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rr:Region&#123;id:<span class="token keyword">row</span><span class="token punctuation">.</span>parent_id&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rr<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-行政区划与国家创建关系"><a href="#通用标准信息-行政区划与国家创建关系" class="headerlink" title="通用标准信息-行政区划与国家创建关系"></a>通用标准信息-行政区划与国家创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>r:Region<span class="token punctuation">)</span> <span class="token keyword">where</span> r<span class="token punctuation">.</span>parentId <span class="token operator">is</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">match</span> <span class="token punctuation">(</span>c:Country&#123;id:i<span class="token punctuation">.</span>countryId&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>所属国家<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准用到的规范导入"><a href="#通用标准用到的规范导入" class="headerlink" title="通用标准用到的规范导入"></a>通用标准用到的规范导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///新增民族婚姻状态等规范.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联"><a href="#通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联" class="headerlink" title="通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联"></a>通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:MaritalStatus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:Nation<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:PoliticalStatus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:Religion<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:Sex<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="国民经济"><a href="#国民经济" class="headerlink" title="国民经济"></a>国民经济</h3><h4 id="国民经济行业分类导入"><a href="#国民经济行业分类导入" class="headerlink" title="国民经济行业分类导入"></a>国民经济行业分类导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :NationEconomyIndustryClass<span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///national_economy_industry.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:NationEconomyIndustryClass &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>annotation<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>annotation <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>annotation <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>parentCode<span class="token punctuation">,</span>m<span class="token punctuation">.</span>classType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>classType<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">level</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="国民经济行业分类关系创建"><a href="#国民经济行业分类关系创建" class="headerlink" title="国民经济行业分类关系创建"></a>国民经济行业分类关系创建</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode <span class="token operator">&lt;></span> <span class="token number">0</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:NationEconomyIndustryClass<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>parentCode    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="国民经济行业添加来源规范属性并创建规范关系"><a href="#国民经济行业添加来源规范属性并创建规范关系" class="headerlink" title="国民经济行业添加来源规范属性并创建规范关系"></a>国民经济行业添加来源规范属性并创建规范关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///国民经济分类.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span class="token punctuation">;</span><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass<span class="token punctuation">)</span> <span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token string">'0'</span> <span class="token keyword">set</span> n<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token string">'GB/T 4754-2017'</span><span class="token punctuation">;</span><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass<span class="token punctuation">)</span> <span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token string">'0'</span> <span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument&#123;hasNO:<span class="token string">'GB/T 4754-2017'</span>&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品分类库导入"><a href="#产品分类库导入" class="headerlink" title="产品分类库导入"></a>产品分类库导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :ProductCategory<span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///产品分类库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:ProductCategory &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>parentCode<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">level</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品分类库关系创建"><a href="#产品分类库关系创建" class="headerlink" title="产品分类库关系创建"></a>产品分类库关系创建</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:ProductCategory<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode <span class="token operator">&lt;></span> <span class="token number">0</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:ProductCategory<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>parentCode    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织结构库导入"><a href="#组织结构库导入" class="headerlink" title="组织结构库导入"></a>组织结构库导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Organization<span class="token punctuation">(</span>UnifiedSocialCreditCode<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///组织机构_港通_数据.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Organization &#123;UnifiedSocialCreditCode: <span class="token keyword">row</span><span class="token punctuation">.</span>UnifiedSocialCreditCode&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>CName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CShortName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CShortName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CShortName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>EName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>EShortName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EShortName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EShortName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>OrganizationStructureCategory<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OrganizationStructureCategory <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OrganizationStructureCategory <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>LegalPersonProperty<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalPersonProperty <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalPersonProperty <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>LegalRepresentative<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalRepresentative <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalRepresentative <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>IsUsing<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>IsUsing <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>IsUsing <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>RegistrationAuthority<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegistrationAuthority <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegistrationAuthority <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Introduction<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Introduction <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Introduction <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Coordinate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Coordinate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Coordinate <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>DetailedAddress<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DetailedAddress <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DetailedAddress <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CountryCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CountryCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CountryCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ProvinceCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProvinceCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProvinceCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CityCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CityCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CityCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>DistrictCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DistrictCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DistrictCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>NationEconomyIndustryCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>NationEconomyIndustryCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>NationEconomyIndustryCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ProductClassCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProductClassCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProductClassCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Tel<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Tel <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Tel <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Email<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Email <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Email <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>PostalCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>PostalCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>PostalCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Fax<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Fax <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Fax <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>OfficialWebsite<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OfficialWebsite <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OfficialWebsite <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ManagementState<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ManagementState <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ManagementState <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>BusinessRegistrationNo<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessRegistrationNo <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessRegistrationNo <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>RegisteredCapital<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegisteredCapital <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegisteredCapital <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>EstablishedDate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EstablishedDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EstablishedDate <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CancelDate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CancelDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CancelDate <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>BusinessTerm<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessTerm <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessTerm <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>BusinessScope<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessScope <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessScope <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与产品分类建立关系"><a href="#组织机构与产品分类建立关系" class="headerlink" title="组织机构与产品分类建立关系"></a>组织机构与产品分类建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>ProductClassCode<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> pcodeListunwind pcodeList <span class="token keyword">as</span> pcode<span class="token keyword">with</span> o<span class="token punctuation">,</span> pcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:ProductCategory&#123;code:pcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>产品<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与国民行业分类建立关系"><a href="#组织机构与国民行业分类建立关系" class="headerlink" title="组织机构与国民行业分类建立关系"></a>组织机构与国民行业分类建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>NationEconomyIndustryCode<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> pcodeListunwind pcodeList <span class="token keyword">as</span> pcode<span class="token keyword">with</span> o<span class="token punctuation">,</span> pcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:NationEconomyIndustryClass&#123;code:pcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>行业<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与国家建立关系"><a href="#组织机构与国家建立关系" class="headerlink" title="组织机构与国家建立关系"></a>组织机构与国家建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Country&#123;code_n:o<span class="token punctuation">.</span>CountryCode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:国家<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="组织机构与行政区划建立关系"><a href="#组织机构与行政区划建立关系" class="headerlink" title="组织机构与行政区划建立关系"></a>组织机构与行政区划建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Region&#123;code:o<span class="token punctuation">.</span>ProvinceCode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:行政区划<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Region&#123;code:o<span class="token punctuation">.</span>CityCode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:行政区划<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Region&#123;code:o<span class="token punctuation">.</span>DistrictCode<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:行政区划<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>示例脚本</title>
      <link href="/2022/07/18/%E6%BC%94%E7%A4%BA%E8%84%9A%E6%9C%AC/"/>
      <url>/2022/07/18/%E6%BC%94%E7%A4%BA%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> p<span class="token operator">=</span><span class="token punctuation">(</span>n:Region<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token operator">*</span><span class="token number">0.</span><span class="token number">.2</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region&#123;name:<span class="token string">'芝罘区'</span>&#125;<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region<span class="token punctuation">)</span> <span class="token keyword">match</span> pp<span class="token operator">=</span><span class="token punctuation">(</span>n:Region&#123;name:<span class="token string">'山东省'</span>&#125;<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region&#123;name:<span class="token string">'烟台市'</span>&#125;<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region<span class="token punctuation">)</span>  <span class="token keyword">RETURN</span> p<span class="token punctuation">,</span>pp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> p<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>产品<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">match</span> p1<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>国家<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">match</span> p2<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行业<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">match</span> p3<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政区划<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">RETURN</span> p<span class="token punctuation">,</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">,</span>p3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:Material<span class="token punctuation">)</span> <span class="token keyword">RETURN</span> n <span class="token keyword">LIMIT</span> <span class="token number">50</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> p<span class="token operator">=</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass&#123;name:<span class="token string">'建筑业'</span>&#125;<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>:NationEconomyIndustryClass&#123;name:<span class="token string">'土木工程建筑业'</span>&#125;<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token operator">*</span><span class="token number">0.</span><span class="token number">.3</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">RETURN</span> p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span>  p<span class="token operator">=</span> <span class="token punctuation">(</span>m:Staff&#123;staffId:<span class="token string">'GT1183'</span>&#125;<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token number">0.</span><span class="token number">.1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
