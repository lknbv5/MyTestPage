<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CentOS7 部署.NetCore 项目</title>
      <link href="/2023/07/14/CentOS7%20%E9%83%A8%E7%BD%B2.NetCore%20%E9%A1%B9%E7%9B%AE/"/>
      <url>/2023/07/14/CentOS7%20%E9%83%A8%E7%BD%B2.NetCore%20%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="一-流程步骤总览"><a href="#一-流程步骤总览" class="headerlink" title="一. 流程步骤总览"></a>一. 流程步骤总览</h4><ol><li><p>安装  <strong><code>dotnet</code></strong>  SDK&#x2F;运行环境</p></li><li><p>打包&#x2F;发布项目,  将发布文件 <strong><code>copy</code></strong> 到 <strong><code>linux</code></strong></p></li><li><p>安装进程守护管理工具  <strong><code>PM2</code></strong> ,用**<code>PM2</code>**启动 <strong><code>.net core</code></strong> 服务</p></li><li><p>开启防火墙端口, 例如开放 8080 端口</p></li></ol><h4 id="二-安装-dotnet-SDK"><a href="#二-安装-dotnet-SDK" class="headerlink" title="二. 安装 dotnet SDK"></a>二. 安装 dotnet SDK</h4><p>（以下步骤以安装 .net core 3.1 为例）</p><h5 id="（一）手动安装-SDK"><a href="#（一）手动安装-SDK" class="headerlink" title="（一）手动安装 SDK"></a>（一）手动安装 SDK</h5><ol><li><p>下载 SDK 二进制安装包</p><ul><li><p>下载地址： <a href="https://dotnet.microsoft.com/download/dotnet/3.1">https://dotnet.microsoft.com/download/dotnet/3.1</a></p></li><li><p>可先在windows里下载完, 再复制到Linux 中; </p><p>也可使用Linux 直接下载, 脚本如下:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#cd 到下载或安装路径文件夹</span><span class="token builtin class-name">cd</span> /youPath/dotnet/<span class="token comment">#下载</span><span class="token function">wget</span> https://download.visualstudio.microsoft.com/download/pr/e89c4f00-5cbb-4810-897d-f5300165ee60/027ace0fdcfb834ae0a13469f0b1a4c8/dotnet-sdk-3.1.426-linux-x64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li><p>解压、添加环境变量</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 解压到当前目录</span><span class="token function">tar</span> zxf dotnet-sdk-3.1.426-linux-x64.tar.gz <span class="token comment"># 添加到环境变量</span><span class="token function">vi</span> /etc/profile <span class="token comment">#打开配置文件</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">DOTNET_ROOT</span><span class="token operator">=</span>/youPath/dotnet<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/youPath/dotnet<span class="token comment"># 生效配置</span><span class="token builtin class-name">source</span> /etc/profile  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h5 id="（二）包管理器-yum-安装-SDK"><a href="#（二）包管理器-yum-安装-SDK" class="headerlink" title="（二）包管理器 yum 安装 SDK"></a>（二）包管理器 yum 安装 SDK</h5>   <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">rpm</span> -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm<span class="token function">sudo</span> yum -y <span class="token function">install</span> dotnet-sdk-3.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="（三）检查安装是否成功"><a href="#（三）检查安装是否成功" class="headerlink" title="（三）检查安装是否成功"></a>（三）检查安装是否成功</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost<span class="token punctuation">]</span><span class="token comment"># dotnet --info</span><span class="token comment"># 安装成功, 应显示如下信息</span>.NET Core SDK <span class="token punctuation">(</span>reflecting any global.json<span class="token punctuation">)</span>: Version:   <span class="token number">3.1</span>.426 Commit:    e81f6c8565Runtime Environment: OS Name:     centos OS Version:  <span class="token number">7</span> OS Platform: Linux RID:         centos.7-x64 Base Path:   /home/dotnet/sdk/3.1.426/Host <span class="token punctuation">(</span>useful <span class="token keyword">for</span> support<span class="token punctuation">)</span>:  Version: <span class="token number">3.1</span>.32  Commit:  f94bb2c3ff.NET Core SDKs installed:  <span class="token number">3.1</span>.426 <span class="token punctuation">[</span>/home/dotnet/sdk<span class="token punctuation">]</span>.NET Core runtimes installed:  Microsoft.AspNetCore.App <span class="token number">3.1</span>.32 <span class="token punctuation">[</span>/home/dotnet/shared/Microsoft.AspNetCore.App<span class="token punctuation">]</span>  Microsoft.NETCore.App <span class="token number">3.1</span>.32 <span class="token punctuation">[</span>/home/dotnet/shared/Microsoft.NETCore.App<span class="token punctuation">]</span>To <span class="token function">install</span> additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="三-发布项目-此步略…"><a href="#三-发布项目-此步略…" class="headerlink" title="三. 发布项目(此步略…)"></a>三. 发布项目(此步略…)</h4><h4 id="四-安装-PM2-并启动项目"><a href="#四-安装-PM2-并启动项目" class="headerlink" title="四. 安装  PM2 并启动项目"></a>四. 安装  <strong><code>PM2</code></strong> 并启动项目</h4><h5 id="（一）安装NodeJs"><a href="#（一）安装NodeJs" class="headerlink" title="（一）安装NodeJs"></a>（一）安装NodeJs</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 下载node安装包到指定目录 官网下载: https://nodejs.org/en/download 选择Linux对应的二进制包</span><span class="token function">wget</span> https://registry.npmmirror.com/-/binary/node/v14.18.1/node-v14.18.1-linux-x64.tar.xz<span class="token comment"># 解压安装包</span><span class="token function">tar</span> -xvf node-v14.18.1-linux-x64.tar.gz<span class="token function">mv</span> node-v14.18.1-linux-x64 /usr/local/nodejs<span class="token comment"># 配置环境变量</span><span class="token function">vi</span> /etc/profile <span class="token comment"># 打开配置文件</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">NODE_HOME</span><span class="token operator">=</span>/usr/local/nodejs<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$NODE_HOME</span>/bin:<span class="token environment constant">$PATH</span><span class="token comment"># :wq保存，然后运行命令，使得环境变量生效</span><span class="token builtin class-name">source</span> /etc/profile<span class="token comment"># 检查是否安装成功</span><span class="token function">node</span> -v<span class="token comment"># 输出> V x.x.x</span><span class="token function">npm</span> -v<span class="token comment"># 输出> x.x.x</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="（二）安装-PM2"><a href="#（二）安装-PM2" class="headerlink" title="（二）安装 PM2"></a>（二）安装 PM2</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 全局安装PM2</span><span class="token function">npm</span> <span class="token function">install</span> pm2 -g<span class="token comment"># 检查安装结果</span>pm2 -v <span class="token comment"># 成功 输出 x.x.x</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h5 id="（三）PM2-启动程序"><a href="#（三）PM2-启动程序" class="headerlink" title="（三）PM2 启动程序"></a>（三）PM2 启动程序</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pm2 start <span class="token string">"dotnet testwebapi.dll"</span> --name testwebapi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li><p>常见PM2 命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span>. 启动<span class="token comment"># pm2 start app.js</span><span class="token comment"># pm2 start app.js --name my-api   #my-api为PM2进程名称</span><span class="token comment"># pm2 start app.js -i 0           #根据CPU核数启动进程个数</span><span class="token comment"># pm2 start app.js --watch   #实时监控app.js的方式启动，当app.js文件有变动时，pm2会自动reload</span><span class="token number">2</span>. 查看进程<span class="token comment"># pm2 list</span><span class="token comment"># pm2 show 0 或者 # pm2 info 0  #查看进程详细信息，0为PM2进程id</span><span class="token number">3</span>. 监控<span class="token comment"># pm2 monit</span><span class="token number">4</span>. 停止<span class="token comment"># pm2 stop all  #停止PM2列表中所有的进程</span><span class="token comment"># pm2 stop 0    #停止PM2列表中进程为0的进程</span><span class="token number">5</span>. 重载<span class="token comment"># pm2 reload all    #重载PM2列表中所有的进程</span><span class="token comment"># pm2 reload 0     #重载PM2列表中进程为0的进程</span><span class="token number">6</span>. 重启<span class="token comment"># pm2 restart all     #重启PM2列表中所有的进程</span><span class="token comment"># pm2 restart 0      #重启PM2列表中进程为0的进程</span><span class="token number">7</span>. 删除PM2进程<span class="token comment"># pm2 delete 0     #删除PM2列表中进程为0的进程</span><span class="token comment"># pm2 delete all   #删除PM2列表中所有的进程</span><span class="token number">8</span>. 日志操作<span class="token comment"># pm2 logs [--raw]   #Display all processes logs in streaming</span><span class="token comment"># pm2 flush              #Empty all log file</span><span class="token comment"># pm2 reloadLogs    #Reload all logs</span><span class="token number">9</span>. 升级PM2<span class="token comment"># npm install pm2@lastest -g   #安装最新的PM2版本</span><span class="token comment"># pm2 updatePM2                    #升级pm2</span><span class="token number">10</span>. 更多命令参数请查看帮助, 或官方文档<span class="token comment"># pm2 --help</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>PM2 使用配置文件 启动管理服务</p><p>要生成示例配置文件，可以键入以下命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 init simple<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这将生成一个默认的配置文件 <code>ecosystem.config.js</code>:</p> <pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">apps</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span>   <span class="token operator">:</span> <span class="token string">"server1"</span><span class="token punctuation">,</span>    <span class="token literal-property property">script</span> <span class="token operator">:</span> <span class="token string">"dotnet webapi.dll"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用配置文件</p><blockquote><p>启动所有的应用程序</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 start ecosystem.config.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>停止所有应用程序</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 stop ecosystem.config.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>重启所有应用程序</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 restart ecosystem.config.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>重载所有应用程序</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 reload ecosystem.config.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>删除所有应用程序</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 delete ecosystem.config.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>应用于特定的应用程序</p></blockquote><p>我们还可以通过使用选项 <code>--only &lt;app_name&gt;</code> 指定应用程序名称对特定应用程序进行操作：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 start   ecosystem.config.js --only api-app<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>注意</code>： <strong>–only</strong> 选项也适用于启动&#x2F;重启&#x2F;停止&#x2F;删除</p></blockquote><p>甚至可以通过指定用逗号分隔的每个应用程序名称来指定要对其执行操作的多个应用程序：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 start ecosystem.config.js --only <span class="token string">"api-app,worker-app"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>切换环境</p></blockquote><p>可以通过 <code>env_*</code> 选项指定不同的环境变量集。</p><blockquote><p><strong><code>示例</code></strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">apps</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span>   <span class="token operator">:</span> <span class="token string">"app1"</span><span class="token punctuation">,</span>    <span class="token literal-property property">script</span> <span class="token operator">:</span> <span class="token string">"./app.js"</span><span class="token punctuation">,</span>    <span class="token literal-property property">env_production</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>       <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">"production"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token literal-property property">env_development</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>       <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">"development"</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><p>现在要在不同环境中的变量之间切换，请指定 <code>--env [env name]</code> 选项：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pm2 start process.json --env production$ pm2 restart process.json --env development<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>配置文件可用属性</p></blockquote><p>可以使用以下属性调整应用程序行为和配置：</p><blockquote><p>通用属性</p></blockquote><table><thead><tr><th>字段</th><th>类型</th><th>示例</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>(string)</td><td>“my-api”</td><td>应用程序名称 (默认为脚本名称)</td></tr><tr><td>script</td><td>(string)</td><td>”.&#x2F;api&#x2F;app.js”</td><td>相对于 pm2 start 的脚本路径</td></tr><tr><td>cwd</td><td>(string)</td><td>“&#x2F;var&#x2F;www&#x2F;”</td><td>将启动您的应用程序的目录</td></tr><tr><td>args</td><td>(string)</td><td>“-a 13 -b 12”</td><td>包含通过 CLI 传递给脚本的所有参数的字符串</td></tr><tr><td>interpreter</td><td>(string)</td><td>“&#x2F;usr&#x2F;bin&#x2F;python”</td><td>解释器绝对路径（默认为 node ）</td></tr><tr><td>interpreter_args</td><td>(string)</td><td>”–harmony”</td><td>传递给解释器的选项</td></tr><tr><td>node_args</td><td>(string)</td><td></td><td>interpreter_args的别名</td></tr></tbody></table><blockquote><p>高级特性</p></blockquote><table><thead><tr><th>字段</th><th>类型</th><th>示例</th><th>描述</th></tr></thead><tbody><tr><td>instances</td><td>number</td><td>-1</td><td>要启动的应用程序实例数</td></tr><tr><td>exec_mode</td><td>string</td><td>“cluster”</td><td>启动应用程序的模式，可以是“cluster”或“fork”，默认fork</td></tr><tr><td>watch</td><td>boolean or []</td><td>true</td><td>启用监视和重启功能，如果文件夹或子文件夹中的文件发生更改，您的应用程序将重新加载</td></tr><tr><td>ignore_watch</td><td>list</td><td>[”[&#x2F;].&#x2F;”, “node_modules”]</td><td>通过监视功能忽略某些文件或文件夹名称的正则表达式列表</td></tr><tr><td>max_memory_restart</td><td>string</td><td>“150M”</td><td>如果超过指定的内存量，您的应用程序将重新启动。 人性化的格式：可以是“10M”、“100K”、“2G”等等……</td></tr><tr><td>env</td><td>object</td><td>{“NODE_ENV”: “development”, “ID”: “42”}</td><td>env variables which will appear in your app</td></tr><tr><td>env_</td><td>object</td><td>{“NODE_ENV”: “production”, “ID”: “89”}</td><td>在执行 <code>pm2 restart app.yml --env</code> 时注入</td></tr><tr><td>source_map_support</td><td>boolean</td><td>true</td><td>默认为 true，[启用&#x2F;禁用源映射文件]</td></tr><tr><td>instance_var</td><td>string</td><td>“NODE_APP_INSTANCE”</td><td>查看文档</td></tr><tr><td>filter_env</td><td>array of string</td><td>[ “REACT_” ]</td><td>排除以“REACT_”开头的全局变量，并且不允许它们渗透到集群中。</td></tr></tbody></table><blockquote><p>日志文件</p></blockquote><table><thead><tr><th>字段</th><th>类型</th><th>示例</th><th>描述</th></tr></thead><tbody><tr><td>error_file</td><td>(string)</td><td></td><td>指定错误日志文件 (默认 $HOME&#x2F;.pm2&#x2F;logs&#x2F;XXXerr.log)</td></tr><tr><td>out_file</td><td>(string)</td><td></td><td>指定标准输出日志文件 (默认 $HOME&#x2F;.pm2&#x2F;logs&#x2F;XXXout.log)</td></tr><tr><td>pid_file</td><td>(string)</td><td></td><td>指定pid进程文件 (默认 $HOME&#x2F;.pm2&#x2F;pid&#x2F;app-pm_id.pid)</td></tr><tr><td>merge_logs</td><td>boolean</td><td>true</td><td>如果设置为 true，则避免使用进程 id 后缀日志文件</td></tr><tr><td>log_date_format</td><td>(string)</td><td>“YYYY-MM-DD HH:mm Z”</td><td>日志时间日期格式</td></tr></tbody></table><blockquote><p>控制流</p></blockquote><table><thead><tr><th>字段</th><th>类型</th><th>示例</th><th>描述</th></tr></thead><tbody><tr><td>min_uptime</td><td>(string)</td><td></td><td>被视为启动的应用程序的最小正常运行时间</td></tr><tr><td>listen_timeout</td><td>number</td><td>8000</td><td>如果应用程序未在侦听，则强制重新加载之前的时间（以毫秒为单位）</td></tr><tr><td>kill_timeout</td><td>number</td><td>1600</td><td>发送最终 SIGKILL 之前的时间（以毫秒为单位）</td></tr><tr><td>shutdown_with_message</td><td>boolean</td><td>false</td><td>使用 process.send(‘shutdown’) 而不是 process.kill(pid, SIGINT) 关闭应用程序</td></tr><tr><td>wait_ready</td><td>boolean</td><td>false</td><td>等待 process.send(‘ready’) 而不是重新加载等待监听事件</td></tr><tr><td>max_restarts</td><td>number</td><td>10</td><td>在您的应用程序被视为错误并停止重新启动之前，连续不稳定重新启动的次数（小于 1 秒间隔或通过 min_uptime 自定义时间）</td></tr><tr><td>restart_delay</td><td>number</td><td>4000</td><td>在重新启动崩溃的应用程序之前等待的时间（以毫秒为单位）。 默认为 0。</td></tr><tr><td>autorestart</td><td>boolean</td><td>false</td><td>默认为 true 。 如果为 false，如果应用程序崩溃或和平结束，PM2 将不会重新启动您的应用程序</td></tr><tr><td>cron_restart</td><td>string</td><td>“1 0 * * *”</td><td>使用 cron 模式定时任务来重新启动你的应用程序。 应用程序必须正在运行才能使 cron 功能正常工作</td></tr><tr><td>vizion</td><td>boolean</td><td>false</td><td>默认为真。 如果为 false，PM2 将在没有 vizion 功能的情况下启动（版本控制元数据）</td></tr><tr><td>post_update</td><td>list</td><td>[“npm install”, “echo launching the app”]</td><td>从 Keymetrics 控制面板执行 Pull&#x2F;Upgrade 操作后将执行的命令列表</td></tr><tr><td>force</td><td>boolean</td><td>true</td><td>默认为 false。 如果为 true，可以多次启动同一个脚本，这通常是 PM2 不允许的</td></tr></tbody></table></li></ol><h4 id="五-开放防火墙端口"><a href="#五-开放防火墙端口" class="headerlink" title="五. 开放防火墙端口"></a>五. 开放防火墙端口</h4>   <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 安装Firewall命令(没有则安装)</span>yum <span class="token function">install</span> firewalld firewalld-config<span class="token comment"># 开放常见端口命令:</span>firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">80</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">443</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">22</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">21</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">53</span>/udp --permanent<span class="token comment"># 开启本项目8080端口</span>firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">8080</span>/tcp --permanent<span class="token comment"># 关闭常见端口命令</span>firewall-cmd --zone<span class="token operator">=</span>public --remove-port<span class="token operator">=</span><span class="token number">80</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --remove-port<span class="token operator">=</span><span class="token number">443</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --remove-port<span class="token operator">=</span><span class="token number">22</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --remove-port<span class="token operator">=</span><span class="token number">21</span>/tcp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --remove-port<span class="token operator">=</span><span class="token number">53</span>/udp --permanent<span class="token comment"># 批量添加区间端口</span>firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">4400</span>-4600/udp --permanentfirewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">4400</span>-4600/tcp --permanent<span class="token comment"># 开启防火墙命令</span>systemctl start firewalld.service<span class="token comment"># 重启防火墙命令</span>firewall-cmd --reload 或者 <span class="token function">service</span> firewalld restart<span class="token comment"># 查看防火墙端口列表</span>firewall-cmd --permanent --list-port<span class="token comment"># 禁用防火墙</span>systemctl stop firewalld<span class="token comment"># 查看防火墙状态</span>systemctl status firewalld或者 firewall-cmd --state<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> .NetCore </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/03/10/ES%E6%A3%80%E7%B4%A2%E8%AF%AD%E5%8F%A5%E7%A4%BA%E4%BE%8B/"/>
      <url>/2023/03/10/ES%E6%A3%80%E7%B4%A2%E8%AF%AD%E5%8F%A5%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h4 id="ES项目查询示例"><a href="#ES项目查询示例" class="headerlink" title="ES项目查询示例"></a>ES项目查询示例</h4><pre class="line-numbers language-json" data-language="json"><code class="language-json">GET /standard/_search<span class="token punctuation">&#123;</span>    <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>        <span class="token property">"bool"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token property">"filter"</span><span class="token operator">:</span>                <span class="token punctuation">&#123;</span>                    <span class="token property">"nested"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                        <span class="token property">"path"</span><span class="token operator">:</span><span class="token string">"FengPi"</span><span class="token punctuation">,</span>                        <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                            <span class="token property">"bool"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                                <span class="token property">"must"</span><span class="token operator">:</span><span class="token punctuation">[</span>                                    <span class="token punctuation">&#123;</span>                                        <span class="token property">"match"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                                            <span class="token property">"FengPi.nameCN"</span><span class="token operator">:</span><span class="token string">"鞋"</span>                                        <span class="token punctuation">&#125;</span>                                    <span class="token punctuation">&#125;</span>                                <span class="token punctuation">]</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"_source"</span><span class="token operator">:</span><span class="token string">"FengPi"</span><span class="token punctuation">&#125;</span>GET /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"nested"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"ZhengWen"</span><span class="token punctuation">,</span>      <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"must_not"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">&#123;</span>              <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"ZhengWen.公式.keyword"</span><span class="token operator">:</span> <span class="token string">""</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token string">"ZhengWen"</span><span class="token punctuation">&#125;</span>Get /standard/_doc/<span class="token number">4</span>Get /standard/_searchget /standard/_mappingput /standard/_mapping<span class="token punctuation">&#123;</span>      <span class="token property">"dynamic"</span><span class="token operator">:</span> <span class="token string">"false"</span><span class="token punctuation">,</span>      <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"FengPi"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"nested"</span><span class="token punctuation">,</span>          <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"Safety"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"_custom_generated_pk"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"boolean"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"_partial"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"boolean"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"_saved_in_db"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"boolean"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"degreeOfConsistencyIdentification"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>            <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"equateid"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>            <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"fileCode"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"file_name"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"hasAQ"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"hasCCS"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"hasGBW_CCS"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"hasIS"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"hasNo"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"hasSN"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"implementationDate"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"date"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"index"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"levelsOrCategories"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"maintainerNO"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"nameCN"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"nameEN"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"path"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"releaseDate"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"date"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"releaseYear"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"replacedNO"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"standardCode"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"updated"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"date"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"发布机构"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"强制或推荐"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"有效性"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"适用专业"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"适用范围"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"Index"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"Mulu"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"TiaoWen"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"nested"</span><span class="token punctuation">,</span>          <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"公式"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"列项退格"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"子集编号"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"富文本"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"强条"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"boolean"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"样式标签"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"父级编号"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"纯文本"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"隐藏标记"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"boolean"</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"Title"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>          <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>              <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>          <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"ZhengWen"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"nested"</span><span class="token punctuation">,</span>          <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"公式"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"列项退格"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"子集编号"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"富文本"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"强条"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"boolean"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"显示条文"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"样式标签"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"父级编号"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"long"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"纯文本"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>              <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"search_analyzer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>              <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"keyword"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span><span class="token punctuation">,</span>                  <span class="token property">"ignore_above"</span><span class="token operator">:</span> <span class="token number">256</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"隐藏标记"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"boolean"</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span># 更新Nested嵌套数据中的字段<span class="token punctuation">,</span>如果是集合<span class="token punctuation">,</span>取到集合字段<span class="token punctuation">,</span>遍历集合<span class="token punctuation">,</span>判断符合条件的项后<span class="token punctuation">,</span>更改该项的字段post /standard/_update/<span class="token number">4</span><span class="token punctuation">&#123;</span>  <span class="token property">"script"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"source"</span><span class="token operator">:</span> <span class="token string">""</span>"        ctx._source.FengPi=params.fengpi    <span class="token string">""</span>"<span class="token punctuation">,</span>    <span class="token property">"lang"</span><span class="token operator">:</span> <span class="token string">"painless"</span><span class="token punctuation">,</span>    <span class="token property">"params"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"fengpi"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"_partial"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>      <span class="token property">"_saved_in_db"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token property">"_custom_generated_pk"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>      <span class="token property">"发布机构"</span><span class="token operator">:</span> <span class="token string">"国家安全生产监督管理总局"</span><span class="token punctuation">,</span>      <span class="token property">"hasNo"</span><span class="token operator">:</span> <span class="token string">"AQ/T 6108-2008"</span><span class="token punctuation">,</span>      <span class="token property">"强制或推荐"</span><span class="token operator">:</span> <span class="token string">"推荐性标准"</span><span class="token punctuation">,</span>      <span class="token property">"updated"</span><span class="token operator">:</span> <span class="token string">"2022-06-02"</span><span class="token punctuation">,</span>      <span class="token property">"nameEN"</span><span class="token operator">:</span> <span class="token string">"Selection , use,and maintenance of safety,protective and occupational footwear"</span><span class="token punctuation">,</span>      <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"CCS/C/C73/AQ-T 6108-2008_安全鞋、防护鞋和职业鞋的选择、使用和维护.pdf"</span><span class="token punctuation">,</span>      <span class="token property">"hasAQ"</span><span class="token operator">:</span> <span class="token string">"25469-2009"</span><span class="token punctuation">,</span>      <span class="token property">"nameCN"</span><span class="token operator">:</span> <span class="token string">"安全鞋、防护鞋和职业鞋的选择、使用和维护"</span><span class="token punctuation">,</span>      <span class="token property">"releaseDate"</span><span class="token operator">:</span> <span class="token string">"2019-11-01"</span><span class="token punctuation">,</span>      <span class="token property">"levelsOrCategories"</span><span class="token operator">:</span> <span class="token string">"中华人民共和国安全生产行业标准"</span><span class="token punctuation">,</span>      <span class="token property">"equateid"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>      <span class="token property">"releaseYear"</span><span class="token operator">:</span> <span class="token number">2008</span><span class="token punctuation">,</span>      <span class="token property">"适用范围"</span><span class="token operator">:</span> <span class="token string">"行业标准"</span><span class="token punctuation">,</span>      <span class="token property">"implementationDate"</span><span class="token operator">:</span> <span class="token string">"2001-01-01"</span><span class="token punctuation">,</span>      <span class="token property">"hasSN"</span><span class="token operator">:</span> <span class="token string">"6108"</span><span class="token punctuation">,</span>      <span class="token property">"有效性"</span><span class="token operator">:</span> <span class="token string">"现行"</span><span class="token punctuation">,</span>      <span class="token property">"hasCCS"</span><span class="token operator">:</span> <span class="token string">"C 73"</span><span class="token punctuation">,</span>      <span class="token property">"hasGBW_CCS"</span><span class="token operator">:</span> <span class="token string">"C73"</span><span class="token punctuation">,</span>      <span class="token property">"maintainerNO"</span><span class="token operator">:</span> <span class="token string">"GT0734"</span><span class="token punctuation">,</span>      <span class="token property">"适用专业"</span><span class="token operator">:</span> <span class="token string">"安全"</span><span class="token punctuation">,</span>      <span class="token property">"file_name"</span><span class="token operator">:</span> <span class="token string">"20221204070435_fca98b52-29d7-4ce2-9328-f568aa151d1aAQT 6108-2008 安全鞋、防护鞋和职业鞋的选择、使用和维护"</span><span class="token punctuation">,</span>      <span class="token property">"standardCode"</span><span class="token operator">:</span> <span class="token string">"AQ/T"</span><span class="token punctuation">,</span>      <span class="token property">"replacedNO"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>      <span class="token property">"hasIS"</span><span class="token operator">:</span> <span class="token string">"ICS 13.340.50"</span><span class="token punctuation">,</span>      <span class="token property">"fileCode"</span><span class="token operator">:</span> <span class="token string">"AQ"</span><span class="token punctuation">,</span>      <span class="token property">"Safety"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>      <span class="token property">"index"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>      <span class="token property">"degreeOfConsistencyIdentification"</span><span class="token operator">:</span> <span class="token string">""</span>"(ISO/TR <span class="token number">18690</span><span class="token operator">:</span><span class="token number">2006</span><span class="token punctuation">,</span>Guidance for the selection<span class="token punctuation">,</span>use<span class="token punctuation">,</span>and maintenance of safety<span class="token punctuation">,</span> protective and occupational footwear<span class="token punctuation">,</span>MOD)<span class="token string">""</span>"    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>get /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span><span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"Index"</span><span class="token operator">:</span> <span class="token number">4</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>      <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"_source"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"FengPi.fileCode"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>POST _analyze<span class="token punctuation">&#123;</span>  <span class="token property">"analyzer"</span><span class="token operator">:</span><span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>  <span class="token property">"text"</span><span class="token operator">:</span><span class="token string">"AQ/T 6108-2008  安全鞋、防护鞋和职业鞋的选择、使用和维护"</span><span class="token punctuation">&#125;</span>get /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>           <span class="token property">"match_phrase"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>             <span class="token property">"Title"</span><span class="token operator">:</span> <span class="token string">"安全鞋"</span>           <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"nested"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                <span class="token property">"path"</span><span class="token operator">:</span><span class="token string">"FengPi"</span><span class="token punctuation">,</span>                <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                    <span class="token property">"bool"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                        <span class="token property">"must"</span><span class="token operator">:</span><span class="token punctuation">[</span>                            <span class="token punctuation">&#123;</span>                              <span class="token property">"terms"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                                <span class="token property">"FengPi.有效性"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"现行"</span><span class="token punctuation">]</span>                              <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>                            <span class="token punctuation">,</span>                            <span class="token punctuation">&#123;</span>                              <span class="token property">"terms"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                                <span class="token property">"FengPi.适用专业"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"安全"</span><span class="token punctuation">]</span>                              <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">]</span><span class="token punctuation">,</span>                        <span class="token property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                          <span class="token punctuation">&#123;</span>                                <span class="token property">"range"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                                    <span class="token property">"FengPi.implementationDate"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                                            <span class="token property">"gte"</span><span class="token operator">:</span> <span class="token string">"2000-12-11"</span><span class="token punctuation">,</span>                                            <span class="token property">"lt"</span><span class="token operator">:</span> <span class="token string">"2022-12-11"</span>                                    <span class="token punctuation">&#125;</span>                                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">]</span>                                                                <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"highlight"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"pre_tags"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token string">"&lt;span style='color:red'>"</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"post_tags"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token string">"&lt;/span>"</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"require_field_match"</span><span class="token operator">:</span> <span class="token string">"false"</span><span class="token punctuation">,</span>    <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"*"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>get /standardterm/_searchget /standardterm/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"term"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"standardterm.keyword"</span><span class="token operator">:</span> <span class="token string">""</span>          <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>PUT standardterm/_settings?preserve_existing=<span class="token boolean">true</span><span class="token punctuation">&#123;</span>  <span class="token property">"index.max_result_window"</span> <span class="token operator">:</span> <span class="token string">"10000000"</span><span class="token punctuation">&#125;</span>get /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"should"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span><span class="token property">"match"</span><span class="token operator">:</span>            <span class="token punctuation">&#123;</span>                <span class="token property">"Title"</span><span class="token operator">:</span><span class="token string">"建筑结构荷载规范"</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"nested"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                <span class="token property">"path"</span><span class="token operator">:</span><span class="token string">"ZhengWen"</span><span class="token punctuation">,</span>                <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                <span class="token property">"ZhengWen.纯文本"</span><span class="token operator">:</span> <span class="token string">"建筑结构荷载规范"</span>                              <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token property">"inner_hits"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>                  <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"ZhengWen.纯文本"</span><span class="token punctuation">]</span>   <span class="token comment">// 嵌套文档中显示字段</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"nested"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                <span class="token property">"path"</span><span class="token operator">:</span><span class="token string">"TiaoWen"</span><span class="token punctuation">,</span>                <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                <span class="token property">"TiaoWen.纯文本"</span><span class="token operator">:</span> <span class="token string">"建筑结构荷载规范"</span>                              <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token property">"inner_hits"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>                  <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"TiaoWen.纯文本"</span><span class="token punctuation">]</span>   <span class="token comment">// 嵌套文档中显示字段</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"_source"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"xx"</span><span class="token punctuation">]</span>   <span class="token comment">// 控制原文档显示字段,xx匹配不到则都不显示</span><span class="token punctuation">&#125;</span>get /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"Index"</span><span class="token operator">:</span> <span class="token number">4</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token string">"FengPi"</span><span class="token punctuation">,</span>    <span class="token string">"ZhengWen"</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span>get /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span><span class="token property">"match"</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>          <span class="token property">"Index"</span><span class="token operator">:</span><span class="token string">"0"</span>        <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>          <span class="token property">"nested"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token property">"path"</span><span class="token operator">:</span><span class="token string">"FengPi"</span><span class="token punctuation">,</span>            <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>              <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"FengPi.file_name.keyword"</span><span class="token operator">:</span> <span class="token string">"202303095628_d2e8ac9a-5460-4e63-84f2-2cd216dee3c1JGJ 120-2012 建筑基坑支护技术规程(1)(1)"</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"_source"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"TiaoWen"</span><span class="token punctuation">,</span><span class="token string">"ZhengWen"</span><span class="token punctuation">,</span><span class="token string">"Mulu"</span><span class="token punctuation">]</span>   <span class="token comment">// 控制原文档显示字段,xx匹配不到则都不显示</span><span class="token punctuation">&#125;</span>get /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>          <span class="token property">"match"</span><span class="token operator">:</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"Index"</span><span class="token operator">:</span><span class="token string">"852"</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"_source"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"FengPi"</span><span class="token punctuation">,</span><span class="token string">"TiaoWen"</span><span class="token punctuation">,</span><span class="token string">"ZhengWen"</span><span class="token punctuation">,</span><span class="token string">"Mulu"</span><span class="token punctuation">]</span>   <span class="token comment">// 控制原文档显示字段,xx匹配不到则都不显示</span><span class="token punctuation">&#125;</span><span class="token comment">// 搜索title中包含建筑的, 且FengPi.file_name=""的数据</span>POST /standard/_search<span class="token punctuation">&#123;</span>    <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>                    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        <span class="token property">"Title"</span><span class="token operator">:</span> <span class="token string">"建筑"</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token punctuation">&#123;</span>                    <span class="token property">"nested"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"FengPi"</span><span class="token punctuation">,</span>                        <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                <span class="token property">"must_not"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                        <span class="token property">"FengPi.file_name.keyword"</span><span class="token operator">:</span> <span class="token string">""</span>                                    <span class="token punctuation">&#125;</span>                                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// 搜索title中包含建筑的, 且不包含ZhengWen的数据</span>POST /standard/_search<span class="token punctuation">&#123;</span>  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>          <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"Title"</span><span class="token operator">:</span> <span class="token string">"建筑"</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span>          <span class="token property">"nested"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"ZhengWen"</span><span class="token punctuation">,</span>            <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"exists"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                    <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"ZhengWen"</span>                  <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>AD 域</title>
      <link href="/2023/03/09/Windows_AD%E5%9F%9F/"/>
      <url>/2023/03/09/Windows_AD%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="AD域-Domain"><a href="#AD域-Domain" class="headerlink" title="AD域(Domain)"></a>AD域(Domain)</h2><h3 id="一、域-Domain-基本介绍"><a href="#一、域-Domain-基本介绍" class="headerlink" title="一、域(Domain)基本介绍"></a>一、域(Domain)基本介绍</h3><ul><li><p>“域”是一个相对严格的组织。”域”指的是服务器控制网络上的计算机能否加入的计算机组合。实行严格的管 理对网络安全是非常必要的。在对等网模式下，任何一台电脑只要接入网络,就可以访问共享资源,如共享ISDN上网等。 尽管对等网络上的共享文件可以加访问密码， 但是非常容易被破解。在由Windows 9x 构成的对等网中，数据是非常不安全的。</p></li><li><p>在”域”模式下，至少有一台服务器负责每一台联入域网络的电脑和用户的验证工作，相当于一个单位的门卫一样，称为”域控制器(Domain Controller,简写为DC)”。”域控制器”中包含了由这个域的账户、密码、属于这个域的计算机等信息构成的数据库。当电脑联入网络时，域控制器首先要鉴别这台电脑是否是属于这个域的，用户使用的登录账号是否存在、密码是否正确。如果以上信息不正确，域控制器就拒绝这个用户从这台电脑登录。不能登录，用户就不能访问服务器上有权限保护的资源，只能以对等网用户的方式访问Windows共享出来的资源，这样就一定程度上保护了网络上的资源。</p></li></ul><h3 id="二、AD域服务-AD-DS"><a href="#二、AD域服务-AD-DS" class="headerlink" title="二、AD域服务(AD DS)"></a>二、AD域服务(AD DS)</h3><p>在计算机、用户数量较多的企业网络中，域能够实现统一、高效的管理此网络环境。域环境是一种逻辑结构，从逻辑上将网络中的计算机组织到一起，进行统一管理。在一个域中，所有的用户、计算机等角色，都是统一的，而域控制器则负责存储整个域环境的数据信息。如:</p><ul><li><strong>权限集中</strong>:所有用户账户直接通过dc进行管理，而工作组模式则需要对每一台计算机进行配置，难以管理。</li><li><strong>共享集中</strong>:共享数据后，通过权限配置，使得需要的用户能够直接访问该数据。</li><li><strong>策略部署</strong>:对域中的计算机、用户实施统一策略部署，达到所有计算机、用户的配置相同，<br>也可对某些特定用户进行区分。</li></ul><p>工作组环境每台计算机都拥有自己的管理权限，因此使用者经常有意或无意下载了若干软件、病毒，会使得计算机运行变慢、中毒，而域权限可以很好控制这一点。</p><h4 id="1-活动目录（Active-Directory-简称AD）"><a href="#1-活动目录（Active-Directory-简称AD）" class="headerlink" title="1. 活动目录（Active Directory, 简称AD）"></a>1. <strong>活动目录（Active Directory, 简称AD）</strong></h4><ul><li>两层含义：<ul><li>AD是Windows的一种服务</li><li>AD是一个目录数据库</li></ul></li><li>优点和特性：<ul><li>集中管理</li><li>访问网络资源便捷</li><li>可扩展性强</li></ul></li></ul><h4 id="2-域"><a href="#2-域" class="headerlink" title="2. 域"></a>2. <strong>域</strong></h4><p>   活动目录的一种实现形式<br>   活动目录中最核心的管理单位<br>   由域控制器和成员计算机组成</p><ul><li><p><strong>域控制器:</strong><br>域中的管理服务器，通常为第一台安装了活动目录的服务器。<br>一个域可以有多台域控制器</p></li><li><p><strong>名称空间:</strong><br>是一个区域的名字(域名)<br>定位了网络资源的位置</p></li><li><p><strong>对象和属性:</strong><br>对象由一组属性组成，它代表的是具体的事物<br>属性就是用来描述对象的数据</p></li><li><p><strong>容器:</strong><br>是一种特殊的活动目录对象</p><p>作用是存放对象的空间</p></li><li><p><strong>组策略:</strong></p><p>若干策略的集合</p><p>应用到容易会影响容器内所有的计算机和用户</p></li></ul><h4 id="3-域结构"><a href="#3-域结构" class="headerlink" title="3. 域结构"></a>3. <strong>域结构</strong></h4><h5 id="3-1-逻辑结构"><a href="#3-1-逻辑结构" class="headerlink" title="3.1 逻辑结构"></a><strong>3.1 逻辑结构</strong></h5><ul><li><p>**单域: **网络中只建了一个域</p><img src="/myfile/AD/单域.jpg" style="zoom:80%;" /></li><li><p>**域树: **从Windows Server 2000起，域树(Domain Tree) 开始出现，如图所示。域树中域以树的形式出现，由根域(域树中创建的第一个域)、父域(上级域)和子域(下级域)构成，共用连续名字空间的域就组成一个域目录树。</p></li><li><p>**域林: **域林是一个或多个目录树的集合，目录林中的目录树并不共用相同的连续的名字空间。域林中创建的第一个域为林根域。</p><img src="/myfile/AD/image-20230308155726231.png" alt="image-20230308155726231" style="zoom:80%;" /></li><li><p>**组织单元(OU): **是域内的一种容器，也是一种对象。可以把域中的对象组织成逻辑组，以简化管理工作。组织单元可以包含各种对象，如用户账户、用户组、计算机、打印机等，甚至可以包括其他的组织单元，所以可以利用组织单元把域中的对象组成一个完全逻辑上的层次结构。对企业来讲，可以按部门把所有的用户和设备组成一个组织单元层次结构，也可以按地理位置形成层次结构,还可以按功能和权限分成多个组织层次结构。</p></li><li><p>**全局编录服务器(GC): **存储着本域中所有对象所有属性，同时存储林中其他域中所有对象的部分属性。一般来说，属性是否存储在GC中，取决于该属性在搜索中使用的频率,由系统自动进行决定。主要具有以下两个功能:</p><ul><li>允许用户在林中所有域.上搜索活动目录信息，提高查询速度。</li><li>为域控制器提供请求验证登陆的用户信息。</li></ul></li></ul><h5 id="3-2-物理结构"><a href="#3-2-物理结构" class="headerlink" title="3.2 物理结构"></a><strong>3.2 物理结构</strong></h5><ul><li><strong>站点:</strong> 对应高速稳定的IP子网，如企业内部的局域网</li><li>**域控制器(DC): **域控制器是安装了ADDS服务器角色的服务器。<ul><li>承载AD DS目录存储的副本;</li><li>提供身份验证和授权服务;</li><li>将更新复制到域和林中的其他域控制器;</li><li>允许在服务器上管理用户账户和网络资源;</li><li>Windows Server 2016 AD DS支持RODC(只读域控制器);</li><li>参与活动目录的复制;</li><li>单主控操作。</li></ul></li></ul><h4 id="4-信任关系"><a href="#4-信任关系" class="headerlink" title="4. 信任关系"></a>4. <strong>信任关系</strong></h4><p>由于域控制器的作用，域内的用户是不能够跨段进行访问的，如果一定要进行跨段访问，则需要在两个域之间建立信任关系</p><ul><li><p><strong>域信任关系的作用：</strong>允许一个域内的用户能够访问另一个域的资源</p></li><li><p><strong>域信任关系：</strong>信任关系域和被信任关系域</p><p>域与域之间具有一定的信任关系，域信任关系使得一个域中的用户可由另一个域中的域控制器进行验证，才能使一个域中的用户访问另一个域中的资源</p></li><li><p><strong>信任关系：</strong>域A信任域B，则域B中的用户可以通过域A中的域控制器进行身份验证后访问域A中的资源，则域A与域B之间的关系就是信任关系</p></li><li><p><strong>被信任关系：</strong>就是被一个域信任的关系，在上面的例子中域B就是被域A信任，域B与域A的关系就是被信任关系</p></li><li><p><strong>信任关系的两种形式：</strong></p><ul><li><p><strong>单向不可传递的信任关系：</strong></p></li><li><p><strong>双向可传递的信任关系：</strong></p><p>双向可传递信任用于描述一个树中父域和子域之间的关系，也用于描述一个森林中顶层域之间的关系.</p><p>在双向可传递的信任中，如果域A信任域B，并且与域B信任域C，那么域A就信任域C，域C也就信任域A</p></li></ul></li><li><p><strong>林中信任关系</strong>可以分为两种：一种是<strong>父子信任</strong>，还有一种是<strong>树根信任</strong>。</p><p><strong>父子信任：</strong>在同一个树域之中，域根和子域之间。<br><strong>树根信任：</strong>在同一个林之中，域树根域与域树根域之间。</p></li><li><p><strong>林之间的信任关系：</strong>分为两种，一种是外部信任，另一种是林信任。</p><ul><li><p><strong>外部信任：</strong>不同林的域之间创建的不可传递的信任。<br><strong>创建外部信任的条件：</strong>两个域之间能够互相解析对方<br><strong>外部信任的特点：</strong></p><ul><li>手工建立</li><li>信任关系不可传递</li><li>信任方向有单向和双向</li></ul></li><li><p><strong>林信任：</strong></p><p><strong>林信任的意义：</strong></p><ul><li>如果两个林中有许多域，要跨域访问资源就需要创建很多个外部信任</li><li>在林根域之间建立林信任就不需要创建多个外部信任，因为林信任是可传递的</li></ul><p><strong>林信任的特点：</strong></p><ul><li>只有在林根域之间才能创建</li><li>建立林信任后，两个林中每个域之间的信任关系是可传递的</li><li>信任方向有单向和双向两种</li></ul></li></ul></li></ul><h4 id="5-AD域功能"><a href="#5-AD域功能" class="headerlink" title="5. AD域功能"></a>5. <strong>AD域功能</strong></h4><ul><li>计算机管理</li></ul><p>​管理服务器及客户端计算机账户，所有的服务器及客户端计算机加入域管理并实施组策略</p><ul><li>应用系统支撑</li></ul><p>​支持财务、人事、电子邮件、企业信息门户、办公自动化、补丁管理、防病毒系统等各种应用系统</p><ul><li>资源管理</li></ul><p>​管理打印机、文件共享服务等网络资源</p><ul><li>桌面配置</li></ul><p>​系统管理员可以集中的配置各种桌面配置策略</p><ul><li>管理服务</li></ul><p>​管理用户域账号、用户信息、企业通讯录（与电子邮件系统集成）、用户组管理、用户身份认证、用户授权管理等，按省实施组管理组策略</p><h4 id="6-AD域-amp-DNS服务"><a href="#6-AD域-amp-DNS服务" class="headerlink" title="6. AD域&amp;DNS服务"></a>6. <strong>AD域&amp;DNS服务</strong></h4><ul><li><p><strong>两者的关系：</strong></p><ul><li>DNS服务器对域来说不可或缺</li><li>域中的计算机使用DNS域名，DNS需要为域中的计算机提供域名解析服务</li><li>域中的计算机需要利用DNS提供的SRV记录来定位域控制器(所谓SRV记录，就是记录在哪台主机上具有哪些服务的一种记录)</li></ul></li><li><p><strong>DNS对AD域的作用：</strong></p><ul><li>名称解析</li><li>DNS将计算机名称转换为IP地址</li><li>计算机使用DNS在网络上相互定位</li><li>定位活动目录的物理组件</li><li>DNS使用域控制器提供的服务</li><li>域中的计算机使用DNS来定位域控制器和全局编录</li></ul></li><li><p><strong>AD域中对DNS的要求：</strong></p><ul><li>支持SRV记录</li><li>支持动态更新协议</li></ul></li></ul><h3 id="三、部署AD域服务"><a href="#三、部署AD域服务" class="headerlink" title="三、部署AD域服务"></a>三、部署AD域服务</h3><h4 id="一-部署要求："><a href="#一-部署要求：" class="headerlink" title="(一) 部署要求："></a>(一) 部署要求：</h4><ul><li>本地管理员权限</li><li>操作系统版本必须满足条件：系统必须为WindowsServer, 推荐ws2016以上版本</li><li>NTFS分区</li><li>静态IP地址</li><li>有足够的可用磁盘空间：系统盘有足够空间, 推荐 40G+</li><li>该服务器需要DNS角色：由AD域部署时自动安装</li></ul><h4 id="二-创建域和第一个DC"><a href="#二-创建域和第一个DC" class="headerlink" title="(二) 创建域和第一个DC"></a>(二) 创建域和第一个DC</h4><ol><li><p>使用“服务器管理器”安装Active Directory 域服务。</p></li><li><p>通过“添加角色和功能”安装活动目录。</p></li><li><p>将当前服务器提升为域控制器。</p></li><li><p>验证Active Directory域服务的安装。</p><p>(1)查看计算机名</p><p>(2)看管理工具中有没有“Active Directory 用户和计算机”、“Active Directory站点和服务”、“Active Directory 域和信任关系”等管理工具。</p><p>(3)查看活动目录对象</p><p>(4)查看Active Directory 数据库文件，%SystemRoot%\Ntds 目录中应有以下文件有:</p><ul><li><p>Ntds.dit:数据库文件;</p></li><li><p>Edb. chk:检查点文件;</p></li><li><p>Temp. edb:临时文件。</p><p>(5)检查DNS记录</p></li></ul><img src="/myfile/AD/1.jpg" style="zoom:80%;" /><img src="/myfile/AD/2.jpg" style="zoom:80%;" /><img src="/myfile/AD/3.0.jpg" style="zoom:80%;" /><img src="/myfile/AD/3.1.jpg" style="zoom:80%;" /><img src="/myfile/AD/4.jpg" style="zoom:80%;" /><img src="/myfile/AD/5.jpg" style="zoom:80%;"/></li></ol><p><video src="/myfile/AD/创建域.mp4" width="700" controls></video></p><ol start="5"><li><p>PowerShell脚本安装:  </p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">Add-WindowsFeature</span> <span class="token operator">-</span>Name AD-Domain-Services <span class="token operator">-</span>IncludeManagementTools<span class="token variable">$PW</span> = <span class="token function">ConvertTo-SecureString</span> <span class="token string">"admin123"</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force<span class="token function">Install-ADDSForest</span> <span class="token operator">-</span>DomainName <span class="token string">"cc.cn"</span> <span class="token operator">-</span>SafeModelAdministratorPassword <span class="token variable">$PW</span> <span class="token operator">-</span>Force: <span class="token boolean">$true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>安装过程错误处理: </p><p><font color =red>错误: 提示账户密码不符合要求</font></p><img src="/myfile/AD/账户密码不符合要求.png" style="zoom:80%;" /><p>解决办法:<br>    在cmd中执行:    <code>net user administrator</code><br>​返回信息中 Password required  如果显示No 表明账户未启用密码</p><p>​cmd执行:  <code>net user administrator /passwordreq:yes</code>     &#x2F;&#x2F;启用 密码</p><p>​如果需要重设密码,cmd执行:   <code>net user administrator Aa123456</code></p><p>​通过以上配置即可解决该问题。</p></li></ol><h4 id="三-辅助域控制器的安装"><a href="#三-辅助域控制器的安装" class="headerlink" title="(三) 辅助域控制器的安装"></a>(三) 辅助域控制器的安装</h4><p>​域控制器可以有多台, 可以组成集群, 缓解单机的压力或者避免单台宕机不可用</p><ul><li><p><strong>安装时的注意事项</strong></p><p>操作系统版本必须受当前域功能级别支持<br>拥有要加入的域管理员权限(账户密码)<br>辅助域控制器TCP&#x2F;IP参数配置正确<br>确保辅助域控制器和第一台域控制器之间互相连通<br>确保辅助域控制器能够通过DNS解析要加入域的域名</p></li><li><p><strong>创建及加入已有域操作步骤如下:</strong></p></li></ul><p><video src="/myfile/AD/辅助域控制器安装.mp4" width="700" controls></video></p><ul><li><p>PowerShell脚本安装: </p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">Add-WindowsFeature</span> <span class="token operator">-</span>Name AD-Domain-Services <span class="token operator">-</span>IncludeManagementTools<span class="token comment"># 一下操作需第一台域控制器安装完成后再执行</span><span class="token variable">$DomainName</span> = <span class="token string">"cc.cn"</span><span class="token variable">$UserName</span> =<span class="token string">"a@cc.cn"</span> <span class="token comment">#域管理员账户</span><span class="token variable">$PassWord</span> = <span class="token function">ConvertTo-SecureString</span> <span class="token string">"a"</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force  <span class="token comment">#域控制器管理员账户密码</span><span class="token variable">$PW</span> = <span class="token function">ConvertTo-SecureString</span> <span class="token string">"qweqwe"</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force  <span class="token variable">$Credential</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>Automation<span class="token punctuation">.</span>PSCredential <span class="token punctuation">(</span><span class="token variable">$UserName</span><span class="token punctuation">,</span> <span class="token variable">$PassWord</span><span class="token punctuation">)</span><span class="token function">Install-ADDSDomainController</span> <span class="token operator">-</span>DomainName <span class="token variable">$DomainName</span> <span class="token operator">-</span>Credential <span class="token variable">$Credential</span> <span class="token operator">-</span>SafeModeAdministratorPassword <span class="token variable">$PW</span> <span class="token operator">-</span>Force:<span class="token boolean">$true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="四-子域和树域的创建"><a href="#四-子域和树域的创建" class="headerlink" title="(四)子域和树域的创建"></a>(四)子域和树域的创建</h4><ol><li><p><strong>子域创建</strong></p><img src="/myfile/AD/3520dc1302134beb9e18694509222ada.png" alt="img" style="zoom:80%;" /></li><li><p><strong>树域创建</strong></p><img src="/myfile/AD/cb21d968b8ea4d9181d99ede630764d1.png" alt="img" style="zoom:80%;" /></li></ol><h4 id="五-域控制器的降级"><a href="#五-域控制器的降级" class="headerlink" title="(五)域控制器的降级"></a>(五)域控制器的降级</h4><img src="/myfile/AD/域服务器角色转换.jpg" style="zoom:80%;" /><ul><li><strong>删除活动目录</strong></li></ul><p>　　1.如果该域内还有其他域控制器，则该域会被降级为该域的成员服务器</p><p>　　2.如果最后一个域控制器，则被降级后，该计算机被降级为独立服务器</p><p>​3.如果这台域控制器是“全局编录”，要先确定网络上是否还有其他“全局编录”域控制器。如果没有，则要先指派一台域控制器来担当“全局编录”的角色，否则将影响用户的登录操作。</p><p>​查看是否为全局编录(GC)</p><img src="/myfile/AD/image-20230308093659061.png" alt="image-20230308093659061" style="zoom:80%;" /><ul><li>将DC2由额外域控制器降级</li><li>删除dc2上的AD DS域服务 角色和功能</li><li>将dc2由成员服务器降级为独立服务器</li></ul><img src="/myfile/AD/image-20230308093807847.png" alt="image-20230308093807847"  /><img src="/myfile/AD/image-20230308093917092.png" alt="image-20230308093917092" style="zoom:80%;" /><ul><li>重启dc2就由额外域控制器降级为成员控制器</li><li>还需要删除AD DS域服务</li></ul><img src="/myfile/AD/1328126-20221108170233943-139176554.png" alt="img" style="zoom:80%;" /><ul><li>现在dc2已经是成员服务器，要想降级为独立服务器需要脱离域</li></ul><img src="/myfile/AD/1328126-20221108171455241-158509549.png" alt="img" style="zoom:80%;" /><ul><li>域控制器降级视频操作:</li></ul><p><video src="/myfile/AD/域控制器降级.mp4" width="700" controls></video></p><h3 id="四、域环境管理"><a href="#四、域环境管理" class="headerlink" title="四、域环境管理"></a>四、域环境管理</h3><h4 id="一-域用户账户管理"><a href="#一-域用户账户管理" class="headerlink" title="(一) 域用户账户管理"></a>(一) 域用户账户管理</h4><ul><li><p><strong>域用户账户的作用</strong><br>验证用户的身份<br>授权或拒绝对域资源的访问</p></li><li><p><strong>创建域用户账户</strong><br>域用户账户的命名<br>域用户账户的密码</p></li><li><p><strong>域用户账户设置</strong></p><ul><li>基本信息设置、账户密码设置过期设置</li></ul><img src="/myfile/AD/image-20230308112032483.png" alt="image-20230308112032483" style="zoom:80%;" /><ul><li>登录时间、登录到设置</li></ul><img src="/myfile/AD/image-20230308112450325.png" alt="image-20230308112450325" style="zoom:80%;" /></li></ul><h4 id="二-域的组管理"><a href="#二-域的组管理" class="headerlink" title="(二) 域的组管理"></a>(二) 域的组管理</h4><ol><li><p><strong>组的类型</strong></p><ul><li><p><strong>安全组</strong><br>为用户设置访问权限</p></li><li><p><strong>通讯组</strong><br>用于电子邮件通信<br>包含联系人和用户帐户</p></li></ul></li><li><p><strong>组的作用域</strong></p><ul><li><p><strong>本地域组</strong><br>针对本域的资源创建本地域组<br>适用范围:本城</p></li><li><p><strong>全局组</strong><br>管理日常维护的目录对象<br>适用范围:整林及信任城</p></li><li><p><strong>通用组</strong><br>身份信息记录在全局编录中<br>查询速度快<br>适用范围:整林及信任域</p><p><strong>全局组和通用组的区别</strong><br>在多域环境中，通用组成员的身份信息记录在全局编录中，而全局组成员身份存储在每个域中。在多域环境中，相比较而言，通用组成员登录或者查询速度较快。</p></li></ul></li></ol><h4 id="三-域的组织单位-OU"><a href="#三-域的组织单位-OU" class="headerlink" title="(三)域的组织单位(OU)"></a>(三)域的组织单位(OU)</h4><ol><li><strong>OU的概念</strong><ul><li>OU是AD中的容器</li><li>可在其中存放用户、组、计算机和其他OU</li><li>OU不能包含来自其他域中的对象</li></ul></li><li><strong>OU的常见结构</strong><ul><li>基于部门</li><li>基于项目</li><li>基于业务功能</li><li>基于管理</li><li>基于对象类型</li><li>基于地理位置</li></ul></li></ol><img src="/myfile/AD/image-20230308155439185.png" alt="image-20230308155439185" style="zoom:80%;" /><ol><li><strong>创建及删除OU</strong><br>防止对象被意外删除</li></ol><img src="/myfile/AD/image-20230308113607325.png" alt="image-20230308113607325" style="zoom:80%;" /><p>确实要删除时, Active Directory 用户和计算机窗口, 顶部菜单  [查看] 下, 勾选高级功能, 再右击要删除的OU, 选择属性, 切换到[对象]tab页,取消勾选[繁殖对象被以外删除], 点击确定保存, 之后就可以进行删除操作。</p><img src="/myfile/AD/image-20230308114243296.png" alt="image-20230308114243296" style="zoom: 80%;" /><ol start="4"><li><p><strong>委派控制</strong></p><p>在非DC计算机上如果需要进行权限等相关管理操作, 需要在当前计算机上安装 AD DS 管理工具, 安装时需要域管理员权限进行授权</p><p>适用win10的远程服务器管理工具下载链接: <a href="https://www.microsoft.com/zh-CN/download/details.aspx?id=45520">Download 适用于 Windows 10 的远程服务器管理工具 from Official Microsoft Download Center</a></p></li></ol><img src="/myfile/AD/image-20230308134238387.png" alt="image-20230308134238387" style="zoom:80%;" /><img src="/myfile/AD/image-20230308134331995.png" alt="image-20230308134331995" style="zoom:80%;" /><img src="/myfile/AD/image-20230308134558408.png" alt="image-20230308134558408" style="zoom:80%;" /><h3 id="五、组策略应用"><a href="#五、组策略应用" class="headerlink" title="五、组策略应用"></a>五、组策略应用</h3><h4 id="一-组策略"><a href="#一-组策略" class="headerlink" title="(一)组策略"></a>(一)组策略</h4><ol><li><p><strong>概述</strong>：一组策略的集合， 用来统一修改系统、设置程序等操作</p><p><img src="/myfile/AD/image-20230308161210043.png" alt="image-20230308161210043"></p></li><li><p><strong>优点</strong>：</p><ul><li>减少管理成本</li><li>减小用户单独配置错误的可能</li><li>可以针对特定对象设置特定策略</li></ul></li><li><p><strong>组策略对象</strong>：</p><ul><li><p><strong>GPO(Group Policy Object)</strong> :用来存储组策略的所有配置信息，是AD中的一种特殊对象。</p></li><li><p><strong>默认GPO</strong></p><ul><li><p><strong>默认域策略</strong></p><p>(1) <font color=red>本地安全策略与默认域策略有冲突，以默认域策略优先，本地设置无效。</font><br>(2) 本地计算机何时才会应用在域策略内有变动的设置呢?<br>    本地安全策略有变动时;<br>    本地计算机重启时;<br>    DC每5分钟自动应用;<br>    不是DC每隔90- 120分钟会自动应用;<br>    所有计算机每隔16小时强制应用，即使无更改。<br>    <font color=red>手动应用域策略: gpupdate  或  gpupdate &#x2F;force</font></p></li><li><p><strong>默认域控制器策略</strong></p><ul><li>只影响到位于Domain Controllers内的域控制器，不影响其他组织单元或容器内的计<br>算机和用户</li><li>所有位于DomainControllers内的DC都会受域控制器安全策略的影响。</li><li><font color=red>默认域策略与域控制器安全策略冲突时，对于DC来说默认域控制器策略优先，域安全<br>策略无效。</font></li></ul></li></ul></li><li><p><strong>GPO链接</strong></p><p>只能链接到站点、域、OU</p><p>站点: ad中站点是从物理上抽象的概念, 由一个或几个通过高速链路链接在一起的IP子网组成</p><p>站点和域的关系: 一个站点中可以有多个域, 一个域可以属于多个站点</p></li><li><p><strong>域内的策略</strong></p><p>在域内可以针对站点、域或组织单元来设置组策略，其中的域组策略内的设置会被应用<br>到域内所有计算机与用户，而组织单元的组策略会被应用到该组织单元内的所有计算机<br>与用户。</p><p>对于加入到域的计算机来说, 如果两者有冲突, 以域或组织单元组策略的设置优先, 本地策略无效。</p></li><li><p><strong>组策略打开命令</strong></p><p>运 行 –&gt; gpedit.msc</p></li></ul></li><li><p><strong>创建组策略</strong>：</p><ul><li><p>组策略内的设置分为: </p><p>—-计算机配置(对计算机生效)</p><p><img src="/myfile/AD/image-20230308161115929.png" alt="image-20230308161115929"></p><p>—-用户配置(对用户生效)</p><p><img src="/myfile/AD/image-20230308161124325.png" alt="image-20230308161124325"></p></li><li><p>只有域内的组策略才有首选项功能，本地计算机策略无此功能。</p></li><li><p>首选项非强制性，客户端可更改设置，策略设置是强制性，客户端无法更改。但策略设置若要在客户端发生作用，客户计算机的操作系统或应用程序必须支持组策略，首选项不需要。</p></li><li><p>若要筛选策略设置，必须针对整个GP0来筛选，而首选项可以针对单一设置项目来设置。</p></li></ul></li><li><p><strong>软件分发</strong></p><ul><li><p><strong>软件分发步骤</strong></p><ul><li>准备.msi格式程序</li><li>将.msi格式文件放置到域共享文件夹中</li><li>创建并链接GPO</li></ul></li><li><p><strong>分配与发布的区别</strong></p><ul><li>分配-&gt;将程序分配到用户或计算机</li><li>发布-&gt;将程序发布给用户,用户可以选择是否安装</li></ul></li><li><p><strong>设置软件分发的步骤</strong></p><p>以用户为例, 需要提前共享要安装的以msi为后缀的软件包, 并设置允许用户能够访问到该共享目录。</p><p>(1) <font color=red>指定域中所有计算机的网关，网关必须是当前可使用的计算机IP地址，最终在网卡显示<br>界面中，会显示当前域名，而非”未识别网络”</font><br>(2) 双击打开”网络”，确认能够看到域中所有的计算机(网络-&gt;属性-&gt;更改高级共享设置-&gt;网络发现中设置为启用网络发现)<br>注意:发布软件时需要在网络中看到本机<br>在”服务”中将以下两个服务设置为自动启动，并重启这两个服务可解决该问题:<br>    Function Di scovery Provider Host<br>    Function Di scovery Resource Publ ication<br>(3) 找到”组策略管理”—&gt;” caiwubu”OU进行鼠标右键创建GPO， 并鼠标右键编辑该GPO<br>(4) 找到用户配置—&gt;策略—&gt;软件设置—&gt;软件安装，鼠标右键点击属性，在属性中点击浏览找到该服:务器计算机名，打开选中要分发的软件所在共享目录<br>(5) 在该界面中继续选择安装方式:发布&#x2F;分配，最后应用<br>(6) 继续右键点击软件安装—&gt;新建—&gt;数据包，这时将会从网络位置该计算机中打开带有要分发软件的共享文件夹，只需要选择要分发的软件，点击确认即可<br>(7) 等待几秒钟后在操作台中间空白处将会出现任务记录，选中该任务记录鼠标右键属性,打开”部署”选项卡—&gt;部署选项—&gt;勾中”在登录时安装此应用程序<br>(8) 应用当前修改，并通过gpupdate &#x2F;force 刷新组策略，重启客户机验证是否安装。</p><p>可以使用VERITAS Discover 和Advanced Installer 等第三方软件将.exe格式文件转换<br>为.msi格式文件。</p><img src="/myfile/AD/image-20230308145400439.png" alt="image-20230308145400439" style="zoom:80%;" /></li></ul><img src="/myfile/AD/image-20230308150305078.png" style="zoom:80%;" /><img src="/myfile/AD/image-20230308150318166.png" style="zoom:80%;" /></li></ol><h4 id="二-组策略应用规则"><a href="#二-组策略应用规则" class="headerlink" title="(二)组策略应用规则"></a>(二)组策略应用规则</h4><p>组策略应用顺序LSDOU:本地组策略(L)-&gt;站点(S)-&gt;域(D)-&gt;OU<br>如果在一个对象.上存在多个GPO策略，那么按照GPO策略优先级编号从高往低执行，最后执<br>行的策略生效。<br>所有的策略应用都需要遵循以下几种规则:</p><ol><li><strong>继承与阻止</strong></li></ol><img src="/myfile/AD/image-20230308151030737.png" alt="image-20230308151030737" style="zoom:80%;" /><p><img src="/myfile/AD/image-20230308151314731.png" alt="image-20230308151314731"></p><ol start="2"><li><p><strong>累加与冲突</strong></p><p>如果按照LSDOU应用规则, 各个配置没有冲突, 则会累加, 最终全部生效。</p><p>如果产生冲突， 以最后一级的配置为准生效</p><p>示例：</p><p><img src="/myfile/AD/image-20230308151754823.png" alt="image-20230308151754823"></p></li><li><p><strong>强制生效</strong></p><p>上级容器强制下级容器执行其GPO设置, “强制生效” 会覆盖 “阻止继承” 的设置</p><img src="/myfile/AD/image-20230308152152044.png" alt="image-20230308152152044" style="zoom:80%;" /></li><li><p><strong>筛选</strong></p><p>可阻止一个GP0应用于容器内的特定计算机或用户(适用于批量管理里的个例)<br>让特定的对象应用组策略<br>筛选的配置方法:<br>(1)选中0U下的GPO<br>(2)点击GPO中的”委派’<br>(3)点击右下角”高级‘<br>(4)点击”添加”<br>(5)添加要排除的用户并在权限栏中，选择”应用组策略”—&gt;”拒绝”</p></li></ol><h3 id="六、FSMO五大操作主机角色"><a href="#六、FSMO五大操作主机角色" class="headerlink" title="六、FSMO五大操作主机角色"></a>六、FSMO五大操作主机角色</h3><h4 id="一-主要概览"><a href="#一-主要概览" class="headerlink" title="(一)主要概览"></a>(一)主要概览</h4><p><strong>FSMO</strong> 是 Flexible Single Master Operation 的缩写，意思就是<strong>灵活单主机操作</strong>。是被设置为担任提供特定角色信息的网域控制站，在活动目录中有五种 FSMO 角色，并且分为两大类：</p><p><strong>Forest 林级别</strong></p><p><em>在整个林中只能有一台 DC 拥有该主机角色</em></p><ul><li>架构主机 (Schema Master)</li><li>域命令主机 (Domain Naming Master)</li></ul><p><strong>Domain 域级别</strong></p><p><em>在域中只有一台 DC 拥有该角色</em></p><ul><li>PDC 模拟器 (PDC Emulator)</li><li>RID 主机 (RID Master)</li><li>基础架构主机 (Infrastructure Master)</li></ul><h4 id="二-角色功能"><a href="#二-角色功能" class="headerlink" title="(二)角色功能"></a>(二)角色功能</h4><ol><li><strong>架构主机</strong>(<em>Schema Master</em>)</li></ol><p>​控制活动目录整个林中所有对象和属性的定义，具有架构主机角色的 DC 是可以更新目录架构的唯一 DC。这些架构更新会从架构主机复制到目录林中的所有其它域控制器中。 架构主机是基于目录林的，整个目录林中只有一个架构主机。</p><ol start="2"><li><strong>域命令主机</strong>(<em>Domain Naming Master</em>)</li></ol><ul><li>向目录林中添加新域。</li><li>从目录林中删除现有的域。</li><li>添加或删除描述外部目录的交叉引用对象。</li></ul><ol start="3"><li><strong>PDC 模拟器</strong></li></ol><p>​PDC（主域控制器<em>，</em>primary domain controller）Emulator，修改密码时先变更到 PDC 再同步生效</p><ul><li><p>向后兼容低级客户端和服务器，担任 NT 系统中 PDC 角色；</p></li><li><p>时间同步服务源，作为本域权威时间服务器，为本域中其它 DC 以及客户机提供时间同步服务，林中根域的 PDC 模拟器又为其它域 PDC 模拟器提供时间同步!</p></li><li><p>密码最终验证服务器，当一用户在本地 DC 登录，而本地 DC 验证本地用户输入密码无效时，本地 DC 会查询 PDC 模拟器，询问密码是否正确。</p></li><li><p>首选的组策略存放位置，组策略对象 (GPO) 由两部分构成：GPT 和 GPC，其中 GPC 存放在 AD 数据库中，GPT 默认存放 PDC 模拟器在<code>windows\sysvol\sysvol\&lt;domainname&gt;</code>目录下，然后通过 DFS 复制到本域其它 DC 中。</p></li><li><p>域主机浏览器，提供通过网上邻居查看域环境中所有主机的功能。</p></li></ul><ol start="4"><li><strong>RID 主机</strong></li></ol><p>​RID（相对用户身份，Relative ID）Master，提供分配 Object 唯一标识符</p><p>​Windows 环境中，所有的安全主体都有 SID，SID 由域 SID+序列号组合而成，后者称为 “相对 ID”(Relative ID,RID)，在 Windows 环境中，由于任何 DC 都可以创建安全主体，为保证整个域中每个 DC 所创建的安全主体对应的 SID 在整个域范围唯一性，设立该主机角色，负责向其它 DC 分配 RID 池 (默认一次性分配 512 个)，所有非 RID 在创建安全实体时，都从分配给的 RID 池中分配 RID，以保证 SID 不会发生冲突！</p><ol start="5"><li><strong>基础架构主机</strong></li></ol><p>​<em>Infrastructure Master</em>，<em>用于维护 AD 工作</em></p><p>​基础结构主机的作用是负责对跨域对象引用进行更新，以确保所有域间操作对象的一致性。基础架构主机工作机制是定期会对没有保存在本机的引用对象信息，而对于 GC 来说，会保存当前林中所有对象信息。如果基础架构主机与 GC 在同一台机，基础架构主机就不会更新到任何对象。所以在多域情况下，强烈建议不要将基础架构主机设为 GC。</p><p>​将承载这些操作主机角色的域控制器放置在具有高网络可靠性的区域，并确保 PDC 模拟器和 RID 主机始终可用。</p><h4 id="三-查询角色分配情况"><a href="#三-查询角色分配情况" class="headerlink" title="(三)查询角色分配情况"></a>(三)查询角色分配情况</h4><p>命令：<code>Netdom Query FSMO</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Netdom Query FSMO架构主机          dc2022.hxx.cn域命名主机         dc2022.hxx.cnPDC              dc2022.hxx.cnRID 池管理器       dc2022.hxx.cn结构主机       dc2022.hxx.cn命令成功完成。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> AD域服务 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> 运维 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elasticsearch数据备份和迁移的几种方式</title>
      <link href="/2023/03/06/Elasticsearch%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E8%BF%81%E7%A7%BB/"/>
      <url>/2023/03/06/Elasticsearch%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E8%BF%81%E7%A7%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="一、elasticsearch-dump-第三方工具"><a href="#一、elasticsearch-dump-第三方工具" class="headerlink" title="一、elasticsearch-dump(第三方工具)"></a>一、elasticsearch-dump(第三方工具)</h2><ol><li><p><strong>项目GitHub地址</strong>：<a href="https://github.com/elasticsearch-dump/elasticsearch-dump">https://github.com/elasticsearch-dump/elasticsearch-dump</a></p></li><li><p><strong>依赖</strong>: Node.js(安装及配置环境变量, 步骤略)</p></li><li><p><strong>安装elasticsearch-dump工具</strong> <code>npm install elasticdump -g</code></p></li><li><p><strong>迁移命令示例</strong>: </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">迁移setting、mapping、data 示例↓elasticdump --input<span class="token operator">=</span>http://SourceIp:SourcePort/<span class="token punctuation">[</span>YourIndex<span class="token punctuation">]</span> --output<span class="token operator">=</span>http://DestinationIp:DestinationPort/<span class="token punctuation">[</span>YourIndex<span class="token punctuation">]</span> --type<span class="token operator">=</span>settings --limit<span class="token operator">=</span><span class="token number">1000</span>elasticdump --input<span class="token operator">=</span>http://SourceIp:SourcePort/<span class="token punctuation">[</span>YourIndex<span class="token punctuation">]</span> --output<span class="token operator">=</span>http://DestinationIp:DestinationPort/<span class="token punctuation">[</span>YourIndex<span class="token punctuation">]</span> --type<span class="token operator">=</span>mapping --limit<span class="token operator">=</span><span class="token number">1000</span>elasticdump --input<span class="token operator">=</span>http://SourceIp:SourcePort/<span class="token punctuation">[</span>YourIndex<span class="token punctuation">]</span> --output<span class="token operator">=</span>http://DestinationIp:DestinationPort/<span class="token punctuation">[</span>YourIndex<span class="token punctuation">]</span> --type<span class="token operator">=</span>data --limit<span class="token operator">=</span><span class="token number">1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>命令参数解释:</p><ul><li><strong>–input</strong>: 源地址，可为ES集群URL、文件或stdout,可指定索引，url格式为：{protocol}:&#x2F;&#x2F;{host}:{port}&#x2F;{index}，文件格式为: &#x2F;home&#x2F;outindex.json</li><li><strong>–output</strong>: 目标地址，可为ES集群地址URL、文件或stdout，可指定索引，url格式为：{protocol}:&#x2F;&#x2F;{host}:{port}&#x2F;{index}，文件格式为: &#x2F;home&#x2F;outindex.json</li><li><strong>–type</strong>: 迁移类型，默认为data,表明只迁移数据，可选settings, analyzer, data, mapping, alias</li><li><strong>–limit</strong>: 每批次操作数量, 默认为100, 可以根据需要调整</li><li>更多参数可通过 <code>elasticdump --help</code> 查看详细说明\</li></ul></li><li><p><strong>试用场景</strong>：elasticsearchdump工具和mysql数据库用于做数据备份的工具mysqldump工具类似，都是逻辑备份，需要将数据一条一条导出后再执行导入，所以适合数据量小的场景下进行迁移。</p></li></ol><h2 id="二、snapshot-自带快照接口"><a href="#二、snapshot-自带快照接口" class="headerlink" title="二、snapshot(自带快照接口)"></a>二、snapshot(自带快照接口)</h2><ol><li><p><strong>备份到哪里</strong></p><ul><li>在创建快照(snapshot)之前，首先需要创建快照仓库(repository)，一个仓库里面可以有多个快照。</li><li>在 Elasticsearch 中通过 repository 定义备份存储类型和位置，存储类型有共享文件系统、AWS 的 S3存储、HDFS、微软 Azure的存储、Google Cloud 的存储等。</li><li>首先，你要在 elasticsearch.yml 的配置文件中注明可以用作备份路径<code>path.repo</code> ，如下所示：<br>  <code>path.repo: [&quot;D:\\lkh&quot;, &quot;D:\\ES\\elasticsearch\\data\\my_backup&quot;]</code></li><li>配置好后，重启elasticsearch，就可以使用 snapshot api 来创建一个 repository 了，如下我们创建一个名为 my_backup 的 repository。  <pre class="line-numbers language-http" data-language="http"><code class="language-http">PUT /_snapshot/my_backup&#123;  "type": "fs",  "settings": &#123;    "location": "D:\\ES\\elasticsearch\\data\\my_backup",    "compress":"true"  &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>之后我们就可以在这个 repository 中来备份数据了。  <pre class="line-numbers language-http" data-language="http"><code class="language-http">PUT _snapshot/my_backup&#123;    "type": "fs",    "settings": &#123;        "location": "/mount/backups/my_backup",        "max_snapshot_bytes_per_sec" : "50mb",            "max_restore_bytes_per_sec" : "50mb"        &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>参数:<br>  <strong>my_backup</strong>：仓库名称<br>  <strong>type</strong>：指定仓库的类型是一个共享文件系统<br>  <strong>localhost</strong>：指定已挂载的设备作为仓库地址<br>  <strong>compress</strong>:指定是否对快照文件进行压缩. 默认是 true<br>  <strong>compress</strong>:是否将大文件分解成块，分解成块的单位，例子: 1GB, 10MB, 5KB, 500B，默认：null(不限制)<br>  <strong>max_snapshot_bytes_per_sec</strong>：当快照数据进入仓库时，这个参数控制这个过程的限流情况。默认每秒 40mb&#x2F;s<br>  <strong>max_restore_bytes_per_sec</strong>：当从仓库恢复数据时，这个参数控制什么时候恢复过程会被限流以保障你的网络不会被占满。默认每秒 20mb。<br>  <strong>readonly</strong>:仓库快照是否时只读，默认：false</li></ul></li><li><p><strong>如何备份</strong></p><ul><li>有了 repostiroy 后，我们就可以做备份了，也叫快照，也就是记录当下数据的状态。如下所示我们创建一个名为 snapshot_1 的快照。  <pre class="line-numbers language-http" data-language="http"><code class="language-http">PUT /_snapshot/my_backup/snapshot_1?wait_for_completion=true或者备份某一个索引PUT _snapshot/my_backup/snapshot_1&#123;    "indices": "elasticsearch-1",    "ignore_unavailable": true,    "include_global_state": true&#125;wait_for_completion 为 true 是指该 api 在备份执行完毕后再返回结果，否则默认是异步执行的，我们这里为了立刻看到效果，所以设置了该参数，线上执行时不用设置该参数，让其在后台异步执行即可。执行成功后会返回如下结果，用于说明备份的情况：&#123;  "snapshot" : &#123;    "snapshot" : "snapshot_1",    "uuid" : "Jf-7suADTUCudajaWaiqCg",    "version_id" : 6070299,    "version" : "6.7.2",    "indices" : [      "elasticsearch-1",      ".kibana_task_manager",      "elasticsearch-1-index",      ".kibana_1"    ],    "include_global_state" : true,    "state" : "SUCCESS",    "start_time" : "2021-12-13T08:14:36.761Z",    "start_time_in_millis" : 1639383276761,    "end_time" : "2021-12-13T08:14:37.131Z",    "end_time_in_millis" : 1639383277131,    "duration_in_millis" : 370,    "failures" : [ ],    "shards" : &#123;      "total" : 8,      "failed" : 0,      "successful" : 8    &#125;  &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>返回结果的参数意义都是比较直观的，比如 indices 指明此次备份涉及到的索引名称，由于我们没有指定需要备份的索引，这里备份了所有索引；state 指明状态；duration_in_millis 指明备份任务执行时长等。</li><li>此时如果去 &#x2F;mount&#x2F;backups&#x2F;my_backup 查看，会发现里面多了很多文件，这些文件其实都是基于 elasticsearch data 目录中的文件生成的压缩存储的备份文件。大家可以通过 du -sh . 命令看一下该目录的大小，方便后续做对比。</li></ul></li><li><p><strong>何时备份</strong></p><ul><li>通过上面的步骤我们成功创建了一个备份，但随着数据的新增，我们需要对新增的数据也做备份，那么我们如何做呢？方法很简单，只要再创建一个快照 snapshot_new 就可以了。  <pre class="line-numbers language-http" data-language="http"><code class="language-http">PUT /_snapshot/my_backup/snapshot_new?wait_for_completion=true<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>当执行完毕后，es_backup 目录体积变大了，这说明新数据备份进来了。如果在同一个 repository 中做多次 snapshot 时，Elasticsearch 会检查要备份的数据 segment 文件是否有变化，如果没有变化则不处理，否则只会把发生变化的 segment file 备份下来。这其实就实现了增量备份。</li><li>Elasticsearch 的资深用户应该了解 force merge 功能，即可以强行将一个索引的 segment file 合并成指定数目，这里要注意的是如果你主动调用 force merge api，那么 snapshot 功能的增量备份功能就失效了，因为 api 调用完毕后，数据目录中的所有 segment file 都发生变化了。</li><li>另一个就是备份时机的问题，虽然 snapshot 不会占用太多的 cpu、磁盘和网络资源，但还是建议大家尽量在闲时做备份。</li></ul></li><li><p><strong>如何恢复</strong></p><ul><li>通过下面的 api，我们可以将 index_1 索引恢复到 restored_index_1 中。这个恢复过程完全是基于文件的，因此效率会比较高。<br>如果集群中已有快照的索引那就会报索引已存在的错误。   <pre class="line-numbers language-http" data-language="http"><code class="language-http">POST /_snapshot/my_backup/snapshot_1/_restore?   wait_for_completion=true&#123;  "indices": "index_1",  "rename_replacement": "restored_index_1"&#125;POST _snapshot/my_backup/snapshot_1/_restore&#123;  "indices": "elasticsearch-1",  "ignore_unavailable": true,  "include_global_state": false,                "rename_pattern": "elasticsearch-1",  "rename_replacement": "restored_elasticsearch-1",  "include_aliases": false&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>参数解释<ul><li>partial:false可选，默认：false，如果快照包含一个或多个索引没有所有主碎片可用，则整个还原操作将失败。 如果为true，则允许恢复具有不可用碎片的索引的部分快照。将只恢复快照中成功包含的碎片。所有丢失的碎片将重新创建为空 。</li><li>include_global_state:false 将还原快照中的所有数据流和索引，但不还原群集状态，如果ignore_unavailable:false时，一个索引缺失，快照请求会失败，true 时，在创建快照时会忽略不存在的索引</li><li>include_aliases 是否需要别名，true恢复，false不恢复别名</li><li>这个rename_pattern 与rename_replacement 支持正则表达式<br>  使用正则表达式：<br>  “rename_pattern”: “test-0(.+)”,<br>  “rename_replacement”: “restored_test_$1”</li></ul></li><li>还原数据的时候，修改索引配置  <pre class="line-numbers language-http" data-language="http"><code class="language-http">POST /_snapshot/my_backup/snapshot_1/_restore&#123;  "indices": "elasticsearch-1",  "ignore_unavailable": true,  "index_settings": &#123;    "index.number_of_replicas": 0  &#125;,  "ignore_index_settings": [    "index.refresh_interval"  ]&#125;恢复数据时，把恢复索引的副本数改为0（不需要副本）。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>恢复到另外一个集群<br>  重复之前的步骤(当前集群开启备份，并重启服务,创建仓库,将快照目录拷贝到另外一台服务器，恢复快照)</li></ul></li><li><p><strong>注意事项</strong></p><ul><li>快照恢复前需要关掉索引<br>  POST &#x2F;my_index&#x2F;_close<br>  开启索引<br>  POST &#x2F;my_index&#x2F;_open</li><li>不支持高版本备份恢复到低版本中, 低版本备份恢复到高版本部分支持, 具体情况可访问官网查看详情: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html</a></li></ul></li><li><p><strong>基本操作命令</strong></p> <pre class="line-numbers language-http" data-language="http"><code class="language-http">// 恢复的指定索引GET restored_index_3/_recovery// 查看集群里所有索引，可能包括跟你的恢复进程无关的其他分片移动：GET /_recovery/// 取消一个恢复，你需要删除正在恢复的索引。因为恢复进程其实就是分片恢复，发送一个  删除索引 API 修改集群状态，就可以停止恢复进程：DELETE /restored_index_3// 获取所有快照信息GET _snapshot/my_backup/_all// 获取指定快照信息GET /_snapshot/my_backup/snapshot_2// 删除快照DELETE /_snapshot/my_backup/snapshot_2// 删除多个DELETE /_snapshot/my_backup/snapshot_2,snapshot_3,snapshot_4// 通配符删除DELETE /_snapshot/my_backup/snaps*// 过期快照清理POST /_snapshot/my_backup/_cleanup<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>验证集群各个节点是否可以使用这个仓库</strong></p> <pre class="line-numbers language-http" data-language="http"><code class="language-http">POST /_snapshot/my_backup/_verify//返回，说明我3个节点的集群都验证通过&#123;  "nodes" : &#123;    "Ex5l_bvGRT2DazMFYO-M3Q" : &#123;      "name" : "master"    &#125;,    "CPiErxiBQOqvG0jINB42YQ" : &#123;      "name" : "node-002"    &#125;,    "-YG6nieCS7y1bvHN4HHHiA" : &#123;      "name" : "node-003"    &#125;  &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>查看指定快照状态</strong></p><pre class="line-numbers language-http" data-language="http"><code class="language-http">GET /_snapshot/my_backup/snapshot_2/_status<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>分片的状态有以下几种：<ul><li><strong>INITIALIZING</strong> -&gt;分片在检查集群状态看看自己是否可以被快照。这个一般是非常快的。</li><li><strong>STARTED</strong>  -&gt;  数据正在被传输到仓库。</li><li><strong>FINALIZING</strong>  -&gt;  数据传输完成；分片现在在发送快照元数据</li><li><strong>DONE</strong>  -&gt;  快照完成！</li><li><strong>FAILED</strong>  -&gt;  快照处理的时候碰到了错误，这个分片&#x2F;索引&#x2F;快照不可能完成了。检查你的日志获取更多信息。</li></ul></li></ul></li><li><p><strong>查看&#x2F;修改repository信息</strong></p><pre class="line-numbers language-http" data-language="http"><code class="language-http">GET /_snapshot/my_backup?pretty可以使用POST 请求，用来修改已经存在的repositoryPOST /_snapshot/my_backup&#123;    "type": "fs",    "settings": &#123;    "location": "D:\\ES",    "max_snapshot_bytes_per_sec" : "50mb",    "max_restore_bytes_per_sec" : "50mb"    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>其他指令</strong></p><pre class="line-numbers language-http" data-language="http"><code class="language-http">// 列出所有当前正在运行的快照以及显示他们的详细状态信息GET /_snapshot/_status?pretty    // 查看指定仓库正在运行的快照以及显示他们的详细状态信息GET /_snapshot/my_backup/_status?pretty     //快照名可以通过使用 date_math_expressions 来自动获得，和创建新索引时类 似。注意特殊字符需要 URI 转码处理。//例如，在名字中使用当前日期，比如 snapshot-2018.05.11，来创建快照，可以    使用如下命令完成：PUT /_snapshot/my_backup/&lt;snapshot-&#123;now/d&#125;>curl -X PUT "localhost:9200/_snapshot/my_backup/    %3Csnapshot-%7Bnow%2Fd%7D%3E"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>更多指令及操作详情</strong><br>参考官方文档: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Elasticsearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据备份和迁移 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git常用命令图解</title>
      <link href="/2022/11/23/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%9B%BE%E8%A7%A3/"/>
      <url>/2022/11/23/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%9B%BE%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>本文翻译自的Lydia Hallie的博客：<br><a href="https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1">https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1</a></p><h3 id="Git可视化学习网站推荐："><a href="#Git可视化学习网站推荐：" class="headerlink" title="Git可视化学习网站推荐："></a>Git可视化学习网站推荐：</h3><p> <a href="https://learngitbranching.js.org/?locale=zh_CN">https://learngitbranching.js.org/?locale=zh_CN</a></p><h2 id="常用命令图解："><a href="#常用命令图解：" class="headerlink" title="常用命令图解："></a>常用命令图解：</h2><p><img src="/myfile/2022-11-23-151331.png"></p><p>我觉得创建一些最常用且最有用的 Git 命令的可视化示例会是一个完美的用例！下面我将介绍的很多命令都有可选参数——你可以使用这些参数来改变对应命令的行为。而我的示例只会涵盖命令的默认行为，而不会添加（或添加太多）可选参数！</p><h3 id="1-合并-Merging"><a href="#1-合并-Merging" class="headerlink" title="1.合并(Merging)"></a>1.合并(Merging)</h3><p>拥有多个分支是很方便的，这样可以将不同的新修改互相隔离开，而且还能确保你不会意外地向生产代码推送未经许可或破损的代码修改。但一旦这些修改得到了批准许可，我们就需要将其部署到我们的生产分支中！</p><p>可将一个分支的修改融入到另一个分支的一种方式是执行 git merge。Git 可执行两种类型的合并：fast-forward 和 no-fast-forward。现在你可能分不清，但我们马上就来看看它们的差异所在。</p><p>fast-forward (–ff)<br>在当前分支相比于我们要合并的分支没有额外的提交（commit）时，可以执行 fast-forward 合并。Git 很懒，首先会尝试执行最简单的选项：fast-forward！这类合并不会创建新的提交，而是会将我们正在合并的分支上的提交直接合并到当前分支。–ff 是默认参数，可以不写。</p><p><img src="/myfile/2022-11-23-151355.gif"></p><p>完美！现在，我们在 dev 分支上所做的所有改变都合并到了 master 分支上。那么 no-fast-forward 又是什么意思呢？</p><p>no-fast-forward (–no-ff)<br>如果你的当前分支相比于你想要合并的分支没有任何提交，那当然很好，但很遗憾现实情况很少如此！如果我们在当前分支上提交我们想要合并的分支不具备的改变，那么 git 将会执行 no-fast-forward 合并。</p><p>使用 no-fast-forward 合并时，Git 会在当前活动分支上创建新的 merging commit。这个提交的父提交（parent commit）即指向这个活动分支，也指向我们想要合并的分支！</p><p><img src="/myfile/2022-11-23-151506.gif"></p><p>没什么大不了的，完美的合并！现在，我们在 dev 分支上所做的所有改变都合并到了 master 分支上。</p><h3 id="2-冲突解决-Merge-Conflicts"><a href="#2-冲突解决-Merge-Conflicts" class="headerlink" title="2.冲突解决(Merge Conflicts)"></a>2.冲突解决(Merge Conflicts)</h3><p>尽管 Git 能够很好地决定如何合并分支以及如何向文件添加修改，但它并不总是能完全自己做决定。当我们想要合并的两个分支的同一文件中的同一行代码上有不同的修改，或者一个分支删除了一个文件而另一个分支修改了这个文件时，Git 就不知道如何取舍了。</p><p>在这样的情况下，Git 会询问你想要保留哪种选择？假设在这两个分支中，我们都编辑了 README.md的第一行。</p><p><img src="/myfile/2022-11-23-151525.png">  </p><p>如果我们想把 dev 合并到 master，就会出现一个合并冲突：你想要标题是 Hello! 还是 Hey!？<br>当尝试合并这些分支时，Git 会向你展示冲突出现的位置。我们可以手动移除我们不想保留的修改，保存这些修改，再次添加这个已修改的文件，然后提交这些修改。</p><p><img src="/myfile/2022-11-23-151542.gif"> </p><p>完成！尽管合并冲突往往很让人厌烦，但这是合理的：Git 不应该瞎猜我们想要保留哪些修改。</p><h3 id="3-变基-Rebasing"><a href="#3-变基-Rebasing" class="headerlink" title="3.变基(Rebasing)"></a>3.变基(Rebasing)</h3><p>我们刚看到可通过执行 git merge 将一个分支的修改应用到另一个分支。另一种可将一个分支的修改融入到另一个分支的方式是执行 git rebase。</p><p>git rebase 会将当前分支的提交复制到指定的分支之上。</p><p><img src="/myfile/2022-11-23-151707.gif"> </p><p>完美，现在我们在 dev 分支上获取了 master 分支上的所有修改。</p><p>git rebase与git merge有一个重大的区别：Git 不会尝试确定要保留或不保留哪些文件。我们执行 rebase 的分支总是含有我们想要保留的最新近的修改！这样我们不会遇到任何合并冲突，而且可以保留一个漂亮的、线性的 Git 历史记录。</p><p>上面这个例子展示了在 master 分支上的rebase。但是，在更大型的项目中，你通常不需要这样的操作。git rebase 在为复制的提交创建新的 hash 时会修改项目的历史记录。</p><p>如果你在开发一个 feature 分支并且 master 分支已经更新过，那么变基就很好用。你可以在你的分支上获取所有更新，这能防止未来出现合并冲突。</p><h3 id="4-交互式变基-Interactive-Rebase"><a href="#4-交互式变基-Interactive-Rebase" class="headerlink" title="4.交互式变基(Interactive Rebase)"></a>4.交互式变基(Interactive Rebase)</h3><p>在为提交执行变基之前，我们可以修改它们！我们可以使用交互式变基来完成这一任务。交互式变基在你当前开发的分支上以及想要修改某些提交时会很有用。<br>在我们正在 rebase 的提交上，我们可以执行以下 6 个动作：</p><ul><li>reword：修改提交信息；</li><li>edit：修改此提交；</li><li>squash：将提交融合到前一个提交中；</li><li>fixup：将提交融合到前一个提交中，不保留该提交的日志消息；</li><li>exec：在每个提交上运行我们想要 rebase 的命令；</li><li>drop：移除该提交。<br>很棒！这样我们就能完全控制我们的提交了。如果你想要移除一个提交，只需 drop 即可。</li></ul><p><img src="/myfile/2022-11-23-151837.gif"> </p><p>如果你想把多个提交融合到一起以便得到清晰的提交历史，那也没有问题！</p><p><img src="/myfile/2022-11-23-151847.gif"> </p><p>交互式变基能为你在 rebase 时提供大量控制，甚至可以控制当前的活动分支。</p><h3 id="5-重置-Resetting"><a href="#5-重置-Resetting" class="headerlink" title="5.重置(Resetting)"></a>5.重置(Resetting)</h3><p>当我们不想要之前提交的修改时，就会用到这个命令。也许这是一个 WIP 提交或者可能是引入了 bug 的提交，这时候就要执行 git reset。</p><p>git reset 能让我们不再使用当前台面上的文件，让我们可以控制 HEAD 应该指向的位置。</p><p>Soft reset<br>软重置会将 HEAD 移至指定的提交（或与 HEAD 相比的提交的索引），而不会移除该提交之后加入的修改！</p><p>假设我们不想保留添加了一个 style.css 文件的提交 9e78i，而且我们也不想保留添加了一个 index.js 文件的提交 035cc。但是，我们确实又想要保留新添加的 style.css 和 index.js 文件！这是软重置的一个完美用例。</p><p><img src="/myfile/2022-11-23-151859.gif"> </p><p>输入 git status 后，你会看到我们仍然可以访问在之前的提交上做过的所有修改。这很好，这意味着我们可以修复这些文件的内容，之后再重新提交它们！</p><p>Hard reset<br>有时候我们并不想保留特定提交引入的修改。不同于软重置，我们应该再也无需访问它们。Git 应该直接将整体状态直接重置到特定提交之前的状态：这甚至包括你在工作目录中和暂存文件上的修改。</p><p><img src="/myfile/2022-11-23-151905.gif"> </p><p>Git 丢弃了 9e78i 和 035cc 引入的修改，并将状态重置到了 ec5be 的状态。</p><h3 id="6-还原-Reverting"><a href="#6-还原-Reverting" class="headerlink" title="6.还原(Reverting)"></a>6.还原(Reverting)</h3><p>另一种撤销修改的方法是执行 git revert。通过对特定的提交执行还原操作，我们会创建一个包含已还原修改的新提交。</p><p>假设 ec5be 添加了一个 index.js 文件。但之后我们发现其实我们再也不需要由这个提交引入的修改了。那就还原 ec5be 提交吧！</p><p><img src="/myfile/2022-11-23-151911.gif"> </p><p>完美！提交 9e78i 还原了由提交 ec5be 引入的修改。在撤销特定的提交时，git revert 非常有用，同时也不会修改分支的历史。</p><h3 id="7-拣选-Cherry-picking"><a href="#7-拣选-Cherry-picking" class="headerlink" title="7.拣选(Cherry-picking)"></a>7.拣选(Cherry-picking)</h3><p>当一个特定分支包含我们的活动分支需要的某个提交时，我们对那个提交执行 cherry-pick！对一个提交执行 cherry-pick 时，我们会在活动分支上创建一个新的提交，其中包含由拣选出来的提交所引入的修改。</p><p>假设 dev 分支上的提交 76d12 为 index.js 文件添加了一项修改，而我们希望将其整合到 master 分支中。我们并不想要整个 dev 分支，而只需要这个提交！</p><p><img src="/myfile/2022-11-23-151920.gif"> </p><p>现在 master 分支包含 76d12 引入的修改了。</p><h3 id="8-取回-Fetching"><a href="#8-取回-Fetching" class="headerlink" title="8.取回(Fetching)"></a>8.取回(Fetching)</h3><p>如果你有一个远程 Git 分支，比如在 GitHub 上的分支，当远程分支上包含当前分支没有的提交时，可以使用取回。比如当合并了另一个分支或你的同事推送了一个快速修复时。</p><p>通过在这个远程分支上执行 git fetch，我们就可在本地获取这些修改。这不会以任何方式影响你的本地分支：fetch 只是单纯地下载新的数据而已。</p><p><img src="/myfile/2022-11-23-151926.gif"> </p><p>现在我们可以看到自上次推送以来的所有修改了。这些新数据也已经在本地了，我们可以决定用这些新数据做什么了。</p><h3 id="9-拉取-Pulling"><a href="#9-拉取-Pulling" class="headerlink" title="9.拉取(Pulling)"></a>9.拉取(Pulling)</h3><p>尽管 git fetch 可用于获取某个分支的远程信息，但我们也可以执行 git pull。git pull 实际上是两个命令合成了一个：git fetch 和 git merge。当我们从来源拉取修改时，我们首先是像 git fetch 那样取回所有数据，然后最新的修改会自动合并到本地分支中。</p><p><img src="/myfile/2022-11-23-151931.gif"> </p><p>很好，我们现在与远程分支完美同步了，并且也有了所有最新的修改！</p><h3 id="10-操作日志-Reflog"><a href="#10-操作日志-Reflog" class="headerlink" title="10.操作日志(Reflog)"></a>10.操作日志(Reflog)</h3><p>每个人都会犯错，但犯错其实没啥！有时候你可能感觉你把 git repo 完全搞坏了，让你想完全删了了事。</p><p>git reflog 是一个非常有用的命令，可以展示已经执行过的所有动作的日志。包括合并、重置、还原，基本上包含你对你的分支所做的任何修改。</p><p><img src="/myfile/2022-11-23-151937.gif"> </p><p>如果你犯了错，你可以根据 reflog 提供的信息通过重置 HEAD 来轻松地重做！</p><p>假设我们实际上并不需要合并原有分支。当我们执行 git reflog 命令时，我们可以看到这个 repo 的状态在合并前位于 HEAD@{1}。那我们就执行一次 git reset，将 HEAD 重新指向在 HEAD@{1} 的位置。</p><p><img src="/myfile/2022-11-23-151947.gif"> </p><p>我们可以看到最新的动作已被推送给 reflog。</p>]]></content>
      
      
      <categories>
          
          <category> 开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python虚拟环境管理</title>
      <link href="/2022/11/04/Python%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/"/>
      <url>/2022/11/04/Python%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h3 id="工具特点一览："><a href="#工具特点一览：" class="headerlink" title="工具特点一览："></a>工具特点一览：</h3><ul><li>Venv【python 3.3 版本之后添加的官方库】</li><li>Virtualenv【适用于各个版本的管理工具】</li><li>Virtualenvwrapper【可集群管理虚拟环境】</li><li>Virtualenv-burrito【管理上面两者的工具】</li><li>Pipenv【针对 Python 项目的依赖管理器】</li><li>Pipx【轻量级应用管理工具】</li><li>Autoenv【自动激活与退出虚拟环境】</li><li>Anaconda &#x2F; Miniconda【兼容不同版本的 Python】</li></ul><h3 id="不同的场景推荐使用不同的工具："><a href="#不同的场景推荐使用不同的工具：" class="headerlink" title="不同的场景推荐使用不同的工具："></a>不同的场景推荐使用不同的工具：</h3><ul><li><p>针对 Windows 用户</p><ul><li><p>强烈推荐使用 Miniconda，能够轻易的创建任意版本的 Python，且随时可以切换环境使用</p></li><li><p>如果需要一个干净的 Python 环境进行测试，推荐使用 Pipenv，创建虚拟环境的速度非常快，且库依赖不冲突</p></li><li><p>从公司到家办公，或其他环境迁移的情况，推荐使用 Miniconda 和 Pipenv，它们管理库依赖的能力都很强</p></li></ul></li><li><p>针对 Linux 用户</p><ul><li>推荐使用 Virtualenv，相比于其他工具还要配置各种环境，它下载即可使用，方便</li></ul></li></ul><h3 id="一、Venv"><a href="#一、Venv" class="headerlink" title="一、Venv"></a>一、Venv</h3><p><strong>venv 在 python 3.3 版本及之后才能使用，且建立的虚拟环境的 python 版本与系统环境一致，不能修改！<br>如果你的系统含有多个 python 版本，那么可以指定版本建立虚拟环境（如 <code>python3.6 -m ven .\temp_env</code>），不能指定系统中不存在的版本</strong></p><p>因为 Windows 中 venv 已经以标准库的形式存在，不用再单独安装<br>而 Linux 可能会提示 <code>apt install python3.x-venv</code>，运行该命令即可</p><p>成功创建后，虚拟环境文件夹包含以下文件：</p><ul><li>bin【包含 pip、python 等一些可执行环境】</li><li>include</li><li>lib【包含 site-packages，用于储存下载的库】</li><li>lib64</li><li>pyvenv.cfg【配置文件】</li><li>Scripts【Windows 特有，用于启动环境和执行命令】</li></ul><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># Windows</span><span class="token comment"># 在当前目录下，创建独立环境（名字为 temp_env）</span>python <span class="token operator">-</span>m venv <span class="token punctuation">.</span>\temp_env<span class="token comment"># 进入环境并启用</span>cd temp_env &amp; <span class="token punctuation">.</span>\Scripts\activate<span class="token punctuation">.</span>bat<span class="token comment"># 此时左边括号会显示（temp_env），代表成功进入虚拟环境中了</span><span class="token comment"># 在虚拟环境中随意下载库，都不会影响外面的环境</span>pip install request<span class="token comment"># 退出环境</span>deactivate<span class="token comment"># 如果不需要该虚拟环境了，直接手动删除文件夹即可</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># Linux</span><span class="token comment"># 在当前目录下，创建独立环境（名字为 temp_env）</span>python3 <span class="token operator">-</span>m venv <span class="token punctuation">.</span><span class="token operator">/</span>temp_env<span class="token comment"># 进入环境并启用</span>cd temp_env &amp;&amp; source <span class="token punctuation">.</span><span class="token operator">/</span>bin/activate<span class="token comment"># 此时左边括号会显示（temp_env），代表成功进入虚拟环境中了</span><span class="token comment"># 在虚拟环境中随意下载库，都不会影响外面的环境</span>pip install request<span class="token comment"># 退出环境</span>deactivate<span class="token comment"># 如果不需要该虚拟环境了，直接删除文件夹即可</span><span class="token function">rm</span> <span class="token operator">-</span>rf <span class="token punctuation">.</span><span class="token operator">/</span>temp_env<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、Virtualenv"><a href="#二、Virtualenv" class="headerlink" title="二、Virtualenv"></a>二、Virtualenv</h3><p>virtualenv 可以看作是 venv 的增强版，不过早在 venv 出现之前，virtualenv 就算是最受欢迎的命令行环境管理工具了</p><p>如果 Linux 提示 <code>sudo apt install python3-virtualenv</code>，运行该命令即可</p><p>virtualenv 的特点如下：</p><p>依然不能指定本地系统中不存在的 python 版本<br>相比 venv，它支持 2.x、3.x 的 python 版本<br>相比 venv，可以选择是否继承父环境的 pip 包（<code>--system-site-packages</code>）</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># Windows</span><span class="token comment"># 下载 virtualenv</span>pip install virtualenv<span class="token comment"># 在当前目录下，创建独立环境（名字为 temp_env）</span><span class="token comment"># python 版本可以指定本地系统中含有的</span>virtualenv <span class="token operator">-</span>p python temp_env<span class="token comment"># 如果要继承父环境的 pip 包</span>virtualenv <span class="token operator">-</span>p python <span class="token operator">--</span>system-site-packages temp_env<span class="token comment"># 进入环境并启用</span>cd temp_env &amp; <span class="token punctuation">.</span>\Scripts\activate<span class="token punctuation">.</span>bat<span class="token comment"># 此时左边括号会显示（temp_env），代表成功进入虚拟环境中了</span><span class="token comment"># 在虚拟环境中随意下载库，都不会影响外面的环境</span>pip install request<span class="token comment"># 退出环境</span>deactivate<span class="token comment"># 如果不需要该虚拟环境了，直接手动删除文件夹即可</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># Linux</span><span class="token comment"># 下载 virtualenv</span>pip install virtualenv<span class="token comment"># 在当前目录下，创建独立环境（名字为 temp_env）</span><span class="token comment"># python 版本可以指定本地系统中含有的</span>virtualenv <span class="token operator">-</span>p python temp_env<span class="token comment"># 如果要继承父环境的 pip 包</span>virtualenv <span class="token operator">-</span>p python <span class="token operator">--</span>system-site-packages temp_env<span class="token comment"># 进入环境并启用</span>cd temp_env &amp;&amp; source <span class="token punctuation">.</span><span class="token operator">/</span>bin/activate<span class="token comment"># 此时左边括号会显示（temp_env），代表成功进入虚拟环境中了</span><span class="token comment"># 在虚拟环境中随意下载库，都不会影响外面的环境</span>pip install request<span class="token comment"># 退出环境</span>deactivate<span class="token comment"># 如果不需要该虚拟环境了，直接删除文件夹即可</span><span class="token function">rm</span> <span class="token operator">-</span>rf <span class="token punctuation">.</span><span class="token operator">/</span>temp_env<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、Virtualenvwrapper"><a href="#三、Virtualenvwrapper" class="headerlink" title="三、Virtualenvwrapper"></a>三、Virtualenvwrapper</h3><p><strong>virtualenvwrapper 又可以看作是 virtualen 的增强版</strong></p><p>virtualenvwrapper 的特点如下：</p><ul><li>可以对虚拟环境集中管理，即指定虚拟文件夹的存放位置</li><li>配置非常麻烦</li></ul><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># Windows</span><span class="token comment"># 下载 virtualenvwrapper，要确保已经安装过了 virtualenv</span>pip install virtualenvpip install virtualenvwrapper-win<span class="token comment"># 修改虚拟文件夹的存放位置（默认是 C:\Users\Username\Envs）</span><span class="token comment"># 打开“编辑系统环境变量” -> 环境变量 -> 新建系统变量 -> 变量名 WORKON_HOME -> 变量值 D:\XXX（修改的位置）</span><span class="token comment"># 然后重新打开 cmd</span><span class="token comment"># 创建独立环境（名字为 temp_env）并启用</span><span class="token comment"># python 版本可以指定本地系统中含有的</span>mkvirtualenv <span class="token operator">--</span>python=python temp_env<span class="token comment"># 查看当前的虚拟环境目录（两个命令都行）</span>lsvirtualenv <span class="token operator">/</span> workon<span class="token comment"># 进入 / 切换虚拟环境</span><span class="token comment"># 此处我另外创建了 temp_env2</span>workon temp_env2<span class="token comment"># 在不同的虚拟环境中进行任意操作，对不会影响其他的虚拟环境和外面的环境，此处就不演示了</span><span class="token comment"># 退出环境</span>deactivate<span class="token comment"># 删除虚拟环境</span>rmvirtualenv temp_env<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Linux</span><span class="token comment"># 下载 virtualenvwrapper，要确保已经安装过了 virtualenv</span>pip <span class="token function">install</span> virtualenvpip <span class="token function">install</span> virtualenvwrapper<span class="token comment"># 先修改相关配置</span><span class="token comment"># 在 ~/.bashrc 或 ~/.zshrc 或其它环境变量相关文件中修改（一般默认是 ~/.bashrc）</span><span class="token function">nano</span> ~/.bashrc<span class="token comment"># 在最后一行添加以下三行内容</span><span class="token comment"># 虚拟文件夹的存放位置（默认是 ～/.virtualenvs），此处我不做修改</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">WORKON_HOME</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/.virtualenvs<span class="token comment"># 创建工作目录（使用 mkproject 时会用到，但一般用不到）</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">PROJECT_HOME</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/workspace<span class="token comment"># 指定 python 版本的位置</span><span class="token comment"># 如果不清楚位置的，可以另开一个 bash，输入 whereis python3 命令查看（一般是 /usr/bin/xxx）</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">VIRTUALENVWRAPPER_PYTHON</span><span class="token operator">=</span>/usr/bin/python3<span class="token comment"># 输入完后按 Shift + x，再输入 y，点击回车即可</span><span class="token comment"># 最后保存配置</span><span class="token builtin class-name">source</span> ~/.bashrc<span class="token comment"># 然后重新打开 bash</span><span class="token comment"># virtualenvwrapper 进行初始化</span><span class="token comment"># 如果不清楚位置的，可以另开一个 bash，输入 whereis virtualenvwrapper.sh 命令查看（一般是 /usr/local/xxx）</span><span class="token builtin class-name">source</span> /usr/local/bin/virtualenvwrapper.sh<span class="token comment"># 创建独立环境（名字为 temp_env）并启用</span><span class="token comment"># python 版本可以指定本地系统中含有的</span>mkvirtualenv --python<span class="token operator">=</span>python3 temp_env<span class="token comment"># 查看当前的虚拟环境目录（两个命令都行）</span>lsvirtualenv / workon<span class="token comment"># 进入 / 切换虚拟环境</span><span class="token comment"># 此处我另外创建了 temp_env2</span>workon temp_env2<span class="token comment"># 在不同的虚拟环境中进行任意操作，对不会影响其他的虚拟环境和外面的环境，此处就不演示了</span><span class="token comment"># 退出环境</span>deactivate<span class="token comment"># 删除虚拟环境</span>rmvirtualenv temp_env<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四、Virtualenv-burrito"><a href="#四、Virtualenv-burrito" class="headerlink" title="四、Virtualenv-burrito"></a>四、Virtualenv-burrito</h3><p>官方描述：使用单行命令拥有 virtualenv + virtualenvwrapper 的环境</p><p>virtualenv-burrito 的特定如下：</p><p>仅适用于 python 2.x<br>省去了配置 virtualenvwrapper 的琐碎流程<br>具体使用方法和 virtualenvwrapper 类似<br>使用命令 <code>virtualenv-burrito upgrade</code> 一键更新 virtualenv + virtualenvwrapper</p><h3 id="五、Pipenv"><a href="#五、Pipenv" class="headerlink" title="五、Pipenv"></a>五、Pipenv</h3><p>Pipenv 集成了 pip，virtualenv 两者的功能，且完善了两者的一些缺陷</p><p>pipenv 的特点如下：</p><p>一般环境生成的 requirements.txt 文件可能存在问题，而 pipenv 使用了 Pipfile 和 Pipfile.lock 确保了稳健性<br>只能创建唯一的虚拟环境，更适用于一次性测试<br>无需配置，命令简明，更易于记忆<br>各个地方使用了哈希校验，不仅安全，且会自动公开安全漏洞</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># Windows</span><span class="token comment"># 下载 pipenv</span><span class="token comment"># 全局安装，如果只想在当前用户模式下安装，可添加参数 --user</span>pip install pipenv<span class="token comment"># 创建虚拟环境</span><span class="token comment"># 默认创建位置是 .\Envs\Temporary-xxx</span><span class="token comment"># python 版本可以指定本地系统中含有的</span>pipenv <span class="token operator">--</span>two  <span class="token comment"># 使用当前系统中的 Python2 创建环境</span>pipenv <span class="token operator">--</span>three  <span class="token comment"># 使用当前系统中的 Python3 创建环境</span>pipenv <span class="token operator">--</span>python 3  <span class="token comment"># 指定使用 Python3 创建环境</span>pipenv <span class="token operator">--</span>python 3<span class="token punctuation">.</span>6  <span class="token comment"># 指定使用 Python3.6 创建环境</span>pipenv <span class="token operator">--</span>python 2<span class="token punctuation">.</span>7<span class="token punctuation">.</span>14  <span class="token comment"># 指定使用 Python2.7.14 创建环境</span><span class="token comment"># 激活虚拟环境</span>pipenv shell<span class="token comment"># 使用 python 运行文件</span>python xxx<span class="token punctuation">.</span>py<span class="token comment"># 退出虚拟环境</span><span class="token keyword">exit</span><span class="token comment"># 删除虚拟环境</span>pipenv <span class="token operator">--</span><span class="token function">rm</span><span class="token comment"># 常用命令</span>pipenv <span class="token operator">--</span>where  <span class="token comment"># 显示目录信息</span>pipenv <span class="token operator">--</span>venv  <span class="token comment"># 显示虚拟环境信息</span>pipenv <span class="token operator">--</span>py  <span class="token comment"># 显示 Python 解释器信息</span>pipenv install XXX  <span class="token comment"># 安装 XXX 模块并加入到 Pipfile</span>pipenv install XXX==1<span class="token punctuation">.</span>11  <span class="token comment"># 安装固定版本的 XXX 模块并加入到 Pipfile</span>pipenv graph  <span class="token comment"># 查看目前安装的库及其依赖</span>pipenv check  <span class="token comment"># 检查安全漏洞</span>pipenv update <span class="token operator">--</span>outdated  <span class="token comment"># 查看所有需要更新的依赖项</span>pipenv update  <span class="token comment"># 更新所有包的依赖项</span>pipenv update &lt;包名>  <span class="token comment"># 更新指定的包的依赖项</span>pipenv uninstall XXX  <span class="token comment"># 卸载 XXX 模块并从 Pipfile 中移除</span>pipenv uninstall <span class="token operator">--</span>all  <span class="token comment"># 卸载全部包并从 Pipfile 中移除</span>pipenv uninstall <span class="token operator">--</span>all-dev  <span class="token comment"># 卸载全部开发包并从 Pipfile 中移除</span>pipenv lock <span class="token operator">-</span>r > requirements<span class="token punctuation">.</span>txt  <span class="token comment"># 将 Pipfile 和 Pipfile.lock 文件里面的包导出为 requirements.txt 文件</span>pipenv lock <span class="token operator">-</span>r <span class="token operator">--</span>dev > requirements<span class="token punctuation">.</span>txt  <span class="token comment"># 将 Pipfile 和 Pipfile.lock 文件里面的开发包导出为 requirements.txt 文件</span>pipenv install <span class="token operator">-</span>r requirements<span class="token punctuation">.</span>txtpipenv install <span class="token operator">-</span>r <span class="token operator">--</span>dev requirements<span class="token punctuation">.</span>txt  <span class="token comment"># 只安装开发包</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="六、Pipx"><a href="#六、Pipx" class="headerlink" title="六、Pipx"></a>六、Pipx</h3><p>pipx 相比于前面介绍的，属于是非常轻量级工具了<br>但它仅适用于可直接运行的应用程序，而不是专门为 python 服务的</p><p>pipx 的特点如下：</p><p>能够直接在临时虚拟环境中运行应用程序（如 <code>pipx run pycowsay moo</code>）<br>运行非常容易报错（或许只有我是这样）<br>Windows 用户的默认下载位置为 <code>C:\Users\Username\.local\pipx\venvs</code><br>Linux 用户的默认下载位置为 <code>/home/ubuntu/.local/pipx/venvs</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Windows / Linux</span><span class="token comment"># 下载 pipx</span>pip <span class="token function">install</span> pipxpipx ensurepath<span class="token comment"># 然后重新打开 cmd / bash</span>pipx list <span class="token comment"># 查看所有已安装的应用</span>pipx <span class="token function">install</span> <span class="token operator">&lt;</span>pkn<span class="token operator">></span> <span class="token comment"># 下载特定应用</span>pipx uninstall <span class="token operator">&lt;</span>pkn<span class="token operator">></span> <span class="token comment"># 卸载特定应用</span>pipx upgrade <span class="token operator">&lt;</span>pkn<span class="token operator">></span> <span class="token comment"># 更新特定应用</span>pipx upgrade-all <span class="token comment"># 更新全部应用</span>pipx run pycowsay moooo <span class="token comment"># 直接运行某个库，不用下载</span>pipx run <span class="token operator">&lt;</span>website<span class="token operator">></span>.<span class="token operator">&lt;</span>pyn<span class="token operator">></span>.py <span class="token comment"># 直接运行网站上的 py 文件</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="七、Autoenv"><a href="#七、Autoenv" class="headerlink" title="七、Autoenv"></a>七、Autoenv</h3><p>官方描述：当您 cd 进入一个包含 .env 的目录中，就会 autoenv 自动激活那个环境</p><p>autoenv 的特点如下：</p><p>进入文件夹，自动启动虚拟环境；退出文件夹，自动退出虚拟环境<br>类似的项目还有 direnv</p><h3 id="八、Anaconda-x2F-Miniconda"><a href="#八、Anaconda-x2F-Miniconda" class="headerlink" title="八、Anaconda &#x2F; Miniconda"></a>八、Anaconda &#x2F; Miniconda</h3><p>官方描述：Anaconda 是一个用于科学计算的 Python 发行版（但主要使用它管理 python 版本的功能）<br>Miniconda 是一个 Anaconda 的轻量级替代，默认只包含了 python 和 conda，但是可以通过 pip 和 conda 来安装所需要的包</p><p>anaconda &#x2F; miniconda 的特点如下：</p><p>相比于上面全部的虚拟环境管理工具，这是唯一一个能创建本地系统不存在 python 版本的工具，即任意版本都能使用<br>anaconda 体积巨大，推荐使用 mimiconda<br>操作方便，功能强大（支持环境迁移）<br>PS：软件下载与换源，参考<a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/">anaconda | 镜像站使用帮助 | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a>的步骤，此处不做讲解</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Windows</span><span class="token comment"># ----------- 使用 conda 创建 python 虚拟环境 -----------</span><span class="token comment"># 使用的 python 版本 = 3.6 并命名环境名为 data</span>conda create -n data <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.6</span><span class="token comment"># 下载所需 python 库</span><span class="token comment"># conda install -n data package_name</span>conda <span class="token function">install</span> -n data numpyconda <span class="token function">install</span> -n data <span class="token assign-left variable">matplotlib</span><span class="token operator">==</span><span class="token number">3.3</span>.1<span class="token comment"># 进入环境</span>conda activate data<span class="token comment"># 清除缓存</span><span class="token comment"># conda clean -i</span><span class="token comment"># 卸载已有 python 库</span><span class="token comment"># conda uninstall -n data package_name</span><span class="token comment"># 更新已有 python 库</span><span class="token comment"># conda upgrade -n data package_name</span><span class="token comment"># ----------- 使用 conda 进行虚拟环境的调整 -----------</span><span class="token comment"># 查看当前环境</span>conda info<span class="token comment"># 查看全部环境</span>conda info --envs<span class="token comment"># 检查并更新当前 conda</span>conda update conda<span class="token comment"># 进入旧环境</span>conda activate old_name<span class="token comment"># 克隆旧环境</span>conda create -n new_name --clone old_name<span class="token comment"># 退出旧环境</span>conda deactivate<span class="token comment"># 删除旧环境(最后记得删除旧环境的文件夹)</span>conda remove -n old_name --all<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用开源协议对比</title>
      <link href="/2022/08/06/%E5%B8%B8%E7%94%A8%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE%E5%AF%B9%E6%AF%94/"/>
      <url>/2022/08/06/%E5%B8%B8%E7%94%A8%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE%E5%AF%B9%E6%AF%94/</url>
      
        <content type="html"><![CDATA[<h2 id="常用开源协议对比："><a href="#常用开源协议对比：" class="headerlink" title="常用开源协议对比："></a>常用开源协议对比：</h2><p>现今存在的开源协议很多，而经过Open Source Initiative组织通过批准的开源协议目前有 <a href="http://www.opensource.org/licenses/alphabetical">80种</a></p><p><img src="/myfile/06235c0c6854acb6e43b67dfdc506f7e.png"></p><h2 id="BSD开源协议（original-BSD-license、FreeBSD-license、Original-BSD-license）"><a href="#BSD开源协议（original-BSD-license、FreeBSD-license、Original-BSD-license）" class="headerlink" title="BSD开源协议（original BSD license、FreeBSD license、Original BSD license）"></a>BSD开源协议（original BSD license、FreeBSD license、Original BSD license）</h2><p>          BSD开源协议是一个给于使用者很大自由的协议。基本上使用者可以”为所欲为”,可以自由的使用，修改源代码，也可以将修改后的代码作为开源或者专有软件再发布。</p><p>          但“为所欲为”的前提当你发布使用了BSD协议的代码，或则以BSD协议代码为基础做二次开发自己的产品时，需要满足三个条件：</p><ul><li><p>如果再发布的产品中包含源代码，则在源代码中必须带有原来代码中的BSD协议。</p></li><li><p>如果再发布的只是二进制类库&#x2F;软件，则需要在类库&#x2F;软件的文档和版权声明中包含原来代码中的BSD协议。</p></li><li><p>不可以用开源代码的作者&#x2F;机构名字和原来产品的名字做市场推广。</p><p>BSD 代码鼓励代码共享，但需要尊重代码作者的著作权。BSD由于允许使用者修改和重新发布代码，也允许使用或在BSD代码上开发商业软件发布和销售，因此是对商业集成很友好的协议。而很多的公司企业在选用开源产品的时候都首选BSD协议，因为可以完全控制这些第三方的代码，在必要的时候可以修改或者二次开发。</p></li></ul><h2 id="Apache-Licence-2-0（Apache-License-Version-2-0、Apache-License-Version-1-1、Apache-License-Version-1-0）"><a href="#Apache-Licence-2-0（Apache-License-Version-2-0、Apache-License-Version-1-1、Apache-License-Version-1-0）" class="headerlink" title="Apache Licence 2.0（Apache License, Version 2.0、Apache License, Version 1.1、Apache License, Version 1.0）"></a>Apache Licence 2.0（Apache License, Version 2.0、Apache License, Version 1.1、Apache License, Version 1.0）</h2><p>        Apache Licence是著名的非盈利开源组织Apache采用的协议。该协议和BSD类似，同样鼓励代码共享和尊重原作者的著作权，同样允许代码修改，再发布（作为开源或商业软件）。需要满足的条件也和BSD类似：</p><ul><li><p>需要给代码的用户一份Apache Licence</p></li><li><p>如果你修改了代码，需要再被修改的文件中说明。</p></li><li><p>在延伸的代码中（修改和有源代码衍生的代码中）需要带有原来代码中的协议，商标，专利声明和其他原来作者规定需要包含的说明。</p></li><li><p>如果再发布的产品中包含一个Notice文件，则在Notice文件中需要带有Apache Licence。你可以在Notice中增加自己的许可，但不可以表现为对Apache Licence构成更改。</p><p>Apache Licence也是对商业应用友好的许可。使用者也可以在需要的时候修改代码来满足需要并作为开源或商业产品发布&#x2F;销售。</p></li></ul><h2 id="GPL（GNU-General-Public-License）通用性公开许可证"><a href="#GPL（GNU-General-Public-License）通用性公开许可证" class="headerlink" title="GPL（GNU General Public License）通用性公开许可证"></a>GPL（GNU General Public License）通用性公开许可证</h2><p>       我们很熟悉的Linux就是采用了GPL。GPL协议和BSD, Apache Licence等鼓励代码重用的许可很不一样。GPL的出发点是代码的开源&#x2F;免费使用和引用&#x2F;修改&#x2F;衍生代码的开源&#x2F;免费使用，但不允许修改后和衍生的代码做为闭源的商业软件发布和销售。这也就是为什么我们能用免费的各种linux，包括商业公司的linux和linux上各种各样的由个人，组织，以及商业软件公司开发的免费软件了。</p><p>       GPL规定：只要这种修改文本在整体上或者其某个部分来源于遵循GPL的程序，该修改文本的 整体就必须按照GPL流通，不仅该修改文本的源码必须向社会公开，而且对于这种修改文本的流通不准许附加修改者自己作出的限制。因此，一项遵循GPL流通 的程序不能同非自由的软件合并。GPL所表达的这种流通规则称为copyleft，表示与copyright(版权)的概念“相左”。</p><p>        GPL协议最主要的几个原则：</p><ul><li><p>确保软件自始至终都以开放源代码形式发布，保护开发成果不被窃取用作商业发售。任何一套软 件，只要其中使用了受 GPL 协议保护的第三方软件的源程序，并向非开发人员发布时，软件本身也就自动成为受 GPL 保护并且约束的实体。也就是说，此时它必须开放源代码。</p></li><li><p>GPL 大致就是一个左侧版权（Copyleft，或译为“反版权”、“版权属左”、“版权所无”、“版责”等）的体现。你可以去掉所有原作的版权 信息，只要你保持开源，并且随源代码、二进制版附上 GPL 的许可证就行，让后人可以很明确地得知此软件的授权信息。GPL 精髓就是，只要使软件在完整开源 的情况下，尽可能使使用者得到自由发挥的空间，使软件得到更快更好的发展。</p></li><li><p>无论软件以何种形式发布，都必须同时附上源代码。例如在 Web 上提供下载，就必须在二进制版本（如果有的话）下载的同一个页面，清楚地提供源代码下载的链接。如果以光盘形式发布，就必须同时附上源文件的光盘。</p></li><li><p>开发或维护遵循 GPL 协议开发的软件的公司或个人，可以对使用者收取一定的服务费用。但还是一句老话——必须无偿提供软件的完整源代码，不得将源代码与服务做捆绑或任何变相捆绑销售。</p><p>GPL 只是规定用户在获取你的程序的时候必须可以获得源代码，但并没有规定必须免费，因此理论上说，你仍然可以收取费用。如果你的确需要发布你的程序，但又不想开源，规避 GPL 的方法是通过 LPC 或者 RPC 间接调用库里的接口。只要库和你的程序不运行在同一进程下，就不需要开源。</p><p>另外，你需要区分 GPL 和 LGPL。LGPL 的要求比 GPL 低，你可以动态链接一个 LGPL 的库而不需要开源你自己的程序，而 GPL 是不行的。</p></li></ul><h2 id="LGPL（GNU-Lesser-General-Public-License）宽松公共许可证"><a href="#LGPL（GNU-Lesser-General-Public-License）宽松公共许可证" class="headerlink" title="LGPL（GNU Lesser General Public License）宽松公共许可证"></a>LGPL（GNU Lesser General Public License）宽松公共许可证</h2><ul><li><p>LGPL是GPL的一个为主要为类库使用设计的开源协议。和GPL要求任何使用&#x2F;修改&#x2F;衍生之GPL类库的的软件必须采用GPL协议不同。LGPL允许商业软件通过类库引用(link)方式使用LGPL类库而不需要开源商业软件的代码。这使得采用LGPL协议的开源代码可以被商业软件作为类库引用并发布和销售。</p></li><li><p>但是如果修改LGPL协议的代码或者衍生，则所有修改的代码，涉及修改部分的额外代码和衍生的代码都必须采用LGPL协议。因此LGPL协议的开源代码很适合作为第三方类库被商业软件引用，但不适合希望以LGPL协议代码为基础，通过修改和衍生的方式做二次开发的商业软件采用。</p></li><li><p>GPL&#x2F;LGPL都保障原作者的知识产权，避免有人利用开源代码复制并开发类似的产品</p></li></ul><h2 id="AGPL-协议（Affero-General-Public-License）"><a href="#AGPL-协议（Affero-General-Public-License）" class="headerlink" title="AGPL 协议（Affero General Public License）"></a>AGPL 协议（Affero General Public License）</h2><ul><li><p>GPL（2.x ~ 3.x） 协议还有一个非常大的“漏洞”，就是软件“发布” 才必须开源。也就是说，我的软件不发布，即使使用 GPL (2.x ~ 3.x) 也可以不用开源。随着以Google为代表的软件作为服务的互联网公司的兴起，它们的“不分发软件，为客户提供网络服务”的商业模式就不受GPL协议的约束</p></li><li><p>AGPL则增加了对此做法的约束： AGPL &#x3D; GPL + 一条限制</p></li><li><p>一条限制：如果使用AGPL许可的软件与用户通过网络进行交互，也需要提供源代码给用户，所有的修改也要给用户。</p></li></ul><h2 id="MIT（MIT）"><a href="#MIT（MIT）" class="headerlink" title="MIT（MIT）"></a>MIT（MIT）</h2><ul><li><p>MIT是和BSD一样宽范的许可协议,作者只想保留版权,而无任何其他了限制.也就是说,你必须在你的发行版里包含原许可协议的声明,无论你是以二进制发布的还是以源代码发布的.</p></li><li><p>被授权人有权利使用、复制、修改、合并、出版发行、散布、再授权及贩售软体及软体的副本。</p></li><li><p>被授权人可根据程式的需要修改授权条款为适当的内容。</p></li><li><p>在软件和软件的所有副本中都必须包含版权声明和许可声明</p></li></ul><h2 id="Zlib-x2F-Libpng协议"><a href="#Zlib-x2F-Libpng协议" class="headerlink" title="Zlib&#x2F;Libpng协议"></a>Zlib&#x2F;Libpng协议</h2><p>  基于该软件的原样使用，作者不负责使用该软件照成的任何损失。</p><p>  该软件修改后的版本将受到以下限制：</p><ul><li><p>不能歪曲原软件的著作权</p></li><li><p>修改后的软件不能歪曲为原版软件</p></li><li><p>不能删除源码中的协议许可内容</p><p>如果发布二进制代码可以不用附上源代码。</p></li></ul><h2 id="MPL（The-Mozilla-Public-License）Mozilla公共许可证"><a href="#MPL（The-Mozilla-Public-License）Mozilla公共许可证" class="headerlink" title="MPL（The Mozilla Public License）Mozilla公共许可证"></a>MPL（The Mozilla Public License）Mozilla公共许可证</h2><ul><li><p>MPL是The Mozilla Public License的简写，是1998年初Netscape的 Mozilla小组为其开源软件项目设计的软件许可证。MPL许可证出现的最重要原因就是，Netscape公司认为GPL许可证没有很好地平衡开发者对源代码的需求和他们利用源代码获得的利益。同著名的GPL许可证和BSD许可证相比，MPL在许多权利与义务的约定方面与它们相同（因为都是符合OSIA 认定的开源软件许可证）。但是，相比而言MPL还有以下几个显著的不同之处:</p></li><li><p>MPL虽然要求对于经MPL许可证发布的源代码的修改也要以MPL许可证的方式再许可出来，以保证其他人可以在MPL的条款下共享源代码。但是，在MPL 许可证中对“发布”的定义是“以源代码方式发布的文件”，这就意味着MPL允许一个企业在自己已有的源代码库上加一个接口，除了接口程序的源代码以MPL许可证的形式对外许可外，源代码库中的源代码就可以不用MPL许可证的方式强制对外许可。这些，就为借鉴别人的源代码用做自己商业软件开发的行为留了一个豁口。</p></li><li><p>MPL许可证第三条第7款中允许被许可人将经过MPL许可证获得的源代码同自己其他类型的代码混合得到自己的软件程序。</p></li><li><p>对软件专利的态度，MPL许可证不像GPL许可证那样明确表示反对软件专利，但是却明确要求源代码的提供者不能提供已经受专利保护的源代码（除非他本人是专利权人，并书面向公众免费许可这些源代码），也不能在将这些源代码以开放源代码许可证形式许可后再去申请与这些源代码有关的专利。</p></li><li><p>对源代码的定义<br>而在MPL（1.1版本）许可证中，对源代码的定义是:“源代码指的是对作品进行修改最优先择取的形式，它包括:所有模块的所有源程序，加上有关的接口的定义，加上控制可执行作品的安装和编译的‘原本’（原文为‘Script’），或者不是与初始源代码显著不同的源代码就是被源代码贡献者选择的从公共领域可以得到的程序代码。”</p></li><li><p>MPL许可证第3条有专门的一款是关于对源代码修改进行描述的规定，就是要求所有再发布者都得有一个专门的文件就对源代码程序修改的时间和修改的方式有描述。</p><p><strong>MPL与其他协议的兼容性</strong></p><p>不像那些较严格的Copyleft许可证，使用MPL授权的源代码可以在一个复杂的软件中与任何其他的许可协议相结合，只要仍满足MPL许可协议中3.3节的规定即可。这意味着在一份给定的源文件里面，必须全部的源代码都以MPL授权，否则就所有源代码均以其他方式授权。</p><p>MPL第二版与Apache许可证以及GPL第二版或更新、LGPL2.1版或更新，及AGPL第三版或更新兼容。而1.1版因为有“一些复杂的限制”造成与GPL的不兼容（从而阻止升级到MPL 2.0）。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开源协议 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.Net定时任务框架</title>
      <link href="/2022/08/06/Net%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%A1%86%E6%9E%B6/"/>
      <url>/2022/08/06/Net%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="FluentScheduler"><a href="#FluentScheduler" class="headerlink" title="FluentScheduler"></a><a href="https://github.com/fluentscheduler/FluentScheduler">FluentScheduler</a></h2><p>FluentScheduler是由一位巴西的.NET开发者Talles L开发并维护的.NET平台下的一款自动定时任务调度器组件，它提供了比较丰富的定时任务调度接口，开发者可以快速方便地通过接口设置调度时间，比如：间隔1秒,2秒…n秒，只执行一次，哪月的哪一天等等。具体请参考我之前写过的两篇关于FluentScheduler的文章：</p><ul><li><p><a href="https://codedefault.com/p/c-sharp-asp-net-task-timer-fluentscheduler">《推荐一个简单、轻量、功能非常强大的C#&#x2F;ASP.NET定时任务执行管理器组件—FluentScheduler》</a></p></li><li><p><a href="http://codedefault.com/2014/c-sharp-library-fluentscheduler-demo">《简单、轻量、功能非常强大的C#&#x2F;ASP.NET定时调度任务执行管理组件–FluentScheduler之实例篇》</a></p></li><li><p>官方地址: <a href="https://github.com/fluentscheduler/FluentScheduler">https://github.com/fluentscheduler/FluentScheduler</a></p></li><li><p>特性</p><ul><li>提供丰富的任务调度接口，配置方便</li></ul></li></ul><h2 id="TaskScheduler"><a href="#TaskScheduler" class="headerlink" title="TaskScheduler"></a><a href="https://github.com/dahall/TaskScheduler">TaskScheduler</a></h2><p>TaskScheduler是一个为Windows任务调度程序提供.NET的封装组件，可以代替Windows操作系统自带的定时任务使用，提供了代码和编辑器两种方式创建定时任务。它聚合了多个版本，并提供编辑调度编辑器以快速创建定时任务。<br>官方地址: <a href="https://github.com/dahall/TaskScheduler">https://github.com/dahall/TaskScheduler</a><br>特性</p><ul><li>支持.NET的多个版本(.NET 2.0, 3.5, 4.0, 4.52 and .NET Standard 2.0.)</li><li>支持包括脚本语言在内的所有.NET语言，比如(PowerShell)</li><li>支持所有的V2本地化属性，甚至在V1的系统中</li><li>支持序列化成XML</li><li>支持目标版本的任务验证</li><li>支持Cron表达式触发器</li><li>提供可视化的定时任务调度编辑器</li><li>提供动作编辑器，触发器编辑器，事件查看器，任务执行历史查看器等对话框</li></ul><h2 id="Gofer-NET"><a href="#Gofer-NET" class="headerlink" title="Gofer.NET"></a><a href="http://gofer.net/">Gofer.NET</a></h2><p><a href="http://gofer.net/">http://Gofer.NET</a>是支持分布式的任务&#x2F;作业调度组件，可以运行在.NET Core应用程序中。</p><p>官方地址: <a href="https://github.com/brthor/Gofer.NET">https://github.com/brthor/Gofer.NET</a></p><p>特性</p><ul><li><p>使用通用表达式语法将作业添加到队列并执行</p></li><li><p>可简单地通过添加新节点来扩展任务工作池</p></li><li><p>在Redis的支持下，所有的任务都被持久化</p><p>Coravel</p><p>Coravel是一个零配置的基于.NET标准库的微组件，它包含了定时任务调度，缓存，队列，事件广播等等功能。</p><p>官方地址: <a href="https://docs.coravel.net/Scheduler/">https://docs.coravel.net/Scheduler/</a></p></li><li><p>简单，优雅，流畅的代码书写方式创建定时任务</p></li><li><p>基于.NET标准库，跨平台</p></li><li><p>丰富的调度接口</p></li><li><p>支持Cron表达式</p></li><li><p>支持全局错误处理</p></li></ul><h2 id="Quartz-NET"><a href="#Quartz-NET" class="headerlink" title="Quartz.NET"></a><a href="https://www.quartz-scheduler.net/">Quartz.NET</a></h2><p><strong>Quartz.NET</strong> 是一个开源的定时作业调度项目，旨在创建一个免费商业使用的作业调度器，同时具有“企业级”的特性。<a href="http://quartz.net目前的版本是支持跨平台的,即支持.net和.net/">http://Quartz.NET目前的版本是支持跨平台的，即支持.NET和.NET</a> Core的应用程序。</p><p>官方地址: <a href="http://www.quartz-scheduler.net/">http://www.quartz-scheduler.net/</a></p><p>特性</p><ul><li><p>API 操作简单，只要几行简单的代码你就可以在应用程序里面实现自己的作业调度，并实时监视作业执行情况</p></li><li><p>触发器功能强大，比 Windows 的任务计划提供更细的触发粒度</p></li><li><p>良好的可扩展性，它基于接口编程，你可以实现自己的 Schedule 调度器，Job 作业，以及 Trigger 触发器等</p></li><li><p>持久化，作业可以保存在内存中，也可以持久化到数据库，支持多种数据库类型：SqlServer、Oracle、MySql等</p></li><li><p>分布式和集群，这是一个高级应用，可以在多台计算机之间创建负载平衡、容错处理</p></li><li><p>支持Cron表达式</p></li><li><p>支持以配置文件的方式定制作业调度</p><p>具体使用可参考《基于ASP.NET MVC（C#）和Quartz.Net组件实现的定时执行任务调度》</p></li></ul><h2 id="Hangfire"><a href="#Hangfire" class="headerlink" title="Hangfire"></a><a href="https://www.hangfire.io/">Hangfire</a></h2><p>Hangfire是一个支持.NET和.NET Core应用程序的跨平台的后台作业处理框架，使用Hangfire时不再需要Windows服务或者单独的进程。Hangfire可以在<a href="http://asp.net/ASP.NET">http://ASP.NET/ASP.NET</a> Core等应用程序中以简单的方式实现触发，延迟以及定时执行等任务。同时还支持CPU和I&#x2F;O密集型、长时间运行和短时间运行的作业而不需要设置Windows服务或者其他的任务调度。Hangfire支持多种数据存储方式，如：Redis, SQL Server, SQL Azure和MSMQ等。</p><p>官方地址: <a href="https://www.hangfire.io/">https://www.hangfire.io</a></p><p>特性</p><ul><li>安装简单，快速入门：没有Windows服务，没有Windows调度程序，不需要单独的应用程序</li><li>可持久化：后台作业是在存储中持久存储介质中的，如:SQL Server、Redis、PostgreSQL、MongoDB等</li><li>作业数据透明：内置的web界面允许您查看后台作业的整体情况，以及观察每个后台作业的状态</li><li>可靠：后台作业一旦无异常地被创建，Hangfire负责至少处理一次这个作业</li><li>分布式：后台方法调用及其参数是序列化的，因此可以克服进程边界问题</li><li>可扩展：作业过滤器允许您以类似于<a href="http://asp.net/">http://ASP.NET</a> MVC操作过滤器的方式向后台处理添加自定义功能</li><li>高效：尽管默认安装使用SQL Server和轮询来获取作业，但可以利用MSMQ或Redis扩展来将处理延迟降低到最低</li><li>自维护：你不需要手动维护和清理存储空间，Hangfire会尽可能地自动清理旧的数据</li><li>开源免费：Hangfire是开源的框架并且对商用免费，只需遵循LGPLv3许可即可</li></ul><h2 id="TimedJob-x2F-Ding-TimedJob-小框架"><a href="#TimedJob-x2F-Ding-TimedJob-小框架" class="headerlink" title="TimedJob&#x2F;Ding.TimedJob(小框架)"></a>TimedJob&#x2F;Ding.TimedJob(小框架)</h2>]]></content>
      
      
      <categories>
          
          <category> .Net开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 框架 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>知识库相关开源项目</title>
      <link href="/2022/08/06/%E7%9F%A5%E8%AF%86%E5%BA%93%E7%9B%B8%E5%85%B3%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
      <url>/2022/08/06/%E7%9F%A5%E8%AF%86%E5%BA%93%E7%9B%B8%E5%85%B3%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="知识库相关开源项目"><a href="#知识库相关开源项目" class="headerlink" title="知识库相关开源项目"></a>知识库相关开源项目</h2><h3 id="开源Wiki类"><a href="#开源Wiki类" class="headerlink" title="开源Wiki类"></a>开源Wiki类</h3><table><thead><tr><th>名称</th><th>国内&#x2F;国外</th><th>开源地址&#x2F;官网地址</th><th>开发语言、技术栈</th><th>开源协议</th></tr></thead><tbody><tr><td>XWiki</td><td>国外</td><td><a href="http://www.xwiki.org/xwiki/bin/view/Main/WebHome">XWiki - The Advanced Open Source Enterprise and Application Wiki (XWiki.org)</a></td><td>Java，Html，JS</td><td>LGPL-2.1</td></tr><tr><td>WikiJs</td><td>国外</td><td><a href="https://js.wiki/">Wiki.js</a></td><td>NodeJS，Html，JS</td><td>AGPL-3.0</td></tr><tr><td>JSPWiki</td><td>国外</td><td><a href="https://jspwiki.apache.org/">Apache JSPWiki</a></td><td>Java，servlets，JSP</td><td>Apache-2.0</td></tr><tr><td>Dokuwiki</td><td>国外</td><td><a href="https://www.dokuwiki.org/dokuwiki">dokuwiki [DokuWiki]</a></td><td>PHP，Js，Html</td><td>GPL-2.0</td></tr><tr><td>MediaWiki</td><td>国外</td><td><a href="https://www.mediawiki.org/">https://www.mediawiki.org/</a></td><td>PHP，Js，Html</td><td>GPL-2.0</td></tr><tr><td>MM-Wiki</td><td>国内</td><td><a href="https://github.com/phachon/mm-wiki">phachon&#x2F;mm-wiki: MM-Wiki一个轻量级的企业知识分享与团队协同软件，可用于快速构建企业Wiki和团队知识分享平台。部署方便，使用简单，帮助团队构建一个信息共享、文档管理的协作环境。(github.com)</a></td><td>Golang，Html，JS</td><td>MIT</td></tr><tr><td>MrDoc(觅思文档)</td><td>国内</td><td><a href="https://www.mrdoc.pro/">觅思文档MrDoc -私有云笔记、云文档和知识库系统</a></td><td>Python3+Django，Html，JS</td><td>GPL-3.0</td></tr><tr><td>zyplayer-doc</td><td>国内</td><td><a href="https://gitee.com/zyplayer/zyplayer-doc">zyplayer-doc: zyplayer-doc是一款在线文档工具，现有数据库文档、WIKI文档、Swagger接口文档、OpenApi接口文档、Dubbo文档(gitee.com)</a></td><td>Java，JS，vue，Html</td><td>Apache-2.0</td></tr><tr><td>MiniWiki</td><td>国内</td><td><a href="https://github.com/mindoc-org/mindoc">mindoc-org&#x2F;mindoc: Golang实现的基于beego框架的接口在线文档管理系统(github.com)</a></td><td>Golang，Smarty， beego</td><td>Apache-2.0</td></tr><tr><td>Wizard</td><td>国内</td><td><a href="https://github.com/mylxsw/wizard">mylxsw&#x2F;wizard: Wizard是一款开源的文档管理工具，支持Markdown&#x2F;Swagger&#x2F;Table类型的文档。(github.com)</a></td><td>PHP，Blade，Vue</td><td>Apache-2.0</td></tr></tbody></table><p><strong>开源论坛问答类</strong></p><table><thead><tr><th>名称</th><th>国内&#x2F;外</th><th>开源地址&#x2F;官网地址</th><th>开发语言、技术栈</th><th>开源协议</th></tr></thead><tbody><tr><td>NodeBB</td><td>国外</td><td><a href="https://github.com/NodeBB/NodeBB">NodeBB&#x2F;NodeBB: Node.js based forum software built for the modern web (github.com)</a></td><td>Js,Smarty</td><td>GPL-3</td></tr><tr><td>Discuz(X&#x2F;Q)</td><td>国内</td><td><a href="https://discuz.com/">Discuz! Q -再小众，也有圈子-开源的PHP内容付费轻社区</a></td><td>PHP，Vue，JS</td><td>Apache-2.0</td></tr><tr><td>Flarum</td><td>国外</td><td><a href="https://github.com/flarum/flarum">flarum&#x2F;flarum: Simple forum software for building great communities. (github.com)</a></td><td>PHP，Html，JS</td><td>MIT</td></tr><tr><td>MlTree Forum</td><td>国内</td><td><a href="https://github.com/mltreegroup/MlTree-Forum">mltreegroup&#x2F;MlTree-Forum: MlTree Forum是一款由Thinkphp构建、Material Design风格的轻论坛。(github.com)</a></td><td>PHP，Html，JS</td><td>Apache-2.0</td></tr><tr><td>MDClub</td><td>国内</td><td><a href="https://www.mdclub.org/">MDClub -开源Material Design样式的社区,论坛系统</a> <a href="https://github.com/zdhxiong/mdclub">zdhxiong&#x2F;mdclub: MDClub社区系统后端代码(github.com)</a></td><td>PHP，Hack</td><td>MIT</td></tr></tbody></table><h3 id="开源在线学习类"><a href="#开源在线学习类" class="headerlink" title="开源在线学习类"></a>开源在线学习类</h3><table><thead><tr><th>名称</th><th>国内&#x2F;外</th><th>开源地址&#x2F;官网地址</th><th>开发语言、技术栈</th><th>开源协议</th></tr></thead><tbody><tr><td>智慧云智能教育平台</td><td>国内</td><td><a href="https://gitee.com/zhuimengshaonian/wisdom-education#%E6%99%BA%E6%85%A7%E4%BA%91%E6%99%BA%E8%83%BD%E6%95%99%E8%82%B2%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0">wisdom-education:基于SpringBoot + Mybatis Plus + Shiro + mysql + redis构建的智慧云智能教育平台。架构上使用完全前后端分离。支持多种题型：选择题、多选题、判断题、填空题、综合题以及数学公式。支持在线考试，教师在线批改试卷。(gitee.com)</a></td><td>Java，FreeMarker，Html</td><td>Apache-2.0</td></tr><tr><td>学之思开源考试系统 - Mysql版</td><td>国内</td><td><a href="https://github.com/mindskip/xzs-mysql">mindskip&#x2F;xzs-mysql:学之思开源考试系统是一款java + vue的前后端分离的考试系统。主要优点是开发、部署简单快捷、界面设计友好、代码结构清晰。支持web端和微信小程序，能覆盖到pc机和手机等设备。支持多种部署方式：集成部署、前后端分离部署、docker部署。(github.com)</a></td><td>JS，Java，Vue，Html</td><td>AGPL-3.0</td></tr><tr><td>领课教育系统</td><td>国内</td><td><a href="https://gitee.com/roncoocom/roncoo-education">roncoo-education:领课教育系统（roncoo-education）是基于领课网络多年的在线教育平台开发和运营经验打造出来的产品，致力于打造一个各行业都适用的分布式在线教育系统。系统采用前后端分离模式，前台采用vue.js为核心框架，后台采用Spring Cloud为核心框架。系统目前主要功能有课程点播功能，支持多家视频云的接入，课程附件管理功能，支持多家存储云的接入，讲师管理功能，支持讲师入驻功能，可以帮助个人或者企业快速搭建一个轻量级的在线教育平台。(gitee.com)</a></td><td>Java</td><td>MIT</td></tr></tbody></table><h3 id="开源-对象-x2F-文件-（分布式）存储系统"><a href="#开源-对象-x2F-文件-（分布式）存储系统" class="headerlink" title="开源 对象&#x2F;文件 （分布式）存储系统"></a>开源 对象&#x2F;文件 （分布式）存储系统</h3><table><thead><tr><th>名称</th><th>开源地址&#x2F;官网地址</th><th>开发语言、技术栈</th><th>开源协议</th></tr></thead><tbody><tr><td>seaweedfs</td><td><a href="https://github.com/chrislusf/seaweedfs">chrislusf&#x2F;seaweedfs: SeaweedFS is a fast distributed storage system for blobs, objects, files, and data lake, for billions of files! Blob store has O(1) disk seek, cloud tiering. Filer supports Cloud Drive, cross-DC active-active replication, Kubernetes, POSIX FUSE mount, S3 API, S3 Gateway, Hadoop, WebDAV, encryption, Erasure Coding. (github.com)</a></td><td>Golang,Java</td><td>Apache-2.0</td></tr><tr><td>minio</td><td><a href="http://www.minio.org.cn/integrations.shtml">MinIO产品集成</a>(官网) <a href="https://github.com/minio/minio">minio&#x2F;minio: High Performance, Kubernetes Native Object Storage (github.com)</a></td><td>Golang</td><td>AGPL-3.0</td></tr><tr><td>Alluxio</td><td><a href="https://www.alluxio.io/">Alluxio - Data Orchestration for the Cloud</a>(官网) <a href="https://github.com/Alluxio/alluxio">Alluxio&#x2F;alluxio：Alluxio，用于云中分析和机器学习的数据编排 (github.com)</a></td><td>Java</td><td>Apache-2.0</td></tr><tr><td>curve</td><td><a href="https://github.com/opencurve/curve">opencurve&#x2F;curve: Curve is a better-used cloud-native SDS storage system, featured with high performance, easy operation, cloud native. Curve is composed with CurveBS and CurveFS based on Raft. (github.com)</a></td><td>C++</td><td>Apache-2.0</td></tr><tr><td>Swift</td><td><a href="https://docs.openstack.org/swift/latest/">Welcome to Swift’s documentation! — Swift 2.30.0.dev28 documentation (openstack.org)</a>(官网) <a href="https://github.com/openstack/swift">openstack&#x2F;swift: OpenStack Storage (Swift). Mirror of code maintained at opendev.org. (github.com)</a></td><td>Python</td><td>Apache-2.0</td></tr><tr><td>ceph</td><td><a href="https://ceph.com/en/">Ceph.io — Home</a> <a href="https://github.com/ceph/ceph">ceph&#x2F;ceph: Ceph is a distributed object, block, and file storage platform (github.com)</a></td><td>C++,Python,Raku,C,TypeStript</td><td>BSD3&#x2F;MIT&#x2F;GPL3&#x2F;LGPL2&#x2F;Apache2.0</td></tr><tr><td>juicefs</td><td><a href="https://github.com/juicedata/juicefs">juicedata&#x2F;juicefs: JuiceFS is a distributed POSIX file system built on top of Redis and S3. (github.com)</a></td><td>Golang,Java</td><td>Apache-2.0</td></tr><tr><td>FastDFS</td><td><a href="https://gitee.com/fastdfs100/fastdfs#https://gitee.com/fastdfs100/FastCFS">FastDFS: FastDFS是一款轻量级的开源分布式文件系统，功能包括：文件存储、文件同步、文件上传、文件下载等，解决了文件大容量存储和高性能访问问题。特别适合以文件为载体的在线服务，如图片、视频、文档服务等等。FastDFS相关文章请搜索微信公众号：fastdfs (gitee.com)</a></td><td>C</td><td>GPL-3.0</td></tr><tr><td>FastCFS</td><td><a href="https://gitee.com/fastdfs100/FastCFS">FastCFS: FastCFS是一款支持百亿级海量文件的高性能通用分布式文件系统 ，可以作为数据库（MySQL、PostgresSQL、Oracle等）、k8s、KVM和NAS等系统的后端存储。 (gitee.com)</a></td><td>C</td><td>AGPL-3.0</td></tr><tr><td>TFS</td><td><a href="https://github.com/alibaba/tfs">alibaba&#x2F;tfs：TFS（淘宝文件系统）是一个类似于 GFS 的分布式文件系统。 (github.com)</a></td><td>C++</td><td>GPL-2.0</td></tr><tr><td>ambry</td><td><a href="https://github.com/linkedin/ambry">linkedin&#x2F;ambry: Distributed object store (github.com)</a></td><td>Java</td><td>Apache-2.0</td></tr><tr><td>moosefs</td><td><a href="https://moosefs.com/">MooseFS Distributed File System – the best Open Source SDS</a> <a href="https://github.com/moosefs/moosefs">moosefs&#x2F;moosefs: MooseFS – Open Source, Petabyte, Fault-Tolerant, Highly Performing, Scalable Network Distributed File System (Software-Defined Storage) (github.com)</a></td><td>C,Makefile,Shell</td><td>GPL-2.0</td></tr><tr><td>glusterfs</td><td><a href="https://www.gluster.org/">Gluster</a> <a href="https://github.com/gluster/glusterfs">gluster&#x2F;glusterfs: Gluster Filesystem : Build your distributed storage in minutes (github.com)</a></td><td>C,Python,Shell</td><td>GPL-2.0</td></tr></tbody></table><h3 id="开源富文本编辑器"><a href="#开源富文本编辑器" class="headerlink" title="开源富文本编辑器"></a>开源富文本编辑器</h3><table><thead><tr><th>名称</th><th>开源地址&#x2F;官网地址</th><th>开源协议</th></tr></thead><tbody><tr><td>Tiptap</td><td><a href="https://tiptap.dev/">Headless WYSIWYG Text Editor–Tiptap Editor</a>(官网) <a href="https://github.com/ueberdosis/tiptap">ueberdosis&#x2F;tiptap: The headless editor framework for web artisans. (github.com)</a></td><td>MIT</td></tr><tr><td>Tinymce</td><td><a href="https://www.tiny.cloud/">The Most Advanced WYSIWYG HTML Editor | Trusted Rich Text Editor | TinyMCE</a>(官网) <a href="https://github.com/tinymce/tinymce">tinymce&#x2F;tinymce: The world’s #1 JavaScript library for rich text editing. Available for React, Vue and Angular (github.com)</a></td><td>MIT</td></tr><tr><td>Quill</td><td><a href="https://quilljs.com/">Quill - Your powerful rich text editor (quilljs.com)</a> <a href="https://github.com/quilljs/quill/">https://github.com/quilljs/quill/</a></td><td>BSD-3</td></tr><tr><td>vue-quill-editor</td><td><a href="https://www.kancloud.cn/liuwave/quill/1434140">vue-quill-editor·Quill官方中文文档·看云(kancloud.cn)</a></td><td>BSD-3</td></tr><tr><td>Summernote</td><td><a href="https://summernote.org/">Summernote - Super Simple WYSIWYG editor</a>(官网) <a href="https://github.com/summernote/summernote/">summernote&#x2F;summernote: Super simple WYSIWYG editor (github.com)</a></td><td>MIT</td></tr><tr><td>Ueditor</td><td><a href="https://github.com/fex-team/ueditor">fex-team&#x2F;ueditor: rich text 富文本编辑器 (github.com)</a></td><td>MIT</td></tr><tr><td>vue-ueditor</td><td><a href="https://github.com/HaoChuan9421/vue-ueditor-wrap">haochuan9421&#x2F;vue-ueditor-wrap:</a></td><td>MIT</td></tr><tr><td>wangEditor5</td><td><a href="https://www.wangeditor.com/">wangEditor</a>(官网) <a href="https://github.com/wangeditor-team/wangEditor/">wangeditor-team&#x2F;wangEditor: wangEditor——开源Web富文本编辑器(github.com)</a></td><td>MIT</td></tr><tr><td>simditor</td><td><a href="https://simditor.tower.im/">Simditor (tower.im)</a> <a href="https://github.com/mycolorway/simditor">mycolorway&#x2F;simditor: An Easy and Fast WYSIWYG Editor (github.com)</a></td><td>MIT</td></tr><tr><td>jodit V.3</td><td><a href="https://xdsoft.net/jodit/">Jodit Editor v.3 (xdsoft.net)</a> <a href="https://github.com/xdan/jodit">xdan&#x2F;jodit: Jodit - Best WYSIWYG Editor for You (github.com)</a></td><td>MIT</td></tr></tbody></table><h3 id="开源Markdown编辑器"><a href="#开源Markdown编辑器" class="headerlink" title="开源Markdown编辑器"></a>开源Markdown编辑器</h3><table><thead><tr><th>名称</th><th>开源地址&#x2F;官网地址</th><th>开源协议</th></tr></thead><tbody><tr><td>Editor.md</td><td><a href="https://pandao.github.io/editor.md/">Editor.md -开源在线Markdown编辑器(pandao.github.io)</a> <a href="https://github.com/pandao/editor.md">pandao&#x2F;editor.md: The open source embeddable online markdown editor (component). (github.com)</a></td><td>MIT</td></tr><tr><td>vue-markdown</td><td><a href="https://github.com/zhaoxuhui1122/vue-markdown">zhaoxuhui1122&#x2F;vue-markdown:一款使用marked和highlight.js开发的一款markdown编辑器(github.com)</a></td><td>MIT</td></tr><tr><td>mavonEditor</td><td><a href="https://github.com/hinesboy/mavonEditor">hinesboy&#x2F;mavonEditor: mavonEditor - A markdown editor based on Vue that supports a variety of personalized features (github.com)</a></td><td>MIT</td></tr><tr><td>md-editor-v3</td><td><a href="https://github.com/imzbf/md-editor-v3/blob/dev/README-CN.md">md-editor-v3&#x2F;README-CN.md at dev·imzbf&#x2F;md-editor-v3 (github.com)</a></td><td>MIT</td></tr><tr><td>bytemd</td><td><a href="https://github.com/bytedance/bytemd">bytedance&#x2F;bytemd: A hackable Markdown editor component (github.com)</a></td><td>MIT</td></tr></tbody></table><h3 id="开源Html渲染数学公式库"><a href="#开源Html渲染数学公式库" class="headerlink" title="开源Html渲染数学公式库"></a>开源Html渲染数学公式库</h3><table><thead><tr><th>名称</th><th>开源地址&#x2F;官网地址</th><th>开源协议</th></tr></thead><tbody><tr><td>Katex</td><td><a href="https://katex.org/">KaTeX–The fastest math typesetting library for the web</a> <a href="https://github.com/KaTeX/KaTeX">KaTeX&#x2F;KaTeX: Fast math typesetting for the web. (github.com)</a></td><td>MIT</td></tr><tr><td>AsciiMath</td><td><a href="http://asciimath.org/#gettingStarted">AsciiMath</a></td><td>MIT</td></tr><tr><td>MathJax</td><td><a href="https://www.mathjax.org/">MathJax | Beautiful math in all browsers.</a> <a href="https://github.com/mathjax/MathJax-src">https://github.com/mathjax/MathJax-src</a></td><td>Apache-2.0</td></tr></tbody></table><h3 id="开源搜索引擎库"><a href="#开源搜索引擎库" class="headerlink" title="开源搜索引擎库"></a>开源搜索引擎库</h3><table><thead><tr><th>名称</th><th>开源地址&#x2F;官网地址</th><th>开发语言</th><th>开源协议</th></tr></thead><tbody><tr><td><a href="https://github.com/meilisearch/meilisearch">meilisearch</a></td><td><a href="https://www.meilisearch.com/pricing">Meilisearch | Pricing</a> <a href="https://github.com/meilisearch/MeiliSearch">meilisearch&#x2F;meilisearch: Powerful, fast, and an easy to use search engine (github.com)</a></td><td>Rust</td><td>MIT</td></tr><tr><td><a href="https://www.elastic.co/elasticsearch/">Elasticsearch</a></td><td><a href="https://github.com/elastic/elasticsearch">elastic&#x2F;elasticsearch: Free and Open, Distributed, RESTful Search Engine (github.com)</a></td><td>Java</td><td>SSPL&#x2F;Apache2.0</td></tr><tr><td>Lucene</td><td><a href="https://lucene.apache.org/">Apache Lucene - Welcome to Apache Lucene</a>(官网) <a href="https://gitbox.apache.org/repos/asf?p=lucene.git">ASF Git Repos - lucene.git&#x2F;summary (apache.org)</a> <a href="https://github.com/apache/lucene">apache&#x2F;lucene: Apache Lucene open-source search software (github.com)</a></td><td>Java</td><td>Apache-2.0</td></tr><tr><td>ApacheSolr</td><td><a href="https://solr.apache.org/downloads.html">Solr Downloads - Apache Solr</a>(官网) <a href="https://gitbox.apache.org/repos/asf?p=solr.git">ASF Git Repos - solr.git&#x2F;summary (apache.org)</a> <a href="https://github.com/apache/solr">apache&#x2F;solr: Apache Solr open-source search software (github.com)</a></td><td>Java</td><td>Apache-2.0</td></tr><tr><td>Sphinx</td><td><a href="http://sphinxsearch.com/">Sphinx | Open Source Search Engine (sphinxsearch.com)</a> <a href="https://github.com/sphinxsearch/sphinx/">sphinxsearch&#x2F;sphinx: Sphinx search server (github.com)</a></td><td>C++</td><td>GPL-2.0</td></tr></tbody></table><h3 id="开源文件预览方案"><a href="#开源文件预览方案" class="headerlink" title="开源文件预览方案"></a>开源文件预览方案</h3><table><thead><tr><th>名称</th><th>开源地址&#x2F;官网地址</th><th>开发语言</th><th>开源协议</th></tr></thead><tbody><tr><td>kkfileview</td><td><a href="https://kkfileview.keking.cn/zh-cn/index.html">kkFileView - 在线文件预览 (keking.cn)</a>（官网） <a href="https://gitee.com/kekingcn/file-online-preview">kkFileView: 使用spring boot打造文件文档在线预览项目解决方案，支持doc、docx、ppt、pptx、xls、xlsx、zip、rar、mp4、mp3以及众多类文本如txt、html、xml、java、properties、sql、js、md、json、conf、ini、vue、php、py、bat、gitignore等文件在线预览 (gitee.com)</a></td><td>Java</td><td>Apache-2.0</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 开源项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 知识库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Neo4j脚本</title>
      <link href="/2022/07/19/Neo4J%E8%84%9A%E6%9C%AC/"/>
      <url>/2022/07/19/Neo4J%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h3 id="规范标准及CCS分类"><a href="#规范标准及CCS分类" class="headerlink" title="规范标准及CCS分类"></a>规范标准及CCS分类</h3><h4 id="导入StradardDoc节点"><a href="#导入StradardDoc节点" class="headerlink" title="导入StradardDoc节点"></a>导入StradardDoc节点</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///NewStandardDocument.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入StradardDoc节点-（水利部分）"><a href="#导入StradardDoc节点-（水利部分）" class="headerlink" title="导入StradardDoc节点 （水利部分）"></a>导入StradardDoc节点 （水利部分）</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///StandardDocument_shuili.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入CCS下的节点及层级关系"><a href="#导入CCS下的节点及层级关系" class="headerlink" title="导入CCS下的节点及层级关系"></a>导入CCS下的节点及层级关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS <span class="token keyword">FROM</span> <span class="token string">"file:///CCS_All.csv"</span> <span class="token keyword">AS</span> <span class="token keyword">row</span>  <span class="token keyword">merge</span> <span class="token punctuation">(</span>f:CCS&#123;CCS_Code:<span class="token keyword">row</span><span class="token punctuation">.</span>from_CCS_Code<span class="token punctuation">,</span>CCS_Name:<span class="token keyword">row</span><span class="token punctuation">.</span>from_CCS_Name<span class="token punctuation">,</span>CCSType:<span class="token keyword">row</span><span class="token punctuation">.</span>from_CCSType&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span><span class="token keyword">to</span>:CCS&#123;CCS_Code:<span class="token keyword">row</span><span class="token punctuation">.</span>to_CCS_Code<span class="token punctuation">,</span>CCS_Name:<span class="token keyword">row</span><span class="token punctuation">.</span>to_CCS_Name<span class="token punctuation">,</span>CCSType:<span class="token keyword">row</span><span class="token punctuation">.</span>to_CCSType&#125;<span class="token punctuation">)</span><span class="token keyword">with</span> f<span class="token punctuation">,</span><span class="token keyword">to</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ff:CCS&#123;CCS_Code:f<span class="token punctuation">.</span>CCS_Code<span class="token punctuation">,</span>CCS_Name:f<span class="token punctuation">.</span>CCS_Name<span class="token punctuation">,</span>CCSType:f<span class="token punctuation">.</span>CCSType&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>tt:CCS&#123;CCS_Code:<span class="token keyword">to</span><span class="token punctuation">.</span>CCS_Code<span class="token punctuation">,</span>CCS_Name:<span class="token keyword">to</span><span class="token punctuation">.</span>CCS_Name<span class="token punctuation">,</span>CCSType:<span class="token keyword">to</span><span class="token punctuation">.</span>CCSType&#125;<span class="token punctuation">)</span>  <span class="token keyword">merge</span> <span class="token punctuation">(</span>ff<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:Contained<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据hasGBW-CCS-属性值-多个用-分隔-，创建StandardizingDocument-和-CCS-节点关系"><a href="#根据hasGBW-CCS-属性值-多个用-分隔-，创建StandardizingDocument-和-CCS-节点关系" class="headerlink" title="根据hasGBW_CCS 属性值(多个用|分隔)，创建StandardizingDocument 和 CCS 节点关系"></a>根据hasGBW_CCS 属性值(多个用|分隔)，创建StandardizingDocument 和 CCS 节点关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">with</span> s<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>hasGBW_CCS<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> ccsListunwind ccsList <span class="token keyword">as</span> ccsT<span class="token keyword">with</span> s<span class="token punctuation">,</span> ccsT<span class="token keyword">match</span> <span class="token punctuation">(</span>ccs:CCS<span class="token punctuation">)</span> <span class="token keyword">where</span> ccs<span class="token punctuation">.</span>CCS_Code<span class="token operator">=</span>ccsT<span class="token keyword">merge</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>中文分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ccs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="创建索引-采用官方自带中文分词器"><a href="#创建索引-采用官方自带中文分词器" class="headerlink" title="创建索引,采用官方自带中文分词器"></a>创建索引,采用官方自带中文分词器</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CALL</span> db<span class="token punctuation">.</span><span class="token keyword">index</span><span class="token punctuation">.</span>fulltext<span class="token punctuation">.</span>createNodeIndex<span class="token punctuation">(</span><span class="token string">"sd_hasNoAndnameCN"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"StandardizingDocument"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"hasNO"</span><span class="token punctuation">,</span> <span class="token string">"nameCN"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>&#123;analyzer: <span class="token string">"cjk"</span>&#125;<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="材料库"><a href="#材料库" class="headerlink" title="材料库"></a>材料库</h3><h4 id="导入材料库数据"><a href="#导入材料库数据" class="headerlink" title="导入材料库数据"></a>导入材料库数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Materials.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Material &#123;uuid: <span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>dataType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>dataType<span class="token punctuation">,</span>m<span class="token punctuation">.</span>typeUuid<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>cName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>clauseExplain<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>standardNos<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>picIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>videoIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入图片视频节点数据"><a href="#导入图片视频节点数据" class="headerlink" title="导入图片视频节点数据"></a>导入图片视频节点数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///MediaFiles.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:MediaFile&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>filePath<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span>f<span class="token punctuation">.</span>mediaType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>mediaType<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据材料库picIds和videoIds-多个用-分隔-，与媒体文件库建立关系"><a href="#根据材料库picIds和videoIds-多个用-分隔-，与媒体文件库建立关系" class="headerlink" title="根据材料库picIds和videoIds(多个用|分隔)，与媒体文件库建立关系"></a>根据材料库picIds和videoIds(多个用|分隔)，与媒体文件库建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Material<span class="token punctuation">)</span><span class="token keyword">with</span> m<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>picIds<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span><span class="token operator">+</span>split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>videoIds<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> mediaListunwind mediaList <span class="token keyword">as</span> mediaid<span class="token keyword">with</span> m<span class="token punctuation">,</span> mediaid<span class="token keyword">match</span> <span class="token punctuation">(</span>mf:MediaFile<span class="token punctuation">)</span> <span class="token keyword">where</span> mf<span class="token punctuation">.</span>uuid<span class="token operator">=</span>mediaid<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>包含文件<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>mf<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="材料库规范数据导入"><a href="#材料库规范数据导入" class="headerlink" title="材料库规范数据导入"></a>材料库规范数据导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///材料库用规范.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据材料库standardNos-与标准规范库创建关系"><a href="#根据材料库standardNos-与标准规范库创建关系" class="headerlink" title="根据材料库standardNos,与标准规范库创建关系"></a>根据材料库standardNos,与标准规范库创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Material&#123;dataType:<span class="token string">'1'</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">where</span> m<span class="token punctuation">.</span>standardNos <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token keyword">with</span> m<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>standardNos<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> standardNoListunwind standardNoList <span class="token keyword">as</span> standardNo<span class="token keyword">with</span> m<span class="token punctuation">,</span> standardNo<span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span> <span class="token keyword">where</span> s<span class="token punctuation">.</span>path <span class="token keyword">contains</span> standardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>涉及规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="媒体文件与材料节点关系表导入关系"><a href="#媒体文件与材料节点关系表导入关系" class="headerlink" title="媒体文件与材料节点关系表导入关系"></a>媒体文件与材料节点关系表导入关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///meidaFile&amp;material.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Material&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>Materialuuid&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>mf:MediaFile&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>MediaFileuuid&#125;<span class="token punctuation">)</span><span class="token keyword">with</span> m<span class="token punctuation">,</span>mf<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>包含文件<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>mf<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="材料上下级关系建立，根据uuid"><a href="#材料上下级关系建立，根据uuid" class="headerlink" title="材料上下级关系建立，根据uuid"></a>材料上下级关系建立，根据uuid</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Material<span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>r:Material<span class="token punctuation">)</span><span class="token keyword">where</span> r<span class="token punctuation">.</span>typeUuid <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>rp:Material<span class="token punctuation">)</span>     <span class="token keyword">where</span> rp<span class="token punctuation">.</span>uuid<span class="token operator">=</span>i<span class="token punctuation">.</span>typeUuid    <span class="token keyword">with</span> i<span class="token punctuation">,</span>rp    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>rp<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="材料创建全文检索-cName-explain"><a href="#材料创建全文检索-cName-explain" class="headerlink" title="材料创建全文检索_cName,explain"></a>材料创建全文检索_cName,explain</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CALL</span> db<span class="token punctuation">.</span><span class="token keyword">index</span><span class="token punctuation">.</span>fulltext<span class="token punctuation">.</span>createNodeIndex<span class="token punctuation">(</span><span class="token string">"Material_CName"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Material"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"cName"</span><span class="token punctuation">,</span> <span class="token string">"explain"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>&#123;analyzer: <span class="token string">"cjk"</span>&#125;<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="通用标准"><a href="#通用标准" class="headerlink" title="通用标准"></a>通用标准</h3><h4 id="通用标准信息-婚姻状态"><a href="#通用标准信息-婚姻状态" class="headerlink" title="通用标准信息-婚姻状态"></a>通用标准信息-婚姻状态</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///MaritalStatus.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:MaritalStatus &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>maritalStatus<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>MaritalStatus<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-民族"><a href="#通用标准信息-民族" class="headerlink" title="通用标准信息-民族"></a>通用标准信息-民族</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Nation.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Nation &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>romeName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>RomeName<span class="token punctuation">,</span>m<span class="token punctuation">.</span>letterCode<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>LetterCode<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-政治面貌"><a href="#通用标准信息-政治面貌" class="headerlink" title="通用标准信息-政治面貌"></a>通用标准信息-政治面貌</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///PoliticalStatus.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:PoliticalStatus &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>politicalStatus<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>PoliticalStatus<span class="token punctuation">,</span>m<span class="token punctuation">.</span>romeName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>RomeName<span class="token punctuation">,</span>m<span class="token punctuation">.</span>shortName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ShortName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ShortName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-宗教"><a href="#通用标准信息-宗教" class="headerlink" title="通用标准信息-宗教"></a>通用标准信息-宗教</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Religion.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Religion &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-性别"><a href="#通用标准信息-性别" class="headerlink" title="通用标准信息-性别"></a>通用标准信息-性别</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///Sex.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Sex &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>sexName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SexName<span class="token punctuation">,</span>m<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>SourceStandardNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-行政区划（先创建索引，之后再导）"><a href="#通用标准信息-行政区划（先创建索引，之后再导）" class="headerlink" title="通用标准信息-行政区划（先创建索引，之后再导）"></a>通用标准信息-行政区划（先创建索引，之后再导）</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Region<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///xzqh_Region.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Region &#123;id: <span class="token keyword">row</span><span class="token punctuation">.</span>region_id&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>parentId<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>parent_id <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>parent_id <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>code<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>code<span class="token punctuation">,</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>countryId<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>country_id<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">level</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>startDate<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>start_date<span class="token punctuation">,</span>m<span class="token punctuation">.</span>endDate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>end_date <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>end_date <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">5000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-国家"><a href="#通用标准信息-国家" class="headerlink" title="通用标准信息-国家"></a>通用标准信息-国家</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///xzqh_Country.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Country &#123;id: <span class="token keyword">row</span><span class="token punctuation">.</span>country_id&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>code_n<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_n <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_n <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>code_s<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_s <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_s <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>code_t<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_t <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>code_t <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>english_name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>continent<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>continent&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-行政区划根据父级id-创建关系"><a href="#通用标准信息-行政区划根据父级id-创建关系" class="headerlink" title="通用标准信息-行政区划根据父级id 创建关系"></a>通用标准信息-行政区划根据父级id 创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>r:Region<span class="token punctuation">)</span><span class="token keyword">where</span> r<span class="token punctuation">.</span>parentId <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>rp:Region<span class="token punctuation">)</span>     <span class="token keyword">where</span> rp<span class="token punctuation">.</span>id<span class="token operator">=</span>i<span class="token punctuation">.</span>parentId     <span class="token keyword">with</span> i<span class="token punctuation">,</span>rp    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rp<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>或者</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///xzqh_Region_Relationship.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>r:Region&#123;id:<span class="token keyword">row</span><span class="token punctuation">.</span>region_id&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rr:Region&#123;id:<span class="token keyword">row</span><span class="token punctuation">.</span>parent_id&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rr<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-行政区划与国家创建关系"><a href="#通用标准信息-行政区划与国家创建关系" class="headerlink" title="通用标准信息-行政区划与国家创建关系"></a>通用标准信息-行政区划与国家创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>r:Region<span class="token punctuation">)</span> <span class="token keyword">where</span> r<span class="token punctuation">.</span>parentId <span class="token operator">is</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">match</span> <span class="token punctuation">(</span>c:Country&#123;id:i<span class="token punctuation">.</span>countryId&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>所属国家<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准用到的规范导入"><a href="#通用标准用到的规范导入" class="headerlink" title="通用标准用到的规范导入"></a>通用标准用到的规范导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///新增民族婚姻状态等规范.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联"><a href="#通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联" class="headerlink" title="通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联"></a>通用标准信息-婚姻状态、民族、政治面貌、宗教、性别与规范关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:MaritalStatus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:Nation<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:PoliticalStatus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:Religion<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>ms:Sex<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span><span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>ms<span class="token punctuation">.</span>sourceStandardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="国民经济"><a href="#国民经济" class="headerlink" title="国民经济"></a>国民经济</h3><h4 id="国民经济行业分类导入"><a href="#国民经济行业分类导入" class="headerlink" title="国民经济行业分类导入"></a>国民经济行业分类导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :NationEconomyIndustryClass<span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///national_economy_industry.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:NationEconomyIndustryClass &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>annotation<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>annotation <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>annotation <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>parentCode<span class="token punctuation">,</span>m<span class="token punctuation">.</span>classType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>classType<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">level</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="国民经济行业分类关系创建"><a href="#国民经济行业分类关系创建" class="headerlink" title="国民经济行业分类关系创建"></a>国民经济行业分类关系创建</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode <span class="token operator">&lt;></span> <span class="token number">0</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:NationEconomyIndustryClass<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>parentCode    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="国民经济行业添加来源规范属性并创建规范关系"><a href="#国民经济行业添加来源规范属性并创建规范关系" class="headerlink" title="国民经济行业添加来源规范属性并创建规范关系"></a>国民经济行业添加来源规范属性并创建规范关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///国民经济分类.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span class="token punctuation">;</span><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass<span class="token punctuation">)</span> <span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token string">'0'</span> <span class="token keyword">set</span> n<span class="token punctuation">.</span>sourceStandardNo<span class="token operator">=</span><span class="token string">'GB/T 4754-2017'</span><span class="token punctuation">;</span><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass<span class="token punctuation">)</span> <span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token string">'0'</span> <span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument&#123;hasNO:<span class="token string">'GB/T 4754-2017'</span>&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>来源规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品分类库导入"><a href="#产品分类库导入" class="headerlink" title="产品分类库导入"></a>产品分类库导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :ProductCategory<span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///产品分类库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:ProductCategory &#123;code: <span class="token keyword">row</span><span class="token punctuation">.</span>code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>parentCode<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>parentCode<span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">level</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品分类库关系创建"><a href="#产品分类库关系创建" class="headerlink" title="产品分类库关系创建"></a>产品分类库关系创建</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:ProductCategory<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>parentCode <span class="token operator">&lt;></span> <span class="token number">0</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:ProductCategory<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>parentCode    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构库导入"><a href="#组织机构库导入" class="headerlink" title="组织机构库导入"></a>组织机构库导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Organization<span class="token punctuation">(</span>UnifiedSocialCreditCode<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///组织机构_港通_数据.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Organization &#123;UnifiedSocialCreditCode: <span class="token keyword">row</span><span class="token punctuation">.</span>UnifiedSocialCreditCode&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>CName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CShortName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CShortName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CShortName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>EName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>EShortName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EShortName <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EShortName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>OrganizationStructureCategory<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OrganizationStructureCategory <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OrganizationStructureCategory <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>LegalPersonProperty<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalPersonProperty <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalPersonProperty <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>LegalRepresentative<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalRepresentative <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>LegalRepresentative <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>IsUsing<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>IsUsing <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>IsUsing <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>RegistrationAuthority<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegistrationAuthority <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegistrationAuthority <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Introduction<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Introduction <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Introduction <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Coordinate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Coordinate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Coordinate <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>DetailedAddress<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DetailedAddress <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DetailedAddress <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CountryCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CountryCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CountryCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ProvinceCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProvinceCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProvinceCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CityCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CityCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CityCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>DistrictCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DistrictCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>DistrictCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>NationEconomyIndustryCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>NationEconomyIndustryCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>NationEconomyIndustryCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ProductClassCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProductClassCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ProductClassCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Tel<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Tel <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Tel <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Email<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Email <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Email <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>PostalCode<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>PostalCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>PostalCode <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Fax<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Fax <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>Fax <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>OfficialWebsite<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OfficialWebsite <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>OfficialWebsite <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ManagementState<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ManagementState <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>ManagementState <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>BusinessRegistrationNo<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessRegistrationNo <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessRegistrationNo <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>RegisteredCapital<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegisteredCapital <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>RegisteredCapital <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>EstablishedDate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EstablishedDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>EstablishedDate <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>CancelDate<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CancelDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>CancelDate <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>BusinessTerm<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessTerm <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessTerm <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>BusinessScope<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessScope <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>BusinessScope <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与产品分类建立关系"><a href="#组织机构与产品分类建立关系" class="headerlink" title="组织机构与产品分类建立关系"></a>组织机构与产品分类建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>ProductClassCode<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> pcodeListunwind pcodeList <span class="token keyword">as</span> pcode<span class="token keyword">with</span> o<span class="token punctuation">,</span> pcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:ProductCategory&#123;code:pcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>产品<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与国民行业分类建立关系"><a href="#组织机构与国民行业分类建立关系" class="headerlink" title="组织机构与国民行业分类建立关系"></a>组织机构与国民行业分类建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>NationEconomyIndustryCode<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> pcodeListunwind pcodeList <span class="token keyword">as</span> pcode<span class="token keyword">with</span> o<span class="token punctuation">,</span> pcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:NationEconomyIndustryClass&#123;code:pcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>行业<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与国家建立关系"><a href="#组织机构与国家建立关系" class="headerlink" title="组织机构与国家建立关系"></a>组织机构与国家建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Country&#123;code_n:o<span class="token punctuation">.</span>CountryCode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:国家<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="组织机构与行政区划建立关系"><a href="#组织机构与行政区划建立关系" class="headerlink" title="组织机构与行政区划建立关系"></a>组织机构与行政区划建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Region&#123;code:o<span class="token punctuation">.</span>ProvinceCode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:行政区划<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Region&#123;code:o<span class="token punctuation">.</span>CityCode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:行政区划<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>o:Organization<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Region&#123;code:o<span class="token punctuation">.</span>DistrictCode<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:行政区划<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="机械库-通用"><a href="#机械库-通用" class="headerlink" title="机械库-通用"></a>机械库-通用</h3><h4 id="导入通用机械库数据"><a href="#导入通用机械库数据" class="headerlink" title="导入通用机械库数据"></a>导入通用机械库数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///通用机械入库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Machine:Common &#123;uuid: <span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>dataType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>dataType<span class="token punctuation">,</span>m<span class="token punctuation">.</span>typeUuid<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>cName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>clauseExplain<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>standardNos<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>picIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>videoIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="机械库根据uuid创建上下级关系"><a href="#机械库根据uuid创建上下级关系" class="headerlink" title="机械库根据uuid创建上下级关系"></a>机械库根据uuid创建上下级关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Machine<span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>r:Machine:Common<span class="token punctuation">)</span><span class="token keyword">where</span> r<span class="token punctuation">.</span>typeUuid <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>rp:Machine:Common<span class="token punctuation">)</span>     <span class="token keyword">where</span> rp<span class="token punctuation">.</span>uuid<span class="token operator">=</span>i<span class="token punctuation">.</span>typeUuid    <span class="token keyword">with</span> i<span class="token punctuation">,</span>rp    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>rp<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用机械库规范入库"><a href="#通用机械库规范入库" class="headerlink" title="通用机械库规范入库"></a>通用机械库规范入库</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///通用机械规范属性表.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据机械库standardNos，与标准规范库建立关系"><a href="#根据机械库standardNos，与标准规范库建立关系" class="headerlink" title="根据机械库standardNos，与标准规范库建立关系"></a>根据机械库standardNos，与标准规范库建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Machine:Common&#123;dataType:<span class="token string">'1'</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">where</span> m<span class="token punctuation">.</span>standardNos <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token keyword">with</span> m<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>standardNos<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> standardNoListunwind standardNoList <span class="token keyword">as</span> standardNo<span class="token keyword">with</span> m<span class="token punctuation">,</span> standardNo<span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span> <span class="token keyword">where</span> s<span class="token punctuation">.</span>path <span class="token keyword">contains</span> standardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>涉及规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="通用机械媒体文件导入且与机械节点创建关系"><a href="#通用机械媒体文件导入且与机械节点创建关系" class="headerlink" title="通用机械媒体文件导入且与机械节点创建关系"></a>通用机械媒体文件导入且与机械节点创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///通用机械-图片.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:MediaFile&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>filePath<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span>f<span class="token punctuation">.</span>mediaType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>mediaType<span class="token keyword">with</span> f<span class="token punctuation">,</span><span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>j:Common&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>jixieUuid&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>包含文件<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="机械库-产品"><a href="#机械库-产品" class="headerlink" title="机械库-产品"></a>机械库-产品</h3><h4 id="导入产品机械库数据"><a href="#导入产品机械库数据" class="headerlink" title="导入产品机械库数据"></a>导入产品机械库数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///建筑机械与设备-产品类入库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Machine:PdType &#123;uuid: <span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>dataType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>dataType<span class="token punctuation">,</span>m<span class="token punctuation">.</span>typeUuid<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>cName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>clauseExplain<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>standardNos<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>picIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>videoIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="机械库根据uuid创建上下级关系-1"><a href="#机械库根据uuid创建上下级关系-1" class="headerlink" title="机械库根据uuid创建上下级关系"></a>机械库根据uuid创建上下级关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :Machine<span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>r:Machine:PdType<span class="token punctuation">)</span><span class="token keyword">where</span> r<span class="token punctuation">.</span>typeUuid <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>rp:Machine:PdType<span class="token punctuation">)</span>     <span class="token keyword">where</span> rp<span class="token punctuation">.</span>uuid<span class="token operator">=</span>i<span class="token punctuation">.</span>typeUuid    <span class="token keyword">with</span> i<span class="token punctuation">,</span>rp    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>rp<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品机械库规范入库"><a href="#产品机械库规范入库" class="headerlink" title="产品机械库规范入库"></a>产品机械库规范入库</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///第二批机械库规范属性表.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="根据产品机械库standardNos，与标准规范库建立关系"><a href="#根据产品机械库standardNos，与标准规范库建立关系" class="headerlink" title="根据产品机械库standardNos，与标准规范库建立关系"></a>根据产品机械库standardNos，与标准规范库建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Machine:PdType&#123;dataType:<span class="token string">'1'</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">where</span> m<span class="token punctuation">.</span>standardNos <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token keyword">with</span> m<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>standardNos<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> standardNoListunwind standardNoList <span class="token keyword">as</span> standardNo<span class="token keyword">with</span> m<span class="token punctuation">,</span> standardNo<span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span> <span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>standardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>涉及规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="创建机械库类型，并与机械库建立关系"><a href="#创建机械库类型，并与机械库建立关系" class="headerlink" title="创建机械库类型，并与机械库建立关系"></a>创建机械库类型，并与机械库建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">Create</span> <span class="token punctuation">(</span>n:JiXieType&#123;typeCode:<span class="token number">0</span><span class="token punctuation">,</span>typeName:<span class="token string">'建筑机械与设备——通用类'</span>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">Create</span> <span class="token punctuation">(</span>n:JiXieType&#123;typeCode:<span class="token number">1</span><span class="token punctuation">,</span>typeName:<span class="token string">'建筑机械与设备——产品类'</span>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">Create</span> <span class="token punctuation">(</span>n:JiXieType&#123;typeCode:<span class="token number">2</span><span class="token punctuation">,</span>typeName:<span class="token string">'船舶'</span>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Common<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>n:JiXieType&#123;typeCode:<span class="token number">0</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:JiXieType<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>m:PdType<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>n:JiXieType&#123;typeCode:<span class="token number">1</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:JiXieType<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Ship<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>n:JiXieType&#123;typeCode:<span class="token number">2</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:JiXieType<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:Common<span class="token punctuation">)</span> remove n:Common<span class="token punctuation">;</span><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:PdType<span class="token punctuation">)</span> remove n:PdType<span class="token punctuation">;</span><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:Ship<span class="token punctuation">)</span> remove n:Ship<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品机械数据修改"><a href="#产品机械数据修改" class="headerlink" title="产品机械数据修改"></a>产品机械数据修改</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///建筑机械与设备-产品类入库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Machine&#123;uuid: <span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">match</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>dataType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>dataType<span class="token punctuation">,</span>m<span class="token punctuation">.</span>typeUuid<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>cName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>clauseExplain<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>standardNos<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>picIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>videoIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品机械补充规范标准数据导入"><a href="#产品机械补充规范标准数据导入" class="headerlink" title="产品机械补充规范标准数据导入"></a>产品机械补充规范标准数据导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///第二批机械库规范属性表2022727补充.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="产品机械图片数据导入，并建立关系"><a href="#产品机械图片数据导入，并建立关系" class="headerlink" title="产品机械图片数据导入，并建立关系"></a>产品机械图片数据导入，并建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///建筑机械与设备-产品类图片路径.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:MediaFile&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>filePath<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span>f<span class="token punctuation">.</span>mediaType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>mediaType<span class="token keyword">with</span> f<span class="token punctuation">,</span><span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>j:Machine&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>JXuuid&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>包含文件<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="机械库-船舶"><a href="#机械库-船舶" class="headerlink" title="机械库-船舶"></a>机械库-船舶</h3><h4 id="导入船舶机械库数据并与类型创建关系"><a href="#导入船舶机械库数据并与类型创建关系" class="headerlink" title="导入船舶机械库数据并与类型创建关系"></a>导入船舶机械库数据并与类型创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///船舶入库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>m:Machine &#123;uuid: <span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>dataType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>dataType<span class="token punctuation">,</span>m<span class="token punctuation">.</span>typeUuid<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>typeUuid <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>cName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>cName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>eName<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>eName <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token keyword">explain</span><span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span><span class="token keyword">explain</span> <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>clauseExplain<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>clauseExplain <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>standardNos<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardNos <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>picIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>picIds <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>videoIds<span class="token operator">=</span><span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>videoIds <span class="token keyword">END</span><span class="token keyword">with</span> m<span class="token punctuation">,</span><span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>n:JiXieType&#123;typeCode:<span class="token number">2</span>&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:JiXieType<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入船舶新增规范"><a href="#导入船舶新增规范" class="headerlink" title="导入船舶新增规范"></a>导入船舶新增规范</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///第三批机械库规范属性表.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:StandardizingDocument &#123;hasNO: <span class="token keyword">row</span><span class="token punctuation">.</span>hasNO&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>nameCN <span class="token operator">=</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameCN<span class="token punctuation">,</span> s<span class="token punctuation">.</span>nameEN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>nameEN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>levelsOrCategories <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>levelsOrCategories <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>fileCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>fileCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>standardCode <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>standardCode <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasSN <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasSN <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseYear <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseYear <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasIS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasIS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasCCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasCCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>releaseDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>implementationDate <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>implementationDate<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasAQ <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasAQ <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>replacedNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>replacedNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>degreeOfConsistencyIdentification <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>releaseMechanism <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>releaseMechanism <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>updated <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>updated <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">date</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>updated<span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>maintainerNO <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>maintainerNO <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>hasGBW_CCS <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>hasGBW_CCS <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>state <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>path <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="船舶类机械与规范创建关系"><a href="#船舶类机械与规范创建关系" class="headerlink" title="船舶类机械与规范创建关系"></a>船舶类机械与规范创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>m:Machine<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>:JiXieType&#123;typeCode: <span class="token number">2</span>&#125;<span class="token punctuation">)</span> <span class="token keyword">where</span> m<span class="token punctuation">.</span>standardNos <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token keyword">with</span> m<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>standardNos<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> standardNoListunwind standardNoList <span class="token keyword">as</span> standardNo<span class="token keyword">with</span> m<span class="token punctuation">,</span> standardNo<span class="token keyword">match</span> <span class="token punctuation">(</span>s:StandardizingDocument<span class="token punctuation">)</span> <span class="token keyword">where</span> s<span class="token punctuation">.</span>hasNO<span class="token operator">=</span>standardNo<span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>涉及规范<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="船舶类机械图片视频导入，并创建关系"><a href="#船舶类机械图片视频导入，并创建关系" class="headerlink" title="船舶类机械图片视频导入，并创建关系"></a>船舶类机械图片视频导入，并创建关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///船舶图片路径.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:MediaFile&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>uuid&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>filePath<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span>f<span class="token punctuation">.</span>mediaType<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>mediaType<span class="token keyword">with</span> f<span class="token punctuation">,</span><span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>j:Machine&#123;uuid:<span class="token keyword">row</span><span class="token punctuation">.</span>JXuuid&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>包含文件<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h3><h4 id="导入相关字典（key-value类）"><a href="#导入相关字典（key-value类）" class="headerlink" title="导入相关字典（key-value类）"></a>导入相关字典（key-value类）</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///工程类别.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:工程类别 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入相关字典，并建立上下级关系（树类）"><a href="#导入相关字典，并建立上下级关系（树类）" class="headerlink" title="导入相关字典，并建立上下级关系（树类）"></a>导入相关字典，并建立上下级关系（树类）</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///组织机构类别.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:组织机构类别 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>ParentCode<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>ParentCode<span class="token punctuation">,</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构类别<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>ParentCode <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:组织机构类别<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>ParentCode    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="组织机构库"><a href="#组织机构库" class="headerlink" title="组织机构库"></a>组织机构库</h3><h4 id="导入组织机构库"><a href="#导入组织机构库" class="headerlink" title="导入组织机构库"></a>导入组织机构库</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///组织机构库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:组织机构&#123;组织机构编码: <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>组织名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>组织机构类别<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>法人类型<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人类型 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人类型 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>登记机关 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记机关 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记机关 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>管辖机关 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>管辖机关 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>管辖机关 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>统一社会信用代码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>统一社会信用代码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>统一社会信用代码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>经营状态<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营状态 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营状态 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>注册资本<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注册资本 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注册资本 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>所属行业 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属行业 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属行业 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>主要产品<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要产品 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要产品 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>成立时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>成立时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>成立时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>注销时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注销时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注销时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>营业期限开始 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限开始 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限开始 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>营业期限结束 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限结束 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限结束 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>法人或负责人 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人或负责人 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人或负责人 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>所属层级 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属层级 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属层级 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>上级部门 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>上级部门 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>上级部门 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>联系电话 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>联系电话 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>联系电话 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>电子邮箱 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>电子邮箱 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>电子邮箱 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>邮政编码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮政编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮政编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>登记号 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记号 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记号 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>坐标点 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标点 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标点 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>详细地址 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>简介 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>简介 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>简介 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>主要职责 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要职责 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要职责 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>范围 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>范围 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>范围 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>行政区划代码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划代码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划代码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>宗旨原则 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>宗旨原则 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>宗旨原则 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>传真 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>传真 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>传真 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>行政级别 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政级别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政级别 <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构库自己关联上级部门"><a href="#组织机构库自己关联上级部门" class="headerlink" title="组织机构库自己关联上级部门"></a>组织机构库自己关联上级部门</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>上级部门 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:组织机构<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>组织机构编码<span class="token operator">=</span>i<span class="token punctuation">.</span>上级部门    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级部门<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构关联字典"><a href="#组织机构关联字典" class="headerlink" title="组织机构关联字典"></a>组织机构关联字典</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>组织机构类别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>组织机构类别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>组织机构类别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>法人类型 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>法人类型    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>法人类型<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>经营状态 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>经营状态    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>经营状态<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>行政级别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>行政级别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政级别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与行政区划关联"><a href="#组织机构与行政区划关联" class="headerlink" title="组织机构与行政区划关联"></a>组织机构与行政区划关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>行政区划代码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:Region<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>行政区划代码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政区划<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构库与行业关联"><a href="#组织机构库与行业关联" class="headerlink" title="组织机构库与行业关联"></a>组织机构库与行业关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>o:组织机构<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>所属行业<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> hcodeListunwind hcodeList <span class="token keyword">as</span> hcode<span class="token keyword">call</span> &#123;<span class="token keyword">with</span> o<span class="token punctuation">,</span> hcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:NationEconomyIndustryClass&#123;code:hcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>行业<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>&#125;<span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="组织机构与产品关联"><a href="#组织机构与产品关联" class="headerlink" title="组织机构与产品关联"></a>组织机构与产品关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>o:组织机构<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>主要产品<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> pcodeListunwind pcodeList <span class="token keyword">as</span> pcode<span class="token keyword">call</span> &#123;<span class="token keyword">with</span> o<span class="token punctuation">,</span> pcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:ProductCategory&#123;code:pcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>产品<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>&#125;<span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="客户库"><a href="#客户库" class="headerlink" title="客户库"></a>客户库</h3><h4 id="客户库数据导入"><a href="#客户库数据导入" class="headerlink" title="客户库数据导入"></a>客户库数据导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///客户库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:客户&#123;客户编码:<span class="token keyword">row</span><span class="token punctuation">.</span>客户编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>客户名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>客户类别<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>客户等级<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户等级 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户等级 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>客户分类 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户分类 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户分类 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>公司类别 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>公司类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>公司类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>行政区划编码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>客户地址<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户地址 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户地址 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>客户状态<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户状态 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户状态 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>维护状态 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>维护状态 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所维护状态 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>组织机构编码<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>专业特长<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业特长 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业特长 <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="客户关联字典"><a href="#客户关联字典" class="headerlink" title="客户关联字典"></a>客户关联字典</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>客户类别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>客户类别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>客户类别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>客户等级 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>客户等级    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>客户等级<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>客户分类 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>客户分类    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>客户分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>公司类别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>公司类别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>公司类别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>客户状态 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>客户状态    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>客户状态<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>维护状态 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>维护状态    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>维护状态<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="客户关联组织机构"><a href="#客户关联组织机构" class="headerlink" title="客户关联组织机构"></a>客户关联组织机构</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>组织机构编码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:组织机构<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>组织机构编码<span class="token operator">=</span>i<span class="token punctuation">.</span>组织机构编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>组织机构<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="客户与行政区划关联"><a href="#客户与行政区划关联" class="headerlink" title="客户与行政区划关联"></a>客户与行政区划关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:客户<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>行政区划编码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:Region<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>行政区划编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政区划<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="合同库"><a href="#合同库" class="headerlink" title="合同库"></a>合同库</h3><h4 id="合同库导入"><a href="#合同库导入" class="headerlink" title="合同库导入"></a>合同库导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///合同库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:合同&#123;合同编码: <span class="token keyword">row</span><span class="token punctuation">.</span>合同编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>合同名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同编号<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同编号 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同编号 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>业务类别<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>业务部门<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务部门 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务部门 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>业主联系人 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业主联系人 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业主联系人 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>业主联系方式 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业主联系方式 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业主联系方式 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>业主可提供条件<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业主可提供条件 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业主可提供条件 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同地点<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同地点 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同地点 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>工程类别<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>工程等级<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程等级 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程等级 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>工程规模<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程规模 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程规模 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>投资额<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>投资额 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>投资额 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>评审时间<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>评审时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>评审时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>签订时间<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>签订时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>签订时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同开始时间<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同开始时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同开始时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同终止时间<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同终止时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同终止时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同历时<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同历时 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同历时 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>质量要求<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>质量要求 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>质量要求 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>付款条款<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>付款条款 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>付款条款 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>服务范围<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>服务范围 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>服务范围 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>工期要求<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工期要求 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工期要求 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>人员要求<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>人员要求 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>人员要求 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>其他人员要求<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>其他人员要求 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>其他人员要求 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>其他要求<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>其他要求 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>其他要求 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>付款费率<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>付款费率 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>付款费率 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同额<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同额 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同额 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>有效合同额<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>有效合同额 <span class="token keyword">WHEN</span> <span class="token string">""</span>  <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>有效合同额 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>平均人数<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>平均人数 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>平均人数 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>预计人月<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>预计人月 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>预计人月 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>人均产值<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>人均产值 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>人均产值 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>保修期<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>保修期 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>保修期 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>保修款<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>保修款 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>保修款 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>延期条款<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>延期条款 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>延期条款 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>风险概述<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>风险概述 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>风险概述 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>是否为合作项目<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>是否为合作项目 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>是否为合作项目 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合作单位<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合作单位 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合作单位 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合作情况说明<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合作情况说明 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合作情况说明 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>承揽方式<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>承揽方式 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>承揽方式 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同总监编号<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同总监编号 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span>  <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同总监编号 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>现场负责人编号<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>现场负责人编号 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>现场负责人编号 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>申请人编号<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>申请人编号 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>申请人编号 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>申请时间<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>申请时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>申请时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>行政区划编码<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>经度<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经度 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经度 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>纬度<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>纬度 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>纬度  <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>实际合同额<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际合同额 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际合同额 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同执行状态<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同执行状态 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同执行状态 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>客户编码<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>客户编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>备注<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>备注 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>备注 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同性质<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同性质 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同性质 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>主合同编码<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主合同编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主合同编码 <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="更新合同中合同额数字"><a href="#更新合同中合同额数字" class="headerlink" title="更新合同中合同额数字"></a>更新合同中合同额数字</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token keyword">on</span> :合同<span class="token punctuation">(</span>合同编码<span class="token punctuation">)</span><span class="token punctuation">;</span>:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///合同额.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>m:合同 &#123;合同编码: <span class="token keyword">row</span><span class="token punctuation">.</span>合同编码&#125;<span class="token punctuation">)</span> <span class="token keyword">SET</span>m<span class="token punctuation">.</span>合同额<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>合同额<span class="token punctuation">,</span>m<span class="token punctuation">.</span>有效合同额<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>有效合同额<span class="token punctuation">,</span>m<span class="token punctuation">.</span>实际合同额<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>实际合同额&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="合同与行政区划关联"><a href="#合同与行政区划关联" class="headerlink" title="合同与行政区划关联"></a>合同与行政区划关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>行政区划编码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:Region<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>行政区划编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政区划<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="合同与客户关联"><a href="#合同与客户关联" class="headerlink" title="合同与客户关联"></a>合同与客户关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>客户编码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:客户<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>客户编码<span class="token operator">=</span>i<span class="token punctuation">.</span>客户编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>客户<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="合同与自身主合同关联"><a href="#合同与自身主合同关联" class="headerlink" title="合同与自身主合同关联"></a>合同与自身主合同关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>主合同编码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:合同<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>合同编码<span class="token operator">=</span>i<span class="token punctuation">.</span>主合同编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>主合同<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="合同关联字典"><a href="#合同关联字典" class="headerlink" title="合同关联字典"></a>合同关联字典</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>业务类别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>业务类别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>业务类别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>工程类别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>工程类别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>工程类别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>工程等级 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>工程等级    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>工程等级<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>承揽方式 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>承揽方式    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>承揽方式<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:合同<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>合同执行状态 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>合同执行状态    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>合同执行状态<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="监理项目库"><a href="#监理项目库" class="headerlink" title="监理项目库"></a>监理项目库</h3><h4 id="导入监理项目库"><a href="#导入监理项目库" class="headerlink" title="导入监理项目库"></a>导入监理项目库</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///监理项目库.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:监理:项目&#123;项目编码: <span class="token keyword">row</span><span class="token punctuation">.</span>项目编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>项目名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>工程类别<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工程类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>所属部门 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属部门 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属部门 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>行政区划编码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>详细地址<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>项目状态<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目状态 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目状态 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>缩略图地址 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>缩略图地址 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>缩略图地址 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>质量目标<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>质量目标 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>质量目标 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>进度目标 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>进度目标 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>进度目标 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>投资目标 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>投资目标 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>投资目标 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>安全目标 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>安全目标 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>安全目标 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>计划开始时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>计划开始时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>计划开始时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>计划结束时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>计划结束时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>计划结束时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>实际开始时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际开始时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际开始时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>实际结束时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际结束时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际结束时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>项目简介 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目简介 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目简介 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>创建时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>创建时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>创建时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>创建人 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>创建人 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>创建人 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>项目是否归档 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目是否归档 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目是否归档 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>业务类型 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务类型 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务类型 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>地址 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>地址 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>地址 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>坐标 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>合同编码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>合同编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>实际进场时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际进场时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际进场时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>实际撤场时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际撤场时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>实际撤场时间 <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="监理项目库与字典关联"><a href="#监理项目库与字典关联" class="headerlink" title="监理项目库与字典关联"></a>监理项目库与字典关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:监理:项目<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>工程类别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>工程类别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>工程类别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:监理:项目<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>项目状态 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>项目状态    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>项目状态<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:监理:项目<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>业务类型 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>业务类型    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>业务类型<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="监理项目库与行政区划关联"><a href="#监理项目库与行政区划关联" class="headerlink" title="监理项目库与行政区划关联"></a>监理项目库与行政区划关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:监理:项目<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>行政区划编码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:Region<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>行政区划编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政区划<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="监理项目库与合同关联"><a href="#监理项目库与合同关联" class="headerlink" title="监理项目库与合同关联"></a>监理项目库与合同关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:监理:项目<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>合同编码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:合同<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>合同编码<span class="token operator">=</span>i<span class="token punctuation">.</span>合同编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>合同<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="院校库（组织机构）"><a href="#院校库（组织机构）" class="headerlink" title="院校库（组织机构）"></a>院校库（组织机构）</h3><h4 id="导入高校数据"><a href="#导入高校数据" class="headerlink" title="导入高校数据"></a>导入高校数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///高校.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:组织机构:高等院校&#123;组织机构编码: <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>中文名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>中文简称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文简称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文简称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>英文名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>英文简称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文简称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文简称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>组织机构类别<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>法人类型<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人类型 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人类型 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>登记机关 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记机关 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记机关 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>统一社会信用代码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>统一社会信用代码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>统一社会信用代码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>经营状态<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营状态 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营状态 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>注册资本<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注册资本 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注册资本 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>所属行业 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属行业 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属行业 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>主要产品<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要产品 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要产品 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>成立时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>成立时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>成立时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>注销时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注销时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注销时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>营业期限开始 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限开始 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限开始 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>营业期限结束 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限结束 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限结束 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>法人或负责人 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人或负责人 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人或负责人 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>所属层级 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属层级 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属层级 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>上级部门 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>上级部门 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>上级部门 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>联系电话 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>联系电话 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>联系电话 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>电子邮箱 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>电子邮箱 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>电子邮箱 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>邮政编码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮政编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮政编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>坐标 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>详细地址 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>简介 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>简介 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>简介 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>经营范围<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营范围 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营范围 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>行政区划代码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划代码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划代码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>优势业务 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>优势业务 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>优势业务 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>传真 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>传真 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>传真 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>资质资格 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>资质资格 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>资质资格  <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>荣誉与获奖 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>荣誉与获奖 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>荣誉与获奖  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>学校标识码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学校标识码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学校标识码  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>办学层次 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学层次 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学层次  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>办学性质 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学性质 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学性质  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>备注 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>备注 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>备注  <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入其他学校数据"><a href="#导入其他学校数据" class="headerlink" title="导入其他学校数据"></a>导入其他学校数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///其他教育机构.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>s:组织机构 :其他教育机构&#123;组织机构编码: <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span> s<span class="token punctuation">.</span>中文名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>中文简称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文简称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>中文简称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>英文名称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文名称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文名称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>英文简称<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文简称 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>英文简称 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>组织机构类别<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构类别 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>组织机构类别 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>法人类型<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人类型 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人类型 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>登记机关 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记机关 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>登记机关 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>统一社会信用代码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>统一社会信用代码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>统一社会信用代码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>经营状态<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营状态 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营状态 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>注册资本<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注册资本 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注册资本 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>所属行业 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属行业 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属行业 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>主要产品<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要产品 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主要产品 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>成立时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>成立时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>成立时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>注销时间 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注销时间 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>注销时间 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>营业期限开始 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限开始 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限开始 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>营业期限结束 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限结束 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>营业期限结束 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>法人或负责人 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人或负责人 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>法人或负责人 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>所属层级 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属层级 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>所属层级 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>上级部门 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>上级部门 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>上级部门 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>联系电话 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>联系电话 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>联系电话 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>电子邮箱 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>电子邮箱 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>电子邮箱 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>邮政编码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮政编码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮政编码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>坐标 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>坐标 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>详细地址 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>简介 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>简介 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>简介 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>经营范围<span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营范围 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营范围 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>行政区划代码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划代码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划代码 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>优势业务 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>优势业务 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>优势业务 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>传真 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>传真 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>传真 <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>资质资格 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>资质资格 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>资质资格  <span class="token keyword">END</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>荣誉与获奖 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>荣誉与获奖 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>荣誉与获奖  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>学校标识码 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学校标识码 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学校标识码  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>办学层次 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学层次 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学层次  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>办学性质 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学性质 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>办学性质  <span class="token keyword">END</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>备注 <span class="token operator">=</span> <span class="token keyword">CASE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>备注 <span class="token keyword">WHEN</span> <span class="token string">""</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">WHEN</span> <span class="token string">"0"</span> <span class="token keyword">THEN</span> <span class="token boolean">null</span> <span class="token keyword">ELSE</span> <span class="token keyword">row</span><span class="token punctuation">.</span>备注  <span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="教学机构关联字典"><a href="#教学机构关联字典" class="headerlink" title="教学机构关联字典"></a>教学机构关联字典</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构:高等院校<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>组织机构类别 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>组织机构类别    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>组织机构类别<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构:高等院校<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>法人类型 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>法人类型    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>法人类型<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构:高等院校<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>经营状态 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:字典<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>Code<span class="token operator">=</span>i<span class="token punctuation">.</span>经营状态    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>经营状态<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="教育机构与行政区划关联"><a href="#教育机构与行政区划关联" class="headerlink" title="教育机构与行政区划关联"></a>教育机构与行政区划关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:组织机构:高等院校<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>行政区划代码 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:Region<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>code<span class="token operator">=</span>i<span class="token punctuation">.</span>行政区划代码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政区划<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="教育机构库与行业关联"><a href="#教育机构库与行业关联" class="headerlink" title="教育机构库与行业关联"></a>教育机构库与行业关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>o:组织机构:高等院校<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>所属行业<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> hcodeListunwind hcodeList <span class="token keyword">as</span> hcode<span class="token keyword">call</span> &#123;<span class="token keyword">with</span> o<span class="token punctuation">,</span> hcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:NationEconomyIndustryClass&#123;code:hcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>行业<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>&#125;<span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="教育机构与产品关联"><a href="#教育机构与产品关联" class="headerlink" title="教育机构与产品关联"></a>教育机构与产品关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>o:组织机构:高等院校<span class="token punctuation">)</span><span class="token keyword">with</span> o<span class="token punctuation">,</span> split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>主要产品<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> pcodeListunwind pcodeList <span class="token keyword">as</span> pcode<span class="token keyword">call</span> &#123;<span class="token keyword">with</span> o<span class="token punctuation">,</span> pcode<span class="token keyword">match</span> <span class="token punctuation">(</span>p:ProductCategory&#123;code:pcode&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:<span class="token identifier"><span class="token punctuation">`</span>产品<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>&#125;<span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="人员信息相关导入"><a href="#人员信息相关导入" class="headerlink" title="人员信息相关导入"></a>人员信息相关导入</h3><h4 id="相关字典导入"><a href="#相关字典导入" class="headerlink" title="相关字典导入"></a>相关字典导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///户口性质.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:户口性质 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///户口转入状态.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:户口转入状态 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///学历.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:学历 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///档案转移.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:档案转移 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///缴纳身份.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:缴纳身份 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///学科专业.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:学科专业 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="证书数据导入"><a href="#证书数据导入" class="headerlink" title="证书数据导入"></a>证书数据导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///职称证书.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:职称证书:证书&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>编号&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>名称<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>名称<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///资格证书.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:资格证书:证书&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>编号&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>名称<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>名称<span class="token punctuation">,</span>f<span class="token punctuation">.</span>分类<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>分类<span class="token punctuation">,</span>f<span class="token punctuation">.</span>发证机关<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>发证机关<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///注册证书.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:注册证书:证书&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>编号&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>名称<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>名称<span class="token punctuation">,</span>f<span class="token punctuation">.</span>发证机关<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>发证机关<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="人员信息导入"><a href="#人员信息导入" class="headerlink" title="人员信息导入"></a>人员信息导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///人员信息表.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">Merge</span> <span class="token punctuation">(</span>m:员工:人 &#123;编码: <span class="token keyword">row</span><span class="token punctuation">.</span>编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span><span class="token keyword">SET</span>m<span class="token punctuation">.</span>员工工号<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>员工工号<span class="token punctuation">,</span>m<span class="token punctuation">.</span>姓名<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>姓名<span class="token punctuation">,</span>m<span class="token punctuation">.</span>性别<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>性别<span class="token punctuation">,</span>m<span class="token punctuation">.</span>民族<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>民族<span class="token punctuation">,</span>m<span class="token punctuation">.</span>政治面貌<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>政治面貌<span class="token punctuation">,</span>m<span class="token punctuation">.</span>婚姻状态<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>婚姻状态<span class="token punctuation">,</span>m<span class="token punctuation">.</span>入职时间<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>入职时间 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>入职时间 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>参加工作时间<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>参加工作时间 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>参加工作时间 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>居住地编码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>居住地编码 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>居住地编码 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>居住地详细地址<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>居住地详细地址 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>居住地详细地址 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>户籍地编码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户籍地编码 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户籍地编码 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>户籍地<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户籍地 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户籍地 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>身份证号码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>身份证号码 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>身份证号码 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>工位座机<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工位座机 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工位座机 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>手机号码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>手机号码 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>手机号码 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>头像<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>头像 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>头像 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>姓名缩写<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>姓名缩写 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>姓名缩写 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>主部门<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主部门 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>主部门 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>职级<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>职级 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>职级 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>邮箱<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮箱 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>邮箱 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>户口性质<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户口性质 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户口性质 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>户口转入状态<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户口转入状态 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>户口转入状态 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>公积金账号<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>公积金账号 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>公积金账号 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>社保账号<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>社保账号 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>社保账号 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>工资卡号<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工资卡号 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工资卡号 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>档案转移<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>档案转移 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>档案转移 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>缴纳身份<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>缴纳身份 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>缴纳身份 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>档案所在地<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>档案所在地 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>档案所在地 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>出生日期<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>出生日期 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>出生日期 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>身份证图片<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>身份证图片 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>身份证图片 <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="人员与字典关联"><a href="#人员与字典关联" class="headerlink" title="人员与字典关联"></a>人员与字典关联</h4><p>(居住地行政区划,籍贯行政区划，户口性质，户口转入状态，政治面貌，民族，婚姻状态，档案转移，缴纳身份)</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">//居住地</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:Region&#123;code:e<span class="token punctuation">.</span>居住地编码&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:居住地&#123;详细地址:e<span class="token punctuation">.</span>居住地详细地址    &#125;<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//户籍地</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:Region&#123;code:e<span class="token punctuation">.</span>户籍地编码&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:户籍地&#123;详细地址:e<span class="token punctuation">.</span>户籍地&#125;<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//婚姻状态</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:MaritalStatus&#123;code:e<span class="token punctuation">.</span>婚姻状态&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:婚姻状态<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//性别</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:Sex&#123;code:e<span class="token punctuation">.</span>性别&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:性别<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//政治面貌    </span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:PoliticalStatus&#123;code:e<span class="token punctuation">.</span>政治面貌&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:政治面貌<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//民族</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:Nation&#123;code:e<span class="token punctuation">.</span>民族&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:民族<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//户口性质</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:户口性质&#123;Code:e<span class="token punctuation">.</span>户口性质&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:户口性质<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//户口转入状态</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:户口转入状态&#123;Code:e<span class="token punctuation">.</span>户口转入状态&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:户口转入状态<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//档案转移</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:档案转移&#123;Code:e<span class="token punctuation">.</span>档案转移&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:档案转移<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//缴纳身份</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>rg:缴纳身份&#123;Code:e<span class="token punctuation">.</span>缴纳身份&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:缴纳身份<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>rg<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入人员工作经历并建立关系"><a href="#导入人员工作经历并建立关系" class="headerlink" title="导入人员工作经历并建立关系"></a>导入人员工作经历并建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///工作经历.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">Merge</span> <span class="token punctuation">(</span>m:工作经历 &#123;编码: <span class="token keyword">row</span><span class="token punctuation">.</span>编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span><span class="token keyword">SET</span>m<span class="token punctuation">.</span>开始时间<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>开始时间 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>开始时间 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>结束时间<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>结束时间 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>结束时间 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>工作单位<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工作单位 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工作单位 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>职务<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>职务 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>职务 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>证明人<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证明人 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证明人 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>工作内容<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工作内容 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工作内容 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>证明人联系方式<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证明人联系方式 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证明人联系方式 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>员工编码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>员工编码 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>员工编码 <span class="token keyword">END</span><span class="token keyword">with</span> m<span class="token punctuation">,</span><span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>员工编码&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:工作经历<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入人员家庭成员并建立关系"><a href="#导入人员家庭成员并建立关系" class="headerlink" title="导入人员家庭成员并建立关系"></a>导入人员家庭成员并建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///家庭成员表.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">Merge</span> <span class="token punctuation">(</span>m:人 &#123;编码: <span class="token keyword">row</span><span class="token punctuation">.</span>编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span><span class="token keyword">SET</span>m<span class="token punctuation">.</span>出生日期<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>出生日期 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>出生日期 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>工作单位<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工作单位 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>工作单位 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>姓名<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>姓名<span class="token punctuation">,</span>m<span class="token punctuation">.</span>联系方式<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>联系方式<span class="token punctuation">,</span>m<span class="token punctuation">.</span>员工编码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>员工编号 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>员工编号 <span class="token keyword">END</span><span class="token keyword">with</span> m<span class="token punctuation">,</span><span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>员工编号&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:家庭成员&#123;关系字典值:<span class="token keyword">row</span><span class="token punctuation">.</span>关系字典值<span class="token punctuation">,</span>关系:<span class="token keyword">row</span><span class="token punctuation">.</span>关系&#125;<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入人员教育经历并建立关系"><a href="#导入人员教育经历并建立关系" class="headerlink" title="导入人员教育经历并建立关系"></a>导入人员教育经历并建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///教育经历.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">Merge</span> <span class="token punctuation">(</span>m:教育经历 &#123;编码: <span class="token keyword">row</span><span class="token punctuation">.</span>编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span><span class="token keyword">SET</span>m<span class="token punctuation">.</span>开始时间<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>开始时间 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>开始时间 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>结束时间<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>结束时间 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>结束时间 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>教育类型<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>教育类型 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>教育类型 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>学校<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学校 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学校 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>学历字典值<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学历字典值 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学历字典值 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>学历<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学历 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>学历 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>专业字典值<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业字典值 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业字典值 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>专业<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>证书<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>员工编码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>员工编号 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>员工编号 <span class="token keyword">END</span><span class="token keyword">with</span> m<span class="token punctuation">,</span><span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>员工编号&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:教育经历<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="职称证书与人建立关系"><a href="#职称证书与人建立关系" class="headerlink" title="职称证书与人建立关系"></a>职称证书与人建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///职称证书-人.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>人员编号&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>c:证书&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>证书uuid&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:持有<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">create</span> <span class="token keyword">set</span>r<span class="token punctuation">.</span>证书编号<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书编号  <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书编号 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>等级<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>等级 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>等级 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>专业<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>专业 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>发证日期<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>发证日期 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>发证日期 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>状态<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>状态  <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>状态 <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="注册证书与人建立关系"><a href="#注册证书与人建立关系" class="headerlink" title="注册证书与人建立关系"></a>注册证书与人建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///注册证书-人.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>人员编号&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>c:证书&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>证书<span class="token keyword">No</span>&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:持有<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">create</span> <span class="token keyword">set</span>r<span class="token punctuation">.</span>证书编号<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书编号  <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书编号 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>发证日期<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>发证日期 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>发证日期 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>有效期<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>有效期 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>有效期 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>状态<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书状态  <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>状态 <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="资质证书与人建立关系"><a href="#资质证书与人建立关系" class="headerlink" title="资质证书与人建立关系"></a>资质证书与人建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///资格证书-人.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>人员编号&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>c:证书&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>证书<span class="token keyword">No</span>&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:持有<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">create</span> <span class="token keyword">set</span>r<span class="token punctuation">.</span>证书编号<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书编号  <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书编号 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>发证日期<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>发证日期 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>发证日期 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>等级<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>等级 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>等级 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>状态<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>证书状态  <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>状态 <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="导入部门数据，部门间建立上下级关系"><a href="#导入部门数据，部门间建立上下级关系" class="headerlink" title="导入部门数据，部门间建立上下级关系"></a>导入部门数据，部门间建立上下级关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///部门.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e:部门&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>编码&#125;<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">create</span> <span class="token keyword">set</span>e<span class="token punctuation">.</span>父级编码<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>父级编码<span class="token punctuation">,</span>e<span class="token punctuation">.</span>名称<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>名称&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span>:auto <span class="token keyword">match</span> <span class="token punctuation">(</span>n:部门<span class="token punctuation">)</span><span class="token keyword">where</span> n<span class="token punctuation">.</span>父级编码 <span class="token operator">&lt;></span> <span class="token string">'1001'</span>unwind <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">as</span> i<span class="token keyword">call</span> &#123;    <span class="token keyword">with</span> i    <span class="token keyword">match</span> <span class="token punctuation">(</span>ne:部门<span class="token punctuation">)</span>     <span class="token keyword">where</span> ne<span class="token punctuation">.</span>编码<span class="token operator">=</span>i<span class="token punctuation">.</span>父级编码    <span class="token keyword">with</span> i<span class="token punctuation">,</span>ne    <span class="token keyword">merge</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级部门<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>ne<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">2000</span> <span class="token keyword">ROWS</span><span class="token keyword">match</span> <span class="token punctuation">(</span>n:部门<span class="token punctuation">)</span> <span class="token keyword">where</span> n<span class="token punctuation">.</span>父级编码<span class="token operator">=</span><span class="token string">'1001'</span><span class="token keyword">match</span> <span class="token punctuation">(</span>m:组织机构<span class="token punctuation">)</span> <span class="token keyword">where</span> m<span class="token punctuation">.</span>组织名称<span class="token operator">=</span><span class="token string">'山东港通工程管理咨询有限公司'</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:部门<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="部门与员工建立关系"><a href="#部门与员工建立关系" class="headerlink" title="部门与员工建立关系"></a>部门与员工建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///人员-部门.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>人员编号&#125;<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>c:部门&#123;编码:<span class="token keyword">row</span><span class="token punctuation">.</span>部门编号&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r:任职于<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">create</span> <span class="token keyword">set</span>r<span class="token punctuation">.</span>岗位编号<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>岗位编号  <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>岗位编号 <span class="token keyword">END</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>岗位名称<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>岗位名称 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">"0001-01-01"</span> <span class="token keyword">then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>岗位名称 <span class="token keyword">END</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="经营信息录入并与员工建立关系"><a href="#经营信息录入并与员工建立关系" class="headerlink" title="经营信息录入并与员工建立关系"></a>经营信息录入并与员工建立关系</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">:auto <span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///经营信息.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">call</span> &#123;<span class="token keyword">with</span> <span class="token keyword">row</span><span class="token keyword">Merge</span> <span class="token punctuation">(</span>m:经营信息 &#123;编码: <span class="token keyword">row</span><span class="token punctuation">.</span>编码&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span><span class="token keyword">SET</span>m<span class="token punctuation">.</span>项目名称<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目名称 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目名称 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>部门编码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>部门编码 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>部门编码 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>业务类型<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务类型 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>业务类型 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>行政区划编码<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>行政区划编码 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>详细地址<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>详细地址 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>投资额<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>投资额 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">when</span> <span class="token string">'/'</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>投资额 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>项目概况<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目概况 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">'/'</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目概况 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>建设单位<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>建设单位 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span> <span class="token keyword">when</span> <span class="token string">'/'</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>建设单位 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>跟踪状态<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>跟踪状态 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>跟踪状态 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>经营负责人<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营负责人 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>经营负责人 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>项目进展情况<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目进展情况 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>项目进展情况 <span class="token keyword">END</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>需要协调的问题<span class="token operator">=</span><span class="token keyword">case</span> <span class="token keyword">row</span><span class="token punctuation">.</span>需要协调的问题 <span class="token keyword">when</span> <span class="token string">""</span> <span class="token keyword">Then</span> <span class="token boolean">null</span>  <span class="token keyword">else</span> <span class="token keyword">row</span><span class="token punctuation">.</span>需要协调的问题 <span class="token keyword">END</span><span class="token keyword">with</span> m<span class="token punctuation">,</span>split<span class="token punctuation">(</span><span class="token keyword">coalesce</span><span class="token punctuation">(</span><span class="token keyword">row</span><span class="token punctuation">.</span>经营负责人<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> Listunwind List <span class="token keyword">as</span> ee<span class="token keyword">match</span> <span class="token punctuation">(</span>e:员工&#123;编码:ee&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:跟踪项目<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>&#125; <span class="token operator">IN</span> <span class="token keyword">TRANSACTIONS</span> <span class="token keyword">OF</span> <span class="token number">1000</span> <span class="token keyword">ROWS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="经营信息与行政区划建立关联"><a href="#经营信息与行政区划建立关联" class="headerlink" title="经营信息与行政区划建立关联"></a>经营信息与行政区划建立关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>e:经营信息<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Region&#123;code:e<span class="token punctuation">.</span>行政区划编码&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>rr:业务地点<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token keyword">set</span> rr<span class="token punctuation">.</span>详细地址<span class="token operator">=</span>e<span class="token punctuation">.</span>详细地址<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="经营信息与国家建立关联"><a href="#经营信息与国家建立关联" class="headerlink" title="经营信息与国家建立关联"></a>经营信息与国家建立关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>e:经营信息<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:Country&#123;code_n:e<span class="token punctuation">.</span>行政区划编码&#125;<span class="token punctuation">)</span> <span class="token keyword">where</span> size<span class="token punctuation">(</span>e<span class="token punctuation">.</span>行政区划编码<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>rr:业务地点<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token keyword">set</span> rr<span class="token punctuation">.</span>详细地址<span class="token operator">=</span>e<span class="token punctuation">.</span>详细地址<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="经营信息与部门建立关系"><a href="#经营信息与部门建立关系" class="headerlink" title="经营信息与部门建立关系"></a>经营信息与部门建立关系</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>e:经营信息<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:部门&#123;编码:e<span class="token punctuation">.</span>部门编码&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:业务部门<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="相关字典导入-1"><a href="#相关字典导入-1" class="headerlink" title="相关字典导入"></a>相关字典导入</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///经营跟踪状态.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:经营跟踪状态 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span class="token keyword">LOAD</span> CSV <span class="token keyword">WITH</span> HEADERS<span class="token keyword">FROM</span> <span class="token string">'file:///经营项目类型.csv'</span> <span class="token keyword">AS</span> <span class="token keyword">row</span><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>f:经营项目类型 :字典&#123;Code:<span class="token keyword">row</span><span class="token punctuation">.</span>Code&#125;<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">CREATE</span> <span class="token keyword">SET</span>f<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token keyword">row</span><span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="经营项目与字典关联"><a href="#经营项目与字典关联" class="headerlink" title="经营项目与字典关联"></a>经营项目与字典关联</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span> <span class="token punctuation">(</span>e:经营信息<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r:经营跟踪状态&#123;Code:e<span class="token punctuation">.</span>跟踪状态&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:跟踪状态<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">match</span> <span class="token punctuation">(</span>e:经营信息<span class="token punctuation">)</span><span class="token keyword">with</span> e<span class="token punctuation">,</span> split<span class="token punctuation">(</span>e<span class="token punctuation">.</span>业务类型<span class="token punctuation">,</span><span class="token string">'|'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> list unwind list <span class="token keyword">as</span> item <span class="token keyword">with</span> item<span class="token punctuation">,</span>e<span class="token keyword">match</span> <span class="token punctuation">(</span>r:经营项目类型&#123;Code:item&#125;<span class="token punctuation">)</span><span class="token keyword">merge</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:业务类型<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Neo4J </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 脚本 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IIS反向代理配置</title>
      <link href="/2022/07/19/IIS%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
      <url>/2022/07/19/IIS%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="第一步："><a href="#第一步：" class="headerlink" title="第一步："></a>第一步：</h2><p>安装 URL Rewrite和Application Request Routing（简称为ARR）两个IIS模块</p><p>ARR 下载地址： <a href="https://www.iis.net/downloads/microsoft/application-request-routing">Application Request Routing : The Official Microsoft IIS Site</a></p><p>URL Rewrite下载地址：<a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite : The Official Microsoft IIS Site</a></p><p><img src="/myfile/2022-07-21-14-44-05-image.png"></p><p><img src="/myfile/2022-07-21-14-44-20-image.png"></p><h2 id="第二步："><a href="#第二步：" class="headerlink" title="第二步："></a>第二步：</h2><p>1、启用ARR Proxy：在服务器上面，找到IIS管理器，点击Application Request Routing（简称为ARR）图标，选择Server Proxy Settings，勾上Enable proxy并点击右侧的应用。</p><p><img src="/myfile/2022-07-21-14-46-35-image.png"></p><p><img src="/myfile/2022-07-21-14-46-59-image.png"></p><p><img src="/myfile/2022-07-21-14-47-49-image.png"></p><p>2、添加URL重写规则</p><p><img src="/myfile/2022-07-21-15-11-58-image.png"></p><p><img src="/myfile/2022-07-21-15-11-00-image.png"></p><p><img src="/myfile/2022-07-21-15-13-22-image.png"></p><p>至此即可将本服务器地址统一反向代理到目标服务器地址</p><p>3.进阶设置</p><p>双击规则，进行详细编辑</p><p><img src="/myfile/2022-07-21-15-16-57-image.png"></p><p>分别通过模式及下方条件修改添加过滤，进行具体匹配后反向代理</p><p><img src="/myfile/2022-07-21-15-17-46-image.png"></p>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IIS </tag>
            
            <tag> 反向代理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>示例脚本</title>
      <link href="/2022/07/19/%E7%A4%BA%E4%BE%8B%E8%84%9A%E6%9C%AC/"/>
      <url>/2022/07/19/%E7%A4%BA%E4%BE%8B%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> p<span class="token operator">=</span><span class="token punctuation">(</span>n:Region<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token operator">*</span><span class="token number">0.</span><span class="token number">.2</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region&#123;name:<span class="token string">'芝罘区'</span>&#125;<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region<span class="token punctuation">)</span> <span class="token keyword">match</span> pp<span class="token operator">=</span><span class="token punctuation">(</span>n:Region&#123;name:<span class="token string">'山东省'</span>&#125;<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region&#123;name:<span class="token string">'烟台市'</span>&#125;<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>隶属<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>:Region<span class="token punctuation">)</span>  <span class="token keyword">RETURN</span> p<span class="token punctuation">,</span>pp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> p<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>产品<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">match</span> p1<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>国家<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">match</span> p2<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行业<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">match</span> p3<span class="token operator">=</span><span class="token punctuation">(</span>n:Organization<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>行政区划<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">RETURN</span> p<span class="token punctuation">,</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">,</span>p3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n:Material<span class="token punctuation">)</span> <span class="token keyword">RETURN</span> n <span class="token keyword">LIMIT</span> <span class="token number">50</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">MATCH</span> p<span class="token operator">=</span> <span class="token punctuation">(</span>n:NationEconomyIndustryClass&#123;name:<span class="token string">'建筑业'</span>&#125;<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span>:NationEconomyIndustryClass&#123;name:<span class="token string">'土木工程建筑业'</span>&#125;<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>:<span class="token identifier"><span class="token punctuation">`</span>下级分类<span class="token punctuation">`</span></span><span class="token operator">*</span><span class="token number">0.</span><span class="token number">.3</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">RETURN</span> p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">match</span>  p<span class="token operator">=</span> <span class="token punctuation">(</span>m:Staff&#123;staffId:<span class="token string">'GT1183'</span>&#125;<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token number">0.</span><span class="token number">.1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Neo4J </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 脚本 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
